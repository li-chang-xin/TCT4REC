2024-10-19 13:05:55,474 - read <class 'data_processing.ml_1m'>
2024-10-19 13:05:59,961 - Namespace(data_dir='./data/', output_dir='output/', data_name='ml-1m', llm_path='./bert-base-uncased', do_eval=False, load_model='TCTRec', train_name='Oct-19-2024_13-05-55', num_items=3952, num_users=6040, num_neg_sample=100, lr=0.003, weight_decay=0, batch_size=128, num_epochs=64, patience=10, num_workers=4, model_type='SASRec', max_seq_length=50, dropout_rate=0.5, hidden_size=64, num_hidden_layers=2, attn_dropout_rate=0.5, n_heads=8, e_layers=4, alpha=0.8, llm=False, device=device(type='cuda'), checkpoint_path='output/ml-1m/SASRec.pt', dim_user_discrete_data=[2, 7, 21, 3439], dim_item_discrete_data=18)
2024-10-19 13:05:59,991 - SASRec(
  (item_emb): Embedding(3953, 64, padding_idx=0)
  (pos_emb): Embedding(50, 64)
  (dropout): Dropout(p=0.5, inplace=False)
  (attention_blocks): ModuleList(
    (0-3): 4 x TransformerBlock(
      (attention): MultiheadAttention(
        (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
      )
      (ffn): Sequential(
        (0): Linear(in_features=64, out_features=64, bias=True)
        (1): ReLU()
        (2): Dropout(p=0.5, inplace=False)
        (3): Linear(in_features=64, out_features=64, bias=True)
      )
      (norm1): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
      (norm2): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
      (dropout): Dropout(p=0.5, inplace=False)
    )
  )
)
2024-10-19 13:06:00,656 - training start
2024-10-19 13:06:16,504 - Epoch: 1/64 Batch: 1/48 Time: 15.8s Loss: 7.22   Average_Loss: 7.22
2024-10-19 13:06:49,097 - Epoch: 1/64 Batch: 33/48 Time: 48.4s Loss: 3.80   Average_Loss: 5.23
2024-10-19 13:07:03,013 - 
Epoch 1/64,  Loss: 4.599942624568939, Total time: 0h 1m 2s
2024-10-19 13:07:03,014 - -----------------validate-----------------
2024-10-19 13:08:50,611 - Epoch 1, total_user:6040.0 nDCG@5: 0.06574890497080246, HR5: 0.14221854304635762, nDCG@10: 0.11320776739644528, HR10: 0.2978476821192053, nDCG@20: 0.17396498430030538, HR20: 0.545364238410596
2024-10-19 13:08:50,611 - Validation score increased.  Saving model ...
2024-10-19 13:09:07,365 - Epoch: 2/64 Batch: 1/48 Time: 16.7s Loss: 2.70   Average_Loss: 2.70
2024-10-19 13:09:38,573 - Epoch: 2/64 Batch: 33/48 Time: 48.0s Loss: 1.58   Average_Loss: 2.10
2024-10-19 13:09:51,005 - 
Epoch 2/64,  Loss: 1.9166125506162643, Total time: 0h 1m 0s
2024-10-19 13:09:51,006 - -----------------validate-----------------
2024-10-19 13:11:39,683 - Epoch 2, total_user:6040.0 nDCG@5: 0.21137956828161555, HR5: 0.44503311258278144, nDCG@10: 0.2790280311124222, HR10: 0.6642384105960265, nDCG@20: 0.31294403762766926, HR20: 0.7998344370860927
2024-10-19 13:11:39,685 - Validation score increased.  Saving model ...
2024-10-19 13:11:57,316 - Epoch: 3/64 Batch: 1/48 Time: 17.6s Loss: 1.34   Average_Loss: 1.34
2024-10-19 13:12:28,723 - Epoch: 3/64 Batch: 33/48 Time: 49.0s Loss: 1.07   Average_Loss: 1.24
2024-10-19 13:12:42,129 - 
Epoch 3/64,  Loss: 1.1812652808924515, Total time: 0h 1m 2s
2024-10-19 13:12:42,130 - -----------------validate-----------------
2024-10-19 13:14:32,009 - Epoch 3, total_user:6040.0 nDCG@5: 0.31874761910530147, HR5: 0.6175496688741722, nDCG@10: 0.3627370530699038, HR10: 0.7594370860927152, nDCG@20: 0.3847743095057845, HR20: 0.8481788079470198
2024-10-19 13:14:32,010 - Validation score increased.  Saving model ...
2024-10-19 13:14:47,653 - Epoch: 4/64 Batch: 1/48 Time: 15.6s Loss: 1.05   Average_Loss: 1.05
2024-10-19 13:15:18,269 - Epoch: 4/64 Batch: 33/48 Time: 46.3s Loss: 0.96   Average_Loss: 0.98
2024-10-19 13:15:33,039 - 
Epoch 4/64,  Loss: 0.9627191709975401, Total time: 0h 1m 1s
2024-10-19 13:15:33,040 - -----------------validate-----------------
2024-10-19 13:17:20,553 - Epoch 4, total_user:6040.0 nDCG@5: 0.33452026252087624, HR5: 0.6326158940397351, nDCG@10: 0.37651015609373856, HR10: 0.7685430463576159, nDCG@20: 0.39960361507771625, HR20: 0.8612582781456953
2024-10-19 13:17:20,554 - Validation score increased.  Saving model ...
2024-10-19 13:17:35,802 - Epoch: 5/64 Batch: 1/48 Time: 15.2s Loss: 0.92   Average_Loss: 0.92
2024-10-19 13:18:09,654 - Epoch: 5/64 Batch: 33/48 Time: 49.1s Loss: 0.90   Average_Loss: 0.90
2024-10-19 13:18:23,316 - 
Epoch 5/64,  Loss: 0.8941255311171213, Total time: 0h 1m 2s
2024-10-19 13:18:23,317 - -----------------validate-----------------
2024-10-19 13:20:12,892 - Epoch 5, total_user:6040.0 nDCG@5: 0.32342912109443667, HR5: 0.6149006622516556, nDCG@10: 0.36836953118937416, HR10: 0.7605960264900662, nDCG@20: 0.39395934901878843, HR20: 0.8634105960264901
2024-10-19 13:20:12,893 - Validation score increased.  Saving model ...
2024-10-19 13:20:28,755 - Epoch: 6/64 Batch: 1/48 Time: 15.9s Loss: 0.86   Average_Loss: 0.86
2024-10-19 13:21:02,546 - Epoch: 6/64 Batch: 33/48 Time: 49.6s Loss: 0.86   Average_Loss: 0.86
2024-10-19 13:21:14,843 - 
Epoch 6/64,  Loss: 0.8583751159409682, Total time: 0h 1m 1s
2024-10-19 13:21:14,843 - -----------------validate-----------------
2024-10-19 13:23:02,991 - Epoch 6, total_user:6040.0 nDCG@5: 0.3346651410751784, HR5: 0.6372516556291391, nDCG@10: 0.3779847991959669, HR10: 0.7774834437086092, nDCG@20: 0.4018175757562145, HR20: 0.8731788079470199
2024-10-19 13:23:02,992 - Validation score increased.  Saving model ...
2024-10-19 13:23:19,195 - Epoch: 7/64 Batch: 1/48 Time: 16.2s Loss: 0.84   Average_Loss: 0.84
2024-10-19 13:23:50,013 - Epoch: 7/64 Batch: 33/48 Time: 47.0s Loss: 0.87   Average_Loss: 0.84
2024-10-19 13:24:03,213 - 
Epoch 7/64,  Loss: 0.8404781172672907, Total time: 0h 1m 0s
2024-10-19 13:24:03,213 - -----------------validate-----------------
2024-10-19 13:25:53,179 - Epoch 7, total_user:6040.0 nDCG@5: 0.3400354478509026, HR5: 0.6519867549668874, nDCG@10: 0.3805055701717622, HR10: 0.7826158940397351, nDCG@20: 0.40263235879475984, HR20: 0.8716887417218543
2024-10-19 13:25:53,180 - Validation score increased.  Saving model ...
2024-10-19 13:26:06,849 - Epoch: 8/64 Batch: 1/48 Time: 13.7s Loss: 0.83   Average_Loss: 0.83
2024-10-19 13:26:41,481 - Epoch: 8/64 Batch: 33/48 Time: 48.3s Loss: 0.82   Average_Loss: 0.83
2024-10-19 13:26:56,449 - 
Epoch 8/64,  Loss: 0.8307327888906002, Total time: 0h 1m 3s
2024-10-19 13:26:56,449 - -----------------validate-----------------
2024-10-19 13:28:47,937 - Epoch 8, total_user:6040.0 nDCG@5: 0.341066327217842, HR5: 0.6509933774834437, nDCG@10: 0.382981867544095, HR10: 0.786092715231788, nDCG@20: 0.40393983581723597, HR20: 0.8703642384105961
2024-10-19 13:28:47,938 - Validation score increased.  Saving model ...
2024-10-19 13:29:02,207 - Epoch: 9/64 Batch: 1/48 Time: 14.3s Loss: 0.80   Average_Loss: 0.80
2024-10-19 13:29:35,644 - Epoch: 9/64 Batch: 33/48 Time: 47.7s Loss: 0.82   Average_Loss: 0.83
2024-10-19 13:29:49,924 - 
Epoch 9/64,  Loss: 0.8251183778047562, Total time: 0h 1m 1s
2024-10-19 13:29:49,925 - -----------------validate-----------------
2024-10-19 13:31:38,343 - Epoch 9, total_user:6040.0 nDCG@5: 0.34331505011021524, HR5: 0.652317880794702, nDCG@10: 0.38525227032394277, HR10: 0.7880794701986755, nDCG@20: 0.4043977417192847, HR20: 0.8653973509933774
2024-10-19 13:31:38,344 - Validation score increased.  Saving model ...
2024-10-19 13:31:51,964 - Epoch: 10/64 Batch: 1/48 Time: 13.6s Loss: 0.84   Average_Loss: 0.84
2024-10-19 13:32:24,354 - Epoch: 10/64 Batch: 33/48 Time: 46.0s Loss: 0.82   Average_Loss: 0.82
2024-10-19 13:32:43,785 - 
Epoch 10/64,  Loss: 0.8175661551455656, Total time: 0h 1m 5s
2024-10-19 13:32:43,786 - -----------------validate-----------------
2024-10-19 13:34:31,148 - Epoch 10, total_user:6040.0 nDCG@5: 0.3434468554691783, HR5: 0.6594370860927152, nDCG@10: 0.3827716884736194, HR10: 0.7864238410596026, nDCG@20: 0.4049788477897108, HR20: 0.8764900662251656
2024-10-19 13:34:31,149 - Validation score increased.  Saving model ...
2024-10-19 13:34:46,064 - Epoch: 11/64 Batch: 1/48 Time: 14.9s Loss: 0.80   Average_Loss: 0.80
2024-10-19 13:35:19,745 - Epoch: 11/64 Batch: 33/48 Time: 48.6s Loss: 0.79   Average_Loss: 0.81
2024-10-19 13:35:34,035 - 
Epoch 11/64,  Loss: 0.8111165314912796, Total time: 0h 1m 2s
2024-10-19 13:35:34,036 - -----------------validate-----------------
2024-10-19 13:37:22,343 - Epoch 11, total_user:6040.0 nDCG@5: 0.348770732637168, HR5: 0.6619205298013245, nDCG@10: 0.3892594947485556, HR10: 0.7923841059602649, nDCG@20: 0.41123171306793754, HR20: 0.8812913907284768
2024-10-19 13:37:22,344 - Validation score increased.  Saving model ...
2024-10-19 13:37:38,793 - Epoch: 12/64 Batch: 1/48 Time: 16.4s Loss: 0.81   Average_Loss: 0.81
2024-10-19 13:38:09,766 - Epoch: 12/64 Batch: 33/48 Time: 47.4s Loss: 0.80   Average_Loss: 0.81
2024-10-19 13:38:25,086 - 
Epoch 12/64,  Loss: 0.8077843623856703, Total time: 0h 1m 2s
2024-10-19 13:38:25,087 - -----------------validate-----------------
2024-10-19 13:40:15,897 - Epoch 12, total_user:6040.0 nDCG@5: 0.3525346112315734, HR5: 0.6768211920529801, nDCG@10: 0.3908630952428472, HR10: 0.8006622516556291, nDCG@20: 0.41232959511374245, HR20: 0.8877483443708609
2024-10-19 13:40:15,898 - Validation score increased.  Saving model ...
2024-10-19 13:40:31,904 - Epoch: 13/64 Batch: 1/48 Time: 16.0s Loss: 0.80   Average_Loss: 0.80
2024-10-19 13:41:04,825 - Epoch: 13/64 Batch: 33/48 Time: 48.9s Loss: 0.77   Average_Loss: 0.81
2024-10-19 13:41:19,921 - 
Epoch 13/64,  Loss: 0.8059663151701292, Total time: 0h 1m 4s
2024-10-19 13:41:19,922 - -----------------validate-----------------
2024-10-19 13:43:07,582 - Epoch 13, total_user:6040.0 nDCG@5: 0.34468322466414986, HR5: 0.6624172185430464, nDCG@10: 0.38507564759281776, HR10: 0.7922185430463576, nDCG@20: 0.4059938106166547, HR20: 0.8768211920529801
2024-10-19 13:43:07,583 - EarlyStopping counter: 1 out of 10
2024-10-19 13:43:23,641 - Epoch: 14/64 Batch: 1/48 Time: 16.1s Loss: 0.78   Average_Loss: 0.78
2024-10-19 13:43:56,963 - Epoch: 14/64 Batch: 33/48 Time: 49.4s Loss: 0.80   Average_Loss: 0.80
2024-10-19 13:44:08,994 - 
Epoch 14/64,  Loss: 0.8060116221507391, Total time: 0h 1m 1s
2024-10-19 13:44:08,994 - -----------------validate-----------------
2024-10-19 13:45:57,233 - Epoch 14, total_user:6040.0 nDCG@5: 0.3484226095055585, HR5: 0.6607615894039736, nDCG@10: 0.39039967705003087, HR10: 0.7961920529801324, nDCG@20: 0.40932218148027677, HR20: 0.8723509933774835
2024-10-19 13:45:57,234 - EarlyStopping counter: 2 out of 10
2024-10-19 13:46:15,646 - Epoch: 15/64 Batch: 1/48 Time: 18.4s Loss: 0.76   Average_Loss: 0.76
2024-10-19 13:46:44,436 - Epoch: 15/64 Batch: 33/48 Time: 47.2s Loss: 0.83   Average_Loss: 0.80
2024-10-19 13:46:58,346 - 
Epoch 15/64,  Loss: 0.8038977061708769, Total time: 0h 1m 1s
2024-10-19 13:46:58,347 - -----------------validate-----------------
2024-10-19 13:48:47,581 - Epoch 15, total_user:6040.0 nDCG@5: 0.3542347772076968, HR5: 0.6701986754966888, nDCG@10: 0.39103898987884367, HR10: 0.7890728476821192, nDCG@20: 0.4128234783039503, HR20: 0.8768211920529801
2024-10-19 13:48:47,583 - Validation score increased.  Saving model ...
2024-10-19 13:49:01,587 - Epoch: 16/64 Batch: 1/48 Time: 14.0s Loss: 0.83   Average_Loss: 0.83
2024-10-19 13:49:35,481 - Epoch: 16/64 Batch: 33/48 Time: 47.9s Loss: 0.81   Average_Loss: 0.80
2024-10-19 13:49:48,729 - 
Epoch 16/64,  Loss: 0.8020155703028043, Total time: 0h 1m 1s
2024-10-19 13:49:48,730 - -----------------validate-----------------
2024-10-19 13:51:36,862 - Epoch 16, total_user:6040.0 nDCG@5: 0.368395263295031, HR5: 0.6958609271523178, nDCG@10: 0.3987057212073874, HR10: 0.793046357615894, nDCG@20: 0.42151266390554765, HR20: 0.8852649006622516
2024-10-19 13:51:36,863 - Validation score increased.  Saving model ...
2024-10-19 13:51:52,936 - Epoch: 17/64 Batch: 1/48 Time: 16.1s Loss: 0.80   Average_Loss: 0.80
2024-10-19 13:52:24,008 - Epoch: 17/64 Batch: 33/48 Time: 47.1s Loss: 0.80   Average_Loss: 0.80
2024-10-19 13:52:37,726 - 
Epoch 17/64,  Loss: 0.802558146417141, Total time: 0h 1m 0s
2024-10-19 13:52:37,727 - -----------------validate-----------------
2024-10-19 13:54:27,142 - Epoch 17, total_user:6040.0 nDCG@5: 0.3647543987236417, HR5: 0.6922185430463577, nDCG@10: 0.40054358247749694, HR10: 0.8079470198675497, nDCG@20: 0.4212882293916579, HR20: 0.891887417218543
2024-10-19 13:54:27,143 - Validation score increased.  Saving model ...
2024-10-19 13:54:41,369 - Epoch: 18/64 Batch: 1/48 Time: 14.2s Loss: 0.83   Average_Loss: 0.83
2024-10-19 13:55:15,007 - Epoch: 18/64 Batch: 33/48 Time: 47.9s Loss: 0.80   Average_Loss: 0.80
2024-10-19 13:55:31,189 - 
Epoch 18/64,  Loss: 0.8005122554798921, Total time: 0h 1m 4s
2024-10-19 13:55:31,189 - -----------------validate-----------------
2024-10-19 13:57:19,547 - Epoch 18, total_user:6040.0 nDCG@5: 0.36599264834524725, HR5: 0.6913907284768211, nDCG@10: 0.40001454559890187, HR10: 0.8016556291390728, nDCG@20: 0.4207423028375414, HR20: 0.8850993377483444
2024-10-19 13:57:19,548 - Validation score increased.  Saving model ...
2024-10-19 13:57:35,459 - Epoch: 19/64 Batch: 1/48 Time: 15.9s Loss: 0.78   Average_Loss: 0.78
2024-10-19 13:58:06,391 - Epoch: 19/64 Batch: 33/48 Time: 46.8s Loss: 0.84   Average_Loss: 0.80
2024-10-19 13:58:21,846 - 
Epoch 19/64,  Loss: 0.8036972855528196, Total time: 0h 1m 2s
2024-10-19 13:58:21,847 - -----------------validate-----------------
2024-10-19 14:00:13,686 - Epoch 19, total_user:6040.0 nDCG@5: 0.365231100892315, HR5: 0.6998344370860927, nDCG@10: 0.3974141297862042, HR10: 0.8036423841059602, nDCG@20: 0.4200546944118494, HR20: 0.8951986754966887
2024-10-19 14:00:13,687 - Validation score increased.  Saving model ...
2024-10-19 14:00:27,916 - Epoch: 20/64 Batch: 1/48 Time: 14.2s Loss: 0.81   Average_Loss: 0.81
2024-10-19 14:01:00,494 - Epoch: 20/64 Batch: 33/48 Time: 46.8s Loss: 0.81   Average_Loss: 0.80
2024-10-19 14:01:16,249 - 
Epoch 20/64,  Loss: 0.7991982412834963, Total time: 0h 1m 2s
2024-10-19 14:01:16,249 - -----------------validate-----------------
2024-10-19 14:03:08,457 - Epoch 20, total_user:6040.0 nDCG@5: 0.37506060542028613, HR5: 0.7056291390728476, nDCG@10: 0.40646268472499025, HR10: 0.8072847682119205, nDCG@20: 0.42563532135008275, HR20: 0.8847682119205298
2024-10-19 14:03:08,458 - Validation score increased.  Saving model ...
2024-10-19 14:03:23,957 - Epoch: 21/64 Batch: 1/48 Time: 15.5s Loss: 0.77   Average_Loss: 0.77
2024-10-19 14:03:55,150 - Epoch: 21/64 Batch: 33/48 Time: 46.7s Loss: 0.79   Average_Loss: 0.80
2024-10-19 14:04:10,389 - 
Epoch 21/64,  Loss: 0.7977703983585039, Total time: 0h 1m 1s
2024-10-19 14:04:10,389 - -----------------validate-----------------
2024-10-19 14:05:58,823 - Epoch 21, total_user:6040.0 nDCG@5: 0.371917784782751, HR5: 0.7039735099337748, nDCG@10: 0.40484478052864714, HR10: 0.8102649006622517, nDCG@20: 0.42611966738814105, HR20: 0.8963576158940397
2024-10-19 14:05:58,824 - Validation score increased.  Saving model ...
2024-10-19 14:06:16,342 - Epoch: 22/64 Batch: 1/48 Time: 17.5s Loss: 0.75   Average_Loss: 0.75
2024-10-19 14:06:48,831 - Epoch: 22/64 Batch: 33/48 Time: 50.0s Loss: 0.77   Average_Loss: 0.80
2024-10-19 14:07:01,748 - 
Epoch 22/64,  Loss: 0.7994961341222128, Total time: 0h 1m 2s
2024-10-19 14:07:01,749 - -----------------validate-----------------
2024-10-19 14:08:49,895 - Epoch 22, total_user:6040.0 nDCG@5: 0.37676240806089134, HR5: 0.7104304635761589, nDCG@10: 0.40852669884862924, HR10: 0.812748344370861, nDCG@20: 0.42653042010182646, HR20: 0.885430463576159
2024-10-19 14:08:49,896 - Validation score increased.  Saving model ...
2024-10-19 14:09:05,581 - Epoch: 23/64 Batch: 1/48 Time: 15.7s Loss: 0.80   Average_Loss: 0.80
2024-10-19 14:09:40,640 - Epoch: 23/64 Batch: 33/48 Time: 50.7s Loss: 0.80   Average_Loss: 0.79
2024-10-19 14:09:54,409 - 
Epoch 23/64,  Loss: 0.798097745825847, Total time: 0h 1m 4s
2024-10-19 14:09:54,410 - -----------------validate-----------------
2024-10-19 14:11:44,260 - Epoch 23, total_user:6040.0 nDCG@5: 0.37887605638954547, HR5: 0.7144039735099338, nDCG@10: 0.40944619778765173, HR10: 0.81341059602649, nDCG@20: 0.42923354807172487, HR20: 0.8935430463576159
2024-10-19 14:11:44,262 - Validation score increased.  Saving model ...
2024-10-19 14:12:00,549 - Epoch: 24/64 Batch: 1/48 Time: 16.3s Loss: 0.79   Average_Loss: 0.79
2024-10-19 14:12:30,570 - Epoch: 24/64 Batch: 33/48 Time: 46.3s Loss: 0.78   Average_Loss: 0.79
2024-10-19 14:12:47,296 - 
Epoch 24/64,  Loss: 0.7945992213984331, Total time: 0h 1m 3s
2024-10-19 14:12:47,297 - -----------------validate-----------------
2024-10-19 14:14:37,569 - Epoch 24, total_user:6040.0 nDCG@5: 0.37612162068942634, HR5: 0.7082781456953643, nDCG@10: 0.4083086274478314, HR10: 0.812251655629139, nDCG@20: 0.4281009512637404, HR20: 0.891887417218543
2024-10-19 14:14:37,570 - EarlyStopping counter: 1 out of 10
2024-10-19 14:14:52,942 - Epoch: 25/64 Batch: 1/48 Time: 15.4s Loss: 0.79   Average_Loss: 0.79
2024-10-19 14:15:24,598 - Epoch: 25/64 Batch: 33/48 Time: 47.0s Loss: 0.81   Average_Loss: 0.80
2024-10-19 14:15:37,936 - 
Epoch 25/64,  Loss: 0.7968001340826353, Total time: 0h 1m 0s
2024-10-19 14:15:37,937 - -----------------validate-----------------
2024-10-19 14:17:32,555 - Epoch 25, total_user:6040.0 nDCG@5: 0.3802850802009962, HR5: 0.7132450331125828, nDCG@10: 0.40997230380675553, HR10: 0.8091059602649007, nDCG@20: 0.43132684386651776, HR20: 0.895364238410596
2024-10-19 14:17:32,556 - Validation score increased.  Saving model ...
2024-10-19 14:17:46,075 - Epoch: 26/64 Batch: 1/48 Time: 13.5s Loss: 0.79   Average_Loss: 0.79
2024-10-19 14:18:19,316 - Epoch: 26/64 Batch: 33/48 Time: 46.7s Loss: 0.76   Average_Loss: 0.79
2024-10-19 14:18:33,361 - 
Epoch 26/64,  Loss: 0.7960318724314371, Total time: 0h 1m 0s
2024-10-19 14:18:33,361 - -----------------validate-----------------
2024-10-19 14:20:22,455 - Epoch 26, total_user:6040.0 nDCG@5: 0.37916748681126367, HR5: 0.7135761589403974, nDCG@10: 0.4105645457303768, HR10: 0.8152317880794702, nDCG@20: 0.4327652093889518, HR20: 0.904635761589404
2024-10-19 14:20:22,457 - Validation score increased.  Saving model ...
2024-10-19 14:20:38,895 - Epoch: 27/64 Batch: 1/48 Time: 16.4s Loss: 0.80   Average_Loss: 0.80
2024-10-19 14:21:09,695 - Epoch: 27/64 Batch: 33/48 Time: 47.2s Loss: 0.82   Average_Loss: 0.80
2024-10-19 14:21:23,309 - 
Epoch 27/64,  Loss: 0.7991615968445936, Total time: 0h 1m 0s
2024-10-19 14:21:23,310 - -----------------validate-----------------
2024-10-19 14:23:12,861 - Epoch 27, total_user:6040.0 nDCG@5: 0.38185097407436397, HR5: 0.7225165562913908, nDCG@10: 0.4108750095928979, HR10: 0.8163907284768211, nDCG@20: 0.4317688913955808, HR20: 0.9006622516556292
2024-10-19 14:23:12,862 - Validation score increased.  Saving model ...
2024-10-19 14:23:27,430 - Epoch: 28/64 Batch: 1/48 Time: 14.6s Loss: 0.81   Average_Loss: 0.81
2024-10-19 14:24:00,428 - Epoch: 28/64 Batch: 33/48 Time: 47.6s Loss: 0.80   Average_Loss: 0.80
2024-10-19 14:24:14,195 - 
Epoch 28/64,  Loss: 0.7946679008503755, Total time: 0h 1m 1s
2024-10-19 14:24:14,195 - -----------------validate-----------------
2024-10-19 14:26:14,528 - Epoch 28, total_user:6040.0 nDCG@5: 0.37970944446645777, HR5: 0.7163907284768212, nDCG@10: 0.4095201310913413, HR10: 0.8124172185430464, nDCG@20: 0.430649510406707, HR20: 0.8973509933774835
2024-10-19 14:26:14,529 - EarlyStopping counter: 1 out of 10
2024-10-19 14:26:30,401 - Epoch: 29/64 Batch: 1/48 Time: 15.9s Loss: 0.78   Average_Loss: 0.78
2024-10-19 14:27:01,861 - Epoch: 29/64 Batch: 33/48 Time: 47.3s Loss: 0.85   Average_Loss: 0.80
2024-10-19 14:27:15,566 - 
Epoch 29/64,  Loss: 0.7954070183138052, Total time: 0h 1m 1s
2024-10-19 14:27:15,567 - -----------------validate-----------------
2024-10-19 14:29:04,478 - Epoch 29, total_user:6040.0 nDCG@5: 0.38044704387902656, HR5: 0.7147350993377484, nDCG@10: 0.4141258150844849, HR10: 0.8233443708609272, nDCG@20: 0.43269007910284196, HR20: 0.8980132450331125
2024-10-19 14:29:04,479 - Validation score increased.  Saving model ...
2024-10-19 14:29:17,995 - Epoch: 30/64 Batch: 1/48 Time: 13.5s Loss: 0.81   Average_Loss: 0.81
2024-10-19 14:29:52,329 - Epoch: 30/64 Batch: 33/48 Time: 47.8s Loss: 0.79   Average_Loss: 0.79
2024-10-19 14:30:05,754 - 
Epoch 30/64,  Loss: 0.7945897293587526, Total time: 0h 1m 1s
2024-10-19 14:30:05,754 - -----------------validate-----------------
2024-10-19 14:31:54,706 - Epoch 30, total_user:6040.0 nDCG@5: 0.37977669084440946, HR5: 0.7178807947019867, nDCG@10: 0.40986376616123493, HR10: 0.8152317880794702, nDCG@20: 0.4300690543410239, HR20: 0.8968543046357615
2024-10-19 14:31:54,707 - Validation score increased.  Saving model ...
2024-10-19 14:32:09,398 - Epoch: 31/64 Batch: 1/48 Time: 14.7s Loss: 0.81   Average_Loss: 0.81
2024-10-19 14:32:42,271 - Epoch: 31/64 Batch: 33/48 Time: 47.6s Loss: 0.77   Average_Loss: 0.79
2024-10-19 14:32:56,370 - 
Epoch 31/64,  Loss: 0.7923340437312921, Total time: 0h 1m 1s
2024-10-19 14:32:56,370 - -----------------validate-----------------
2024-10-19 14:34:45,510 - Epoch 31, total_user:6040.0 nDCG@5: 0.3856801511339162, HR5: 0.7266556291390729, nDCG@10: 0.4150147247943839, HR10: 0.8218543046357616, nDCG@20: 0.43470146346521366, HR20: 0.9013245033112582
2024-10-19 14:34:45,511 - Validation score increased.  Saving model ...
2024-10-19 14:35:00,484 - Epoch: 32/64 Batch: 1/48 Time: 15.0s Loss: 0.79   Average_Loss: 0.79
2024-10-19 14:35:32,600 - Epoch: 32/64 Batch: 33/48 Time: 47.1s Loss: 0.82   Average_Loss: 0.79
2024-10-19 14:35:46,711 - 
Epoch 32/64,  Loss: 0.7930647556980451, Total time: 0h 1m 1s
2024-10-19 14:35:46,712 - -----------------validate-----------------
2024-10-19 14:37:35,629 - Epoch 32, total_user:6040.0 nDCG@5: 0.38430828385906085, HR5: 0.7248344370860927, nDCG@10: 0.4144605880125909, HR10: 0.8218543046357616, nDCG@20: 0.4352491428474781, HR20: 0.9056291390728477
2024-10-19 14:37:35,630 - Validation score increased.  Saving model ...
2024-10-19 14:37:51,371 - Epoch: 33/64 Batch: 1/48 Time: 15.7s Loss: 0.78   Average_Loss: 0.78
2024-10-19 14:38:23,501 - Epoch: 33/64 Batch: 33/48 Time: 47.9s Loss: 0.78   Average_Loss: 0.79
2024-10-19 14:38:37,433 - 
Epoch 33/64,  Loss: 0.7914806517461935, Total time: 0h 1m 1s
2024-10-19 14:38:37,433 - -----------------validate-----------------
2024-10-19 14:40:25,747 - Epoch 33, total_user:6040.0 nDCG@5: 0.38771431163439163, HR5: 0.7284768211920529, nDCG@10: 0.4183032663310305, HR10: 0.827317880794702, nDCG@20: 0.438114466328666, HR20: 0.9072847682119205
2024-10-19 14:40:25,748 - Validation score increased.  Saving model ...
2024-10-19 14:40:41,973 - Epoch: 34/64 Batch: 1/48 Time: 16.2s Loss: 0.76   Average_Loss: 0.76
2024-10-19 14:41:13,186 - Epoch: 34/64 Batch: 33/48 Time: 47.4s Loss: 0.76   Average_Loss: 0.79
2024-10-19 14:41:26,689 - 
Epoch 34/64,  Loss: 0.7919618412852287, Total time: 0h 1m 0s
2024-10-19 14:41:26,690 - -----------------validate-----------------
2024-10-19 14:43:15,627 - Epoch 34, total_user:6040.0 nDCG@5: 0.38289850837629297, HR5: 0.7211920529801324, nDCG@10: 0.41478690027041537, HR10: 0.8241721854304636, nDCG@20: 0.433880653889132, HR20: 0.901158940397351
2024-10-19 14:43:15,627 - EarlyStopping counter: 1 out of 10
2024-10-19 14:43:29,745 - Epoch: 35/64 Batch: 1/48 Time: 14.1s Loss: 0.77   Average_Loss: 0.77
2024-10-19 14:44:03,396 - Epoch: 35/64 Batch: 33/48 Time: 47.8s Loss: 0.77   Average_Loss: 0.79
2024-10-19 14:44:19,144 - 
Epoch 35/64,  Loss: 0.7937035635113716, Total time: 0h 1m 3s
2024-10-19 14:44:19,145 - -----------------validate-----------------
2024-10-19 14:46:08,473 - Epoch 35, total_user:6040.0 nDCG@5: 0.3858594932465814, HR5: 0.726158940397351, nDCG@10: 0.41604812936095914, HR10: 0.8236754966887417, nDCG@20: 0.43567377786878697, HR20: 0.9024834437086092
2024-10-19 14:46:08,474 - EarlyStopping counter: 2 out of 10
2024-10-19 14:46:25,210 - Epoch: 36/64 Batch: 1/48 Time: 16.7s Loss: 0.75   Average_Loss: 0.75
2024-10-19 14:46:57,749 - Epoch: 36/64 Batch: 33/48 Time: 49.3s Loss: 0.82   Average_Loss: 0.80
2024-10-19 14:47:09,744 - 
Epoch 36/64,  Loss: 0.7945286904772123, Total time: 0h 1m 1s
2024-10-19 14:47:09,745 - -----------------validate-----------------
2024-10-19 14:48:58,439 - Epoch 36, total_user:6040.0 nDCG@5: 0.3854810429147167, HR5: 0.7236754966887418, nDCG@10: 0.4157954547347863, HR10: 0.8221854304635762, nDCG@20: 0.43496395350448913, HR20: 0.8990066225165563
2024-10-19 14:48:58,440 - EarlyStopping counter: 3 out of 10
2024-10-19 14:49:13,813 - Epoch: 37/64 Batch: 1/48 Time: 15.4s Loss: 0.78   Average_Loss: 0.78
2024-10-19 14:49:46,688 - Epoch: 37/64 Batch: 33/48 Time: 48.2s Loss: 0.80   Average_Loss: 0.79
2024-10-19 14:50:00,042 - 
Epoch 37/64,  Loss: 0.7934162616729736, Total time: 0h 1m 1s
2024-10-19 14:50:00,043 - -----------------validate-----------------
2024-10-19 14:51:50,820 - Epoch 37, total_user:6040.0 nDCG@5: 0.38615682644661165, HR5: 0.726158940397351, nDCG@10: 0.41716529375424366, HR10: 0.8266556291390729, nDCG@20: 0.4367976599571438, HR20: 0.9059602649006623
2024-10-19 14:51:50,821 - EarlyStopping counter: 4 out of 10
2024-10-19 14:52:05,582 - Epoch: 38/64 Batch: 1/48 Time: 14.8s Loss: 0.80   Average_Loss: 0.80
2024-10-19 14:52:39,625 - Epoch: 38/64 Batch: 33/48 Time: 48.8s Loss: 0.83   Average_Loss: 0.79
2024-10-19 14:52:52,592 - 
Epoch 38/64,  Loss: 0.7929484335084757, Total time: 0h 1m 1s
2024-10-19 14:52:52,592 - -----------------validate-----------------
2024-10-19 14:54:40,573 - Epoch 38, total_user:6040.0 nDCG@5: 0.3872863486017026, HR5: 0.7301324503311258, nDCG@10: 0.4174191726102934, HR10: 0.8276490066225165, nDCG@20: 0.43670540170475336, HR20: 0.9051324503311259
2024-10-19 14:54:40,574 - Validation score increased.  Saving model ...
2024-10-19 14:54:54,970 - Epoch: 39/64 Batch: 1/48 Time: 14.4s Loss: 0.82   Average_Loss: 0.82
2024-10-19 14:55:25,858 - Epoch: 39/64 Batch: 33/48 Time: 45.3s Loss: 0.80   Average_Loss: 0.79
2024-10-19 14:55:41,358 - 
Epoch 39/64,  Loss: 0.7903027199208736, Total time: 0h 1m 0s
2024-10-19 14:55:41,359 - -----------------validate-----------------
2024-10-19 14:57:29,286 - Epoch 39, total_user:6040.0 nDCG@5: 0.3888820162207047, HR5: 0.7304635761589404, nDCG@10: 0.4197950380370611, HR10: 0.8302980132450332, nDCG@20: 0.4387156617397306, HR20: 0.9064569536423841
2024-10-19 14:57:29,287 - Validation score increased.  Saving model ...
2024-10-19 14:57:43,382 - Epoch: 40/64 Batch: 1/48 Time: 14.1s Loss: 0.80   Average_Loss: 0.80
2024-10-19 14:58:17,328 - Epoch: 40/64 Batch: 33/48 Time: 48.0s Loss: 0.82   Average_Loss: 0.79
2024-10-19 14:58:29,896 - 
Epoch 40/64,  Loss: 0.7892452254891396, Total time: 0h 1m 0s
2024-10-19 14:58:29,897 - -----------------validate-----------------
2024-10-19 15:00:17,767 - Epoch 40, total_user:6040.0 nDCG@5: 0.39104211590822074, HR5: 0.7375827814569537, nDCG@10: 0.4196774778176162, HR10: 0.8301324503311258, nDCG@20: 0.43934834396736927, HR20: 0.909271523178808
2024-10-19 15:00:17,768 - Validation score increased.  Saving model ...
2024-10-19 15:00:30,609 - Epoch: 41/64 Batch: 1/48 Time: 12.8s Loss: 0.80   Average_Loss: 0.80
2024-10-19 15:01:05,453 - Epoch: 41/64 Batch: 33/48 Time: 47.7s Loss: 0.79   Average_Loss: 0.79
2024-10-19 15:01:19,229 - 
Epoch 41/64,  Loss: 0.7915951708952585, Total time: 0h 1m 1s
2024-10-19 15:01:19,230 - -----------------validate-----------------
2024-10-19 15:03:20,232 - Epoch 41, total_user:6040.0 nDCG@5: 0.3888924588396109, HR5: 0.7316225165562914, nDCG@10: 0.4198437473325031, HR10: 0.8316225165562914, nDCG@20: 0.4391376721220885, HR20: 0.909271523178808
2024-10-19 15:03:20,233 - Validation score increased.  Saving model ...
2024-10-19 15:03:36,836 - Epoch: 42/64 Batch: 1/48 Time: 16.6s Loss: 0.76   Average_Loss: 0.76
2024-10-19 15:04:09,866 - Epoch: 42/64 Batch: 33/48 Time: 49.6s Loss: 0.78   Average_Loss: 0.79
2024-10-19 15:04:21,303 - 
Epoch 42/64,  Loss: 0.7913055767615637, Total time: 0h 1m 1s
2024-10-19 15:04:21,303 - -----------------validate-----------------
2024-10-19 15:06:09,396 - Epoch 42, total_user:6040.0 nDCG@5: 0.38964872499114334, HR5: 0.7314569536423841, nDCG@10: 0.42113243045342036, HR10: 0.833112582781457, nDCG@20: 0.440771594461614, HR20: 0.9124172185430464
2024-10-19 15:06:09,397 - Validation score increased.  Saving model ...
2024-10-19 15:06:26,359 - Epoch: 43/64 Batch: 1/48 Time: 16.9s Loss: 0.79   Average_Loss: 0.79
2024-10-19 15:06:56,329 - Epoch: 43/64 Batch: 33/48 Time: 46.9s Loss: 0.80   Average_Loss: 0.79
2024-10-19 15:07:10,137 - 
Epoch 43/64,  Loss: 0.7909617287417253, Total time: 0h 1m 0s
2024-10-19 15:07:10,137 - -----------------validate-----------------
2024-10-19 15:09:12,281 - Epoch 43, total_user:6040.0 nDCG@5: 0.38940566164727874, HR5: 0.7301324503311258, nDCG@10: 0.42037341537021244, HR10: 0.8302980132450332, nDCG@20: 0.4398419135856047, HR20: 0.9081125827814569
2024-10-19 15:09:12,282 - EarlyStopping counter: 1 out of 10
2024-10-19 15:09:25,439 - Epoch: 44/64 Batch: 1/48 Time: 13.2s Loss: 0.78   Average_Loss: 0.78
2024-10-19 15:09:59,634 - Epoch: 44/64 Batch: 33/48 Time: 47.4s Loss: 0.83   Average_Loss: 0.79
2024-10-19 15:10:12,065 - 
Epoch 44/64,  Loss: 0.788377565642198, Total time: 0h 0m 59s
2024-10-19 15:10:12,065 - -----------------validate-----------------
2024-10-19 15:12:02,019 - Epoch 44, total_user:6040.0 nDCG@5: 0.393633909545968, HR5: 0.7370860927152317, nDCG@10: 0.4230854391465398, HR10: 0.8324503311258278, nDCG@20: 0.4434648359776673, HR20: 0.9145695364238411
2024-10-19 15:12:02,020 - Validation score increased.  Saving model ...
2024-10-19 15:12:19,564 - Epoch: 45/64 Batch: 1/48 Time: 17.5s Loss: 0.77   Average_Loss: 0.77
2024-10-19 15:12:51,001 - Epoch: 45/64 Batch: 33/48 Time: 49.0s Loss: 0.77   Average_Loss: 0.79
2024-10-19 15:13:05,158 - 
Epoch 45/64,  Loss: 0.7882174315551916, Total time: 0h 1m 3s
2024-10-19 15:13:05,159 - -----------------validate-----------------
2024-10-19 15:14:57,914 - Epoch 45, total_user:6040.0 nDCG@5: 0.3910564281314716, HR5: 0.7317880794701986, nDCG@10: 0.4219225098602693, HR10: 0.831953642384106, nDCG@20: 0.4412080388789469, HR20: 0.9091059602649006
2024-10-19 15:14:57,915 - EarlyStopping counter: 1 out of 10
2024-10-19 15:15:12,611 - Epoch: 46/64 Batch: 1/48 Time: 14.7s Loss: 0.81   Average_Loss: 0.81
2024-10-19 15:15:44,770 - Epoch: 46/64 Batch: 33/48 Time: 46.9s Loss: 0.82   Average_Loss: 0.79
2024-10-19 15:15:57,964 - 
Epoch 46/64,  Loss: 0.7888305050631365, Total time: 0h 1m 0s
2024-10-19 15:15:57,965 - -----------------validate-----------------
2024-10-19 15:17:46,562 - Epoch 46, total_user:6040.0 nDCG@5: 0.3876810090610835, HR5: 0.7289735099337749, nDCG@10: 0.4185941288122167, HR10: 0.8286423841059603, nDCG@20: 0.4383372114171705, HR20: 0.9081125827814569
2024-10-19 15:17:46,562 - EarlyStopping counter: 2 out of 10
2024-10-19 15:18:01,583 - Epoch: 47/64 Batch: 1/48 Time: 15.0s Loss: 0.79   Average_Loss: 0.79
2024-10-19 15:18:34,406 - Epoch: 47/64 Batch: 33/48 Time: 47.8s Loss: 0.81   Average_Loss: 0.79
2024-10-19 15:18:50,484 - 
Epoch 47/64,  Loss: 0.7882897394398848, Total time: 0h 1m 3s
2024-10-19 15:18:50,485 - -----------------validate-----------------
2024-10-19 15:20:47,181 - Epoch 47, total_user:6040.0 nDCG@5: 0.39330121350010394, HR5: 0.7390728476821192, nDCG@10: 0.4221896761358834, HR10: 0.8324503311258278, nDCG@20: 0.44124974223413194, HR20: 0.9091059602649006
2024-10-19 15:20:47,182 - Validation score increased.  Saving model ...
2024-10-19 15:20:59,853 - Epoch: 48/64 Batch: 1/48 Time: 12.7s Loss: 0.79   Average_Loss: 0.79
2024-10-19 15:21:37,815 - Epoch: 48/64 Batch: 33/48 Time: 50.6s Loss: 0.80   Average_Loss: 0.79
2024-10-19 15:21:51,041 - 
Epoch 48/64,  Loss: 0.7874319603045782, Total time: 0h 1m 3s
2024-10-19 15:21:51,042 - -----------------validate-----------------
2024-10-19 15:23:38,418 - Epoch 48, total_user:6040.0 nDCG@5: 0.3906210920668472, HR5: 0.7322847682119206, nDCG@10: 0.42202883148926346, HR10: 0.8334437086092715, nDCG@20: 0.441064631760556, HR20: 0.9102649006622516
2024-10-19 15:23:38,419 - Validation score increased.  Saving model ...
2024-10-19 15:23:53,357 - Epoch: 49/64 Batch: 1/48 Time: 14.9s Loss: 0.76   Average_Loss: 0.76
2024-10-19 15:24:26,807 - Epoch: 49/64 Batch: 33/48 Time: 48.4s Loss: 0.78   Average_Loss: 0.79
2024-10-19 15:24:42,384 - 
Epoch 49/64,  Loss: 0.7902986171344916, Total time: 0h 1m 3s
2024-10-19 15:24:42,385 - -----------------validate-----------------
2024-10-19 15:26:30,339 - Epoch 49, total_user:6040.0 nDCG@5: 0.39346203934993945, HR5: 0.7374172185430463, nDCG@10: 0.4228267726769466, HR10: 0.831953642384106, nDCG@20: 0.4414611576434364, HR20: 0.9069536423841059
2024-10-19 15:26:30,339 - Validation score increased.  Saving model ...
2024-10-19 15:26:44,701 - Epoch: 50/64 Batch: 1/48 Time: 14.4s Loss: 0.79   Average_Loss: 0.79
2024-10-19 15:27:17,987 - Epoch: 50/64 Batch: 33/48 Time: 47.6s Loss: 0.80   Average_Loss: 0.79
2024-10-19 15:27:30,803 - 
Epoch 50/64,  Loss: 0.7901992984116077, Total time: 0h 1m 0s
2024-10-19 15:27:30,803 - -----------------validate-----------------
2024-10-19 15:29:19,341 - Epoch 50, total_user:6040.0 nDCG@5: 0.3952446169291666, HR5: 0.7394039735099338, nDCG@10: 0.42474376084087656, HR10: 0.8350993377483443, nDCG@20: 0.4429829233019641, HR20: 0.9084437086092715
2024-10-19 15:29:19,342 - Validation score increased.  Saving model ...
2024-10-19 15:29:36,211 - Epoch: 51/64 Batch: 1/48 Time: 16.9s Loss: 0.79   Average_Loss: 0.79
2024-10-19 15:30:05,503 - Epoch: 51/64 Batch: 33/48 Time: 46.2s Loss: 0.79   Average_Loss: 0.79
2024-10-19 15:30:20,966 - 
Epoch 51/64,  Loss: 0.7863200381398201, Total time: 0h 1m 1s
2024-10-19 15:30:20,966 - -----------------validate-----------------
2024-10-19 15:32:09,297 - Epoch 51, total_user:6040.0 nDCG@5: 0.39142643944855116, HR5: 0.7327814569536424, nDCG@10: 0.4233227286561725, HR10: 0.8362582781456953, nDCG@20: 0.4420096711972739, HR20: 0.9114238410596026
2024-10-19 15:32:09,298 - Validation score increased.  Saving model ...
2024-10-19 15:32:25,546 - Epoch: 52/64 Batch: 1/48 Time: 16.2s Loss: 0.80   Average_Loss: 0.80
2024-10-19 15:32:57,060 - Epoch: 52/64 Batch: 33/48 Time: 47.8s Loss: 0.81   Average_Loss: 0.79
2024-10-19 15:33:09,945 - 
Epoch 52/64,  Loss: 0.7911147698760033, Total time: 0h 1m 0s
2024-10-19 15:33:09,946 - -----------------validate-----------------
2024-10-19 15:35:00,133 - Epoch 52, total_user:6040.0 nDCG@5: 0.39261476210196666, HR5: 0.7362582781456953, nDCG@10: 0.4236269520277283, HR10: 0.8365894039735099, nDCG@20: 0.44233861259604446, HR20: 0.9117549668874172
2024-10-19 15:35:00,134 - Validation score increased.  Saving model ...
2024-10-19 15:35:16,545 - Epoch: 53/64 Batch: 1/48 Time: 16.4s Loss: 0.78   Average_Loss: 0.78
2024-10-19 15:35:47,836 - Epoch: 53/64 Batch: 33/48 Time: 47.7s Loss: 0.79   Average_Loss: 0.79
2024-10-19 15:36:02,109 - 
Epoch 53/64,  Loss: 0.788526059438785, Total time: 0h 1m 1s
2024-10-19 15:36:02,110 - -----------------validate-----------------
2024-10-19 15:37:57,943 - Epoch 53, total_user:6040.0 nDCG@5: 0.3903599767512958, HR5: 0.7312913907284768, nDCG@10: 0.4219654998640856, HR10: 0.8337748344370861, nDCG@20: 0.44120033110327544, HR20: 0.9112582781456954
2024-10-19 15:37:57,944 - EarlyStopping counter: 1 out of 10
2024-10-19 15:38:10,580 - Epoch: 54/64 Batch: 1/48 Time: 12.6s Loss: 0.81   Average_Loss: 0.81
2024-10-19 15:38:46,101 - Epoch: 54/64 Batch: 33/48 Time: 48.2s Loss: 0.79   Average_Loss: 0.79
2024-10-19 15:39:00,290 - 
Epoch 54/64,  Loss: 0.7898412793874741, Total time: 0h 1m 2s
2024-10-19 15:39:00,291 - -----------------validate-----------------
2024-10-19 15:40:57,569 - Epoch 54, total_user:6040.0 nDCG@5: 0.39154907782490544, HR5: 0.7339403973509934, nDCG@10: 0.42280332700563744, HR10: 0.8352649006622517, nDCG@20: 0.4421673276402538, HR20: 0.9129139072847682
2024-10-19 15:40:57,571 - Validation score increased.  Saving model ...
2024-10-19 15:41:17,693 - Epoch: 55/64 Batch: 1/48 Time: 20.1s Loss: 0.80   Average_Loss: 0.80
2024-10-19 15:41:49,262 - Epoch: 55/64 Batch: 33/48 Time: 51.7s Loss: 0.80   Average_Loss: 0.79
2024-10-19 15:42:05,618 - 
Epoch 55/64,  Loss: 0.7902228472133478, Total time: 0h 1m 8s
2024-10-19 15:42:05,618 - -----------------validate-----------------
2024-10-19 15:43:53,793 - Epoch 55, total_user:6040.0 nDCG@5: 0.3939549626388026, HR5: 0.7355960264900663, nDCG@10: 0.4247002152265535, HR10: 0.8349337748344371, nDCG@20: 0.4440415002508804, HR20: 0.9125827814569536
2024-10-19 15:43:53,794 - Validation score increased.  Saving model ...
2024-10-19 15:44:09,117 - Epoch: 56/64 Batch: 1/48 Time: 15.3s Loss: 0.78   Average_Loss: 0.78
2024-10-19 15:44:43,455 - Epoch: 56/64 Batch: 33/48 Time: 49.7s Loss: 0.77   Average_Loss: 0.79
2024-10-19 15:44:56,776 - 
Epoch 56/64,  Loss: 0.7890201260646185, Total time: 0h 1m 2s
2024-10-19 15:44:56,777 - -----------------validate-----------------
2024-10-19 15:46:45,427 - Epoch 56, total_user:6040.0 nDCG@5: 0.3922611703127486, HR5: 0.7336092715231788, nDCG@10: 0.42563407334409, HR10: 0.8415562913907285, nDCG@20: 0.443852034622789, HR20: 0.9145695364238411
2024-10-19 15:46:45,428 - Validation score increased.  Saving model ...
2024-10-19 15:47:02,786 - Epoch: 57/64 Batch: 1/48 Time: 17.3s Loss: 0.78   Average_Loss: 0.78
2024-10-19 15:47:33,292 - Epoch: 57/64 Batch: 33/48 Time: 47.9s Loss: 0.79   Average_Loss: 0.79
2024-10-19 15:47:48,467 - 
Epoch 57/64,  Loss: 0.7878443884352843, Total time: 0h 1m 3s
2024-10-19 15:47:48,468 - -----------------validate-----------------
2024-10-19 15:49:36,545 - Epoch 57, total_user:6040.0 nDCG@5: 0.39620336754697144, HR5: 0.7402317880794702, nDCG@10: 0.4262547040874048, HR10: 0.8379139072847682, nDCG@20: 0.444733504488156, HR20: 0.9120860927152318
2024-10-19 15:49:36,546 - Validation score increased.  Saving model ...
2024-10-19 15:49:51,300 - Epoch: 58/64 Batch: 1/48 Time: 14.7s Loss: 0.77   Average_Loss: 0.77
2024-10-19 15:50:23,772 - Epoch: 58/64 Batch: 33/48 Time: 47.2s Loss: 0.76   Average_Loss: 0.79
2024-10-19 15:50:39,561 - 
Epoch 58/64,  Loss: 0.7864715829491615, Total time: 0h 1m 3s
2024-10-19 15:50:39,562 - -----------------validate-----------------
2024-10-19 15:52:31,629 - Epoch 58, total_user:6040.0 nDCG@5: 0.39420883628298964, HR5: 0.7379139072847682, nDCG@10: 0.4255107441886792, HR10: 0.8392384105960264, nDCG@20: 0.4437620537732045, HR20: 0.9122516556291391
2024-10-19 15:52:31,630 - Validation score increased.  Saving model ...
2024-10-19 15:52:45,933 - Epoch: 59/64 Batch: 1/48 Time: 14.3s Loss: 0.80   Average_Loss: 0.80
2024-10-19 15:53:19,595 - Epoch: 59/64 Batch: 33/48 Time: 48.0s Loss: 0.76   Average_Loss: 0.79
2024-10-19 15:53:32,386 - 
Epoch 59/64,  Loss: 0.7871335198481878, Total time: 0h 1m 0s
2024-10-19 15:53:32,386 - -----------------validate-----------------
2024-10-19 15:55:24,737 - Epoch 59, total_user:6040.0 nDCG@5: 0.3940654867607142, HR5: 0.7380794701986755, nDCG@10: 0.42457174270525194, HR10: 0.8367549668874172, nDCG@20: 0.4431699648972428, HR20: 0.91158940397351
2024-10-19 15:55:24,737 - EarlyStopping counter: 1 out of 10
2024-10-19 15:55:39,194 - Epoch: 60/64 Batch: 1/48 Time: 14.5s Loss: 0.80   Average_Loss: 0.80
2024-10-19 15:56:10,084 - Epoch: 60/64 Batch: 33/48 Time: 45.3s Loss: 0.79   Average_Loss: 0.78
2024-10-19 15:56:29,056 - 
Epoch 60/64,  Loss: 0.7875745929777622, Total time: 0h 1m 4s
2024-10-19 15:56:29,057 - -----------------validate-----------------
2024-10-19 15:58:16,721 - Epoch 60, total_user:6040.0 nDCG@5: 0.3924260123110087, HR5: 0.7365894039735099, nDCG@10: 0.4242772740136159, HR10: 0.839569536423841, nDCG@20: 0.44355886170315206, HR20: 0.9173841059602649
2024-10-19 15:58:16,722 - Validation score increased.  Saving model ...
2024-10-19 15:58:32,207 - Epoch: 61/64 Batch: 1/48 Time: 15.5s Loss: 0.78   Average_Loss: 0.78
2024-10-19 15:59:03,568 - Epoch: 61/64 Batch: 33/48 Time: 46.8s Loss: 0.79   Average_Loss: 0.79
2024-10-19 15:59:18,093 - 
Epoch 61/64,  Loss: 0.7890137123564879, Total time: 0h 1m 1s
2024-10-19 15:59:18,093 - -----------------validate-----------------
2024-10-19 16:01:07,502 - Epoch 61, total_user:6040.0 nDCG@5: 0.39607269768603276, HR5: 0.740728476821192, nDCG@10: 0.42562125577876847, HR10: 0.8360927152317881, nDCG@20: 0.4448592156755389, HR20: 0.9134105960264901
2024-10-19 16:01:07,503 - Validation score increased.  Saving model ...
2024-10-19 16:01:18,932 - Epoch: 62/64 Batch: 1/48 Time: 11.4s Loss: 0.82   Average_Loss: 0.82
2024-10-19 16:01:55,093 - Epoch: 62/64 Batch: 33/48 Time: 47.6s Loss: 0.78   Average_Loss: 0.79
2024-10-19 16:02:10,345 - 
Epoch 62/64,  Loss: 0.790570180863142, Total time: 0h 1m 2s
2024-10-19 16:02:10,346 - -----------------validate-----------------
2024-10-19 16:04:00,045 - Epoch 62, total_user:6040.0 nDCG@5: 0.3946506222503787, HR5: 0.7389072847682119, nDCG@10: 0.4255145039847602, HR10: 0.838907284768212, nDCG@20: 0.44335085224452847, HR20: 0.9109271523178808
2024-10-19 16:04:00,046 - Validation score increased.  Saving model ...
2024-10-19 16:04:16,985 - Epoch: 63/64 Batch: 1/48 Time: 16.9s Loss: 0.78   Average_Loss: 0.78
2024-10-19 16:04:49,213 - Epoch: 63/64 Batch: 33/48 Time: 49.2s Loss: 0.77   Average_Loss: 0.79
2024-10-19 16:05:05,373 - 
Epoch 63/64,  Loss: 0.7874219343066216, Total time: 0h 1m 5s
2024-10-19 16:05:05,374 - -----------------validate-----------------
2024-10-19 16:06:54,025 - Epoch 63, total_user:6040.0 nDCG@5: 0.39624283418956363, HR5: 0.7399006622516556, nDCG@10: 0.42570273055011787, HR10: 0.8347682119205299, nDCG@20: 0.4451988253707047, HR20: 0.9132450331125828
2024-10-19 16:06:54,027 - Validation score increased.  Saving model ...
2024-10-19 16:07:09,084 - Epoch: 64/64 Batch: 1/48 Time: 15.0s Loss: 0.81   Average_Loss: 0.81
2024-10-19 16:07:42,664 - Epoch: 64/64 Batch: 33/48 Time: 48.6s Loss: 0.80   Average_Loss: 0.79
2024-10-19 16:07:55,706 - 
Epoch 64/64,  Loss: 0.7898840283354124, Total time: 0h 1m 1s
2024-10-19 16:07:55,706 - -----------------validate-----------------
2024-10-19 16:09:43,866 - Epoch 64, total_user:6040.0 nDCG@5: 0.39479732465498124, HR5: 0.7387417218543046, nDCG@10: 0.42536403757245717, HR10: 0.8377483443708609, nDCG@20: 0.44424232567088145, HR20: 0.9135761589403973
2024-10-19 16:09:43,867 - Validation score increased.  Saving model ...
2024-10-19 16:09:43,880 - ---------------Test Score---------------
2024-10-19 16:09:43,888 - -----------------test-----------------
2024-10-19 16:11:32,869 - Epoch 1, total_user:6040.0 nDCG@5: 0.38084204428641566, HR5: 0.715728476821192, nDCG@10: 0.40975748417672625, HR10: 0.8089403973509933, nDCG@20: 0.4306191785508777, HR20: 0.8935430463576159
2024-10-19 16:11:32,870 - Oct-19-2024_13-05-55
2024-10-26 02:37:40,977 - read <class 'data_processing.ml_1m'>
2024-10-26 02:37:45,589 - Namespace(data_dir='./data/', output_dir='output/', data_name='ml-1m', llm_path='./bert-base-uncased', do_eval=True, load_model='SASRec', train_name='Oct-26-2024_02-37-40', num_items=3952, num_users=6040, num_neg_sample=100, lr=0.003, weight_decay=0, batch_size=128, num_epochs=64, patience=5, num_workers=4, seed=42, model_type='SASRec', max_seq_length=50, dropout_rate=0.5, hidden_size=64, num_hidden_layers=2, attn_dropout_rate=0.5, n_heads=8, e_layers=4, alpha=0.8, llm=False, device=device(type='cuda'), checkpoint_path='output/ml-1m/SASRec.pt', dim_user_discrete_data=[2, 7, 21, 3439], dim_item_discrete_data=18)
2024-10-26 02:37:45,597 - SASRec(
  (item_emb): Embedding(3953, 64, padding_idx=0)
  (pos_emb): Embedding(50, 64)
  (dropout): Dropout(p=0.5, inplace=False)
  (attention_blocks): ModuleList(
    (0-3): 4 x TransformerBlock(
      (attention): MultiheadAttention(
        (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
      )
      (ffn): Sequential(
        (0): Linear(in_features=64, out_features=64, bias=True)
        (1): ReLU()
        (2): Dropout(p=0.5, inplace=False)
        (3): Linear(in_features=64, out_features=64, bias=True)
      )
      (norm1): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
      (norm2): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
      (dropout): Dropout(p=0.5, inplace=False)
    )
  )
)
2024-10-26 02:37:45,714 - Load model from output/ml-1m/SASRec.pt for test!
2024-10-26 02:37:45,714 - -----------------test-----------------
2024-10-26 02:39:37,599 - Epoch 2, total_user:6040.0 nDCG@5: 0.38166885540143125, HR5: 0.721523178807947, nDCG@10: 0.4094010968147158, HR10: 0.8112582781456954, nDCG@20: 0.42963552891971385, HR20: 0.8935430463576159
2024-10-26 02:39:37,600 - Oct-26-2024_02-37-40
