2024-10-19 16:59:28,602 - read <class 'data_processing.ml_1m'>
2024-10-19 16:59:33,056 - Namespace(data_dir='./data/', output_dir='output/', data_name='ml-1m', llm_path='./bert-base-uncased', do_eval=False, load_model='TCTRec', train_name='Oct-19-2024_16-59-28', num_items=3952, num_users=6040, num_neg_sample=100, lr=0.003, weight_decay=0, batch_size=128, num_epochs=64, patience=10, num_workers=4, model_type='BSARec', max_seq_length=50, dropout_rate=0.5, hidden_size=64, num_hidden_layers=2, attn_dropout_rate=0.5, n_heads=8, e_layers=4, alpha=0.8, device=device(type='cuda'), checkpoint_path='output/ml-1m/BSARec.pt', dim_user_discrete_data=[2, 7, 21, 3439], dim_item_discrete_data=18)
2024-10-19 16:59:33,091 - BSARec(
  (item_emb): Embedding(3953, 64, padding_idx=0)
  (pos_emb): Embedding(50, 64)
  (dropout): Dropout(p=0.5, inplace=False)
  (attention_blocks): ModuleList(
    (0-3): 4 x TransformerBlock(
      (attention): MultiheadAttention(
        (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
      )
      (filter_layer): FrequencyLayer(
        (out_dropout): Dropout(p=0.5, inplace=False)
        (layer_norm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      )
      (ffn): Sequential(
        (0): Linear(in_features=64, out_features=64, bias=True)
        (1): ReLU()
        (2): Dropout(p=0.5, inplace=False)
        (3): Linear(in_features=64, out_features=64, bias=True)
      )
      (norm1): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
      (norm2): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
      (dropout): Dropout(p=0.5, inplace=False)
    )
  )
)
2024-10-19 16:59:33,752 - training start
2024-10-19 16:59:51,340 - Epoch: 1/64 Batch: 1/48 Time: 17.6s Loss: 7.38   Average_Loss: 7.38
2024-10-19 17:00:23,461 - Epoch: 1/64 Batch: 33/48 Time: 49.7s Loss: 3.77   Average_Loss: 5.25
2024-10-19 17:00:36,107 - 
Epoch 1/64,  Loss: 4.600062275926272, Total time: 0h 1m 2s
2024-10-19 17:00:36,108 - -----------------validate-----------------
2024-10-19 17:03:05,606 - Epoch 1, total_user:6040.0 nDCG@5: 0.11490670517246833, HR5: 0.2445364238410596, nDCG@10: 0.1704541451778933, HR10: 0.4251655629139073, nDCG@20: 0.2158884948987513, HR20: 0.6086092715231788
2024-10-19 17:03:05,607 - Validation score increased.  Saving model ...
2024-10-19 17:03:23,040 - Epoch: 2/64 Batch: 1/48 Time: 17.4s Loss: 2.65   Average_Loss: 2.65
2024-10-19 17:03:55,660 - Epoch: 2/64 Batch: 33/48 Time: 50.0s Loss: 1.70   Average_Loss: 2.14
2024-10-19 17:04:08,515 - 
Epoch 2/64,  Loss: 1.9567618742585182, Total time: 0h 1m 2s
2024-10-19 17:04:08,516 - -----------------validate-----------------
2024-10-19 17:06:40,344 - Epoch 2, total_user:6040.0 nDCG@5: 0.24199420001130736, HR5: 0.4822847682119205, nDCG@10: 0.3004194156828784, HR10: 0.6730132450331126, nDCG@20: 0.3358710782310174, HR20: 0.8145695364238411
2024-10-19 17:06:40,345 - Validation score increased.  Saving model ...
2024-10-19 17:06:54,339 - Epoch: 3/64 Batch: 1/48 Time: 14.0s Loss: 1.48   Average_Loss: 1.48
2024-10-19 17:07:30,753 - Epoch: 3/64 Batch: 33/48 Time: 50.4s Loss: 1.11   Average_Loss: 1.27
2024-10-19 17:07:44,440 - 
Epoch 3/64,  Loss: 1.2184672057628632, Total time: 0h 1m 4s
2024-10-19 17:07:44,441 - -----------------validate-----------------
2024-10-19 17:10:15,653 - Epoch 3, total_user:6040.0 nDCG@5: 0.32406685681253694, HR5: 0.6160596026490066, nDCG@10: 0.3694208954075656, HR10: 0.7627483443708609, nDCG@20: 0.39336199835549385, HR20: 0.8589403973509934
2024-10-19 17:10:15,654 - Validation score increased.  Saving model ...
2024-10-19 17:10:31,653 - Epoch: 4/64 Batch: 1/48 Time: 16.0s Loss: 1.07   Average_Loss: 1.07
2024-10-19 17:11:04,171 - Epoch: 4/64 Batch: 33/48 Time: 48.5s Loss: 0.97   Average_Loss: 1.02
2024-10-19 17:11:18,680 - 
Epoch 4/64,  Loss: 0.99991757919391, Total time: 0h 1m 3s
2024-10-19 17:11:18,681 - -----------------validate-----------------
2024-10-19 17:13:52,300 - Epoch 4, total_user:6040.0 nDCG@5: 0.3246363735296023, HR5: 0.6223509933774835, nDCG@10: 0.3690723232843061, HR10: 0.7658940397350993, nDCG@20: 0.39546472380621395, HR20: 0.8720198675496689
2024-10-19 17:13:52,301 - Validation score increased.  Saving model ...
2024-10-19 17:14:07,163 - Epoch: 5/64 Batch: 1/48 Time: 14.8s Loss: 0.97   Average_Loss: 0.97
2024-10-19 17:14:39,740 - Epoch: 5/64 Batch: 33/48 Time: 47.4s Loss: 0.90   Average_Loss: 0.92
2024-10-19 17:14:54,155 - 
Epoch 5/64,  Loss: 0.9132065325975418, Total time: 0h 1m 1s
2024-10-19 17:14:54,156 - -----------------validate-----------------
2024-10-19 17:17:26,020 - Epoch 5, total_user:6040.0 nDCG@5: 0.3189731948835153, HR5: 0.6071192052980132, nDCG@10: 0.3640996497273317, HR10: 0.7536423841059603, nDCG@20: 0.3920368328233444, HR20: 0.8652317880794702
2024-10-19 17:17:26,021 - EarlyStopping counter: 1 out of 10
2024-10-19 17:17:42,554 - Epoch: 6/64 Batch: 1/48 Time: 16.5s Loss: 0.88   Average_Loss: 0.88
2024-10-19 17:18:15,100 - Epoch: 6/64 Batch: 33/48 Time: 49.1s Loss: 0.90   Average_Loss: 0.88
2024-10-19 17:18:29,754 - 
Epoch 6/64,  Loss: 0.8751965947449207, Total time: 0h 1m 3s
2024-10-19 17:18:29,755 - -----------------validate-----------------
2024-10-19 17:21:02,078 - Epoch 6, total_user:6040.0 nDCG@5: 0.3200007544012494, HR5: 0.6149006622516556, nDCG@10: 0.36973761047884635, HR10: 0.7753311258278146, nDCG@20: 0.3900311024862992, HR20: 0.8566225165562914
2024-10-19 17:21:02,079 - Validation score increased.  Saving model ...
2024-10-19 17:21:18,728 - Epoch: 7/64 Batch: 1/48 Time: 16.6s Loss: 0.85   Average_Loss: 0.85
2024-10-19 17:21:51,057 - Epoch: 7/64 Batch: 33/48 Time: 49.0s Loss: 0.80   Average_Loss: 0.85
2024-10-19 17:22:03,642 - 
Epoch 7/64,  Loss: 0.8518595186372598, Total time: 0h 1m 1s
2024-10-19 17:22:03,643 - -----------------validate-----------------
2024-10-19 17:24:38,964 - Epoch 7, total_user:6040.0 nDCG@5: 0.3223018995910364, HR5: 0.6165562913907284, nDCG@10: 0.37075991046665957, HR10: 0.7731788079470199, nDCG@20: 0.39335488843396654, HR20: 0.8640728476821192
2024-10-19 17:24:38,965 - Validation score increased.  Saving model ...
2024-10-19 17:24:53,645 - Epoch: 8/64 Batch: 1/48 Time: 14.7s Loss: 0.85   Average_Loss: 0.85
2024-10-19 17:25:30,052 - Epoch: 8/64 Batch: 33/48 Time: 51.1s Loss: 0.84   Average_Loss: 0.84
2024-10-19 17:25:46,100 - 
Epoch 8/64,  Loss: 0.838008621086677, Total time: 0h 1m 7s
2024-10-19 17:25:46,101 - -----------------validate-----------------
2024-10-19 17:28:28,735 - Epoch 8, total_user:6040.0 nDCG@5: 0.33198205874206044, HR5: 0.6321192052980132, nDCG@10: 0.37478225008390703, HR10: 0.7711920529801325, nDCG@20: 0.3978520656682833, HR20: 0.8634105960264901
2024-10-19 17:28:28,736 - Validation score increased.  Saving model ...
2024-10-19 17:28:43,811 - Epoch: 9/64 Batch: 1/48 Time: 15.1s Loss: 0.81   Average_Loss: 0.81
2024-10-19 17:29:16,813 - Epoch: 9/64 Batch: 33/48 Time: 48.1s Loss: 0.87   Average_Loss: 0.83
2024-10-19 17:29:30,144 - 
Epoch 9/64,  Loss: 0.8262669940789541, Total time: 0h 1m 1s
2024-10-19 17:29:30,145 - -----------------validate-----------------
2024-10-19 17:32:01,354 - Epoch 9, total_user:6040.0 nDCG@5: 0.325816835322315, HR5: 0.6279801324503311, nDCG@10: 0.3709169749545579, HR10: 0.7731788079470199, nDCG@20: 0.3940910854110589, HR20: 0.8663907284768212
2024-10-19 17:32:01,354 - Validation score increased.  Saving model ...
2024-10-19 17:32:17,015 - Epoch: 10/64 Batch: 1/48 Time: 15.7s Loss: 0.81   Average_Loss: 0.81
2024-10-19 17:32:49,604 - Epoch: 10/64 Batch: 33/48 Time: 48.2s Loss: 0.82   Average_Loss: 0.82
2024-10-19 17:33:03,324 - 
Epoch 10/64,  Loss: 0.8193969950079918, Total time: 0h 1m 1s
2024-10-19 17:33:03,325 - -----------------validate-----------------
2024-10-19 17:35:36,306 - Epoch 10, total_user:6040.0 nDCG@5: 0.3304292784131451, HR5: 0.6365894039735099, nDCG@10: 0.3751405434130448, HR10: 0.7814569536423841, nDCG@20: 0.3976327648367859, HR20: 0.8716887417218543
2024-10-19 17:35:36,307 - Validation score increased.  Saving model ...
2024-10-19 17:35:52,761 - Epoch: 11/64 Batch: 1/48 Time: 16.4s Loss: 0.85   Average_Loss: 0.85
2024-10-19 17:36:31,846 - Epoch: 11/64 Batch: 33/48 Time: 55.5s Loss: 0.81   Average_Loss: 0.81
2024-10-19 17:36:46,162 - 
Epoch 11/64,  Loss: 0.8136839717626572, Total time: 0h 1m 9s
2024-10-19 17:36:46,163 - -----------------validate-----------------
2024-10-19 17:39:16,738 - Epoch 11, total_user:6040.0 nDCG@5: 0.3336009068873898, HR5: 0.6395695364238411, nDCG@10: 0.37939976998486075, HR10: 0.7874172185430464, nDCG@20: 0.4021764359441251, HR20: 0.8791390728476821
2024-10-19 17:39:16,739 - Validation score increased.  Saving model ...
2024-10-19 17:39:31,496 - Epoch: 12/64 Batch: 1/48 Time: 14.7s Loss: 0.82   Average_Loss: 0.82
2024-10-19 17:40:04,577 - Epoch: 12/64 Batch: 33/48 Time: 47.8s Loss: 0.78   Average_Loss: 0.81
2024-10-19 17:40:19,157 - 
Epoch 12/64,  Loss: 0.808773739884297, Total time: 0h 1m 2s
2024-10-19 17:40:19,158 - -----------------validate-----------------
2024-10-19 17:42:50,328 - Epoch 12, total_user:6040.0 nDCG@5: 0.3292433935730938, HR5: 0.6311258278145695, nDCG@10: 0.37548730206365905, HR10: 0.7806291390728477, nDCG@20: 0.39816620251337614, HR20: 0.871523178807947
2024-10-19 17:42:50,329 - EarlyStopping counter: 1 out of 10
2024-10-19 17:43:05,353 - Epoch: 13/64 Batch: 1/48 Time: 15.0s Loss: 0.80   Average_Loss: 0.80
2024-10-19 17:43:39,793 - Epoch: 13/64 Batch: 33/48 Time: 49.5s Loss: 0.80   Average_Loss: 0.81
2024-10-19 17:43:56,126 - 
Epoch 13/64,  Loss: 0.8075285206238428, Total time: 0h 1m 5s
2024-10-19 17:43:56,127 - -----------------validate-----------------
2024-10-19 17:46:32,922 - Epoch 13, total_user:6040.0 nDCG@5: 0.33438776669279424, HR5: 0.6390728476821192, nDCG@10: 0.3806154765203688, HR10: 0.7880794701986755, nDCG@20: 0.4027986473244598, HR20: 0.8769867549668874
2024-10-19 17:46:32,922 - Validation score increased.  Saving model ...
2024-10-19 17:46:49,617 - Epoch: 14/64 Batch: 1/48 Time: 16.7s Loss: 0.82   Average_Loss: 0.82
2024-10-19 17:47:23,611 - Epoch: 14/64 Batch: 33/48 Time: 50.7s Loss: 0.83   Average_Loss: 0.81
2024-10-19 17:47:39,221 - 
Epoch 14/64,  Loss: 0.80644715949893, Total time: 0h 1m 6s
2024-10-19 17:47:39,222 - -----------------validate-----------------
2024-10-19 17:50:13,768 - Epoch 14, total_user:6040.0 nDCG@5: 0.3313448851878116, HR5: 0.635430463576159, nDCG@10: 0.3787983017374473, HR10: 0.7887417218543047, nDCG@20: 0.40096481977876136, HR20: 0.8778145695364239
2024-10-19 17:50:13,769 - EarlyStopping counter: 1 out of 10
2024-10-19 17:50:28,350 - Epoch: 15/64 Batch: 1/48 Time: 14.6s Loss: 0.82   Average_Loss: 0.82
2024-10-19 17:51:05,501 - Epoch: 15/64 Batch: 33/48 Time: 51.7s Loss: 0.82   Average_Loss: 0.80
2024-10-19 17:51:20,343 - 
Epoch 15/64,  Loss: 0.804328711082538, Total time: 0h 1m 6s
2024-10-19 17:51:20,344 - -----------------validate-----------------
2024-10-19 17:53:56,349 - Epoch 15, total_user:6040.0 nDCG@5: 0.3371630414641221, HR5: 0.6490066225165563, nDCG@10: 0.3817418499891355, HR10: 0.7925496688741722, nDCG@20: 0.40363884036467323, HR20: 0.8807947019867549
2024-10-19 17:53:56,350 - Validation score increased.  Saving model ...
2024-10-19 17:54:15,174 - Epoch: 16/64 Batch: 1/48 Time: 18.8s Loss: 0.79   Average_Loss: 0.79
2024-10-19 17:54:45,940 - Epoch: 16/64 Batch: 33/48 Time: 49.6s Loss: 0.79   Average_Loss: 0.80
2024-10-19 17:55:00,626 - 
Epoch 16/64,  Loss: 0.8037725550433, Total time: 0h 1m 4s
2024-10-19 17:55:00,627 - -----------------validate-----------------
2024-10-19 17:57:36,368 - Epoch 16, total_user:6040.0 nDCG@5: 0.3509408447318304, HR5: 0.6754966887417219, nDCG@10: 0.3899676307018926, HR10: 0.801158940397351, nDCG@20: 0.40985738823908613, HR20: 0.8814569536423841
2024-10-19 17:57:36,369 - Validation score increased.  Saving model ...
2024-10-19 17:57:51,371 - Epoch: 17/64 Batch: 1/48 Time: 15.0s Loss: 0.80   Average_Loss: 0.80
2024-10-19 17:58:26,667 - Epoch: 17/64 Batch: 33/48 Time: 50.3s Loss: 0.79   Average_Loss: 0.80
2024-10-19 17:58:41,271 - 
Epoch 17/64,  Loss: 0.8013529467085997, Total time: 0h 1m 4s
2024-10-19 17:58:41,272 - -----------------validate-----------------
2024-10-19 18:01:15,356 - Epoch 17, total_user:6040.0 nDCG@5: 0.3448257202890661, HR5: 0.6602649006622516, nDCG@10: 0.3898992717524837, HR10: 0.805794701986755, nDCG@20: 0.40970360755012997, HR20: 0.8855960264900662
2024-10-19 18:01:15,357 - Validation score increased.  Saving model ...
2024-10-19 18:01:32,650 - Epoch: 18/64 Batch: 1/48 Time: 17.3s Loss: 0.79   Average_Loss: 0.79
2024-10-19 18:02:05,010 - Epoch: 18/64 Batch: 33/48 Time: 49.6s Loss: 0.81   Average_Loss: 0.80
2024-10-19 18:02:22,073 - 
Epoch 18/64,  Loss: 0.8010563291609287, Total time: 0h 1m 6s
2024-10-19 18:02:22,074 - -----------------validate-----------------
2024-10-19 18:04:59,334 - Epoch 18, total_user:6040.0 nDCG@5: 0.35426006427181633, HR5: 0.6819536423841059, nDCG@10: 0.3946890357658222, HR10: 0.8119205298013245, nDCG@20: 0.41456052775364544, HR20: 0.891887417218543
2024-10-19 18:04:59,335 - Validation score increased.  Saving model ...
2024-10-19 18:05:14,985 - Epoch: 19/64 Batch: 1/48 Time: 15.6s Loss: 0.80   Average_Loss: 0.80
2024-10-19 18:05:51,437 - Epoch: 19/64 Batch: 33/48 Time: 52.1s Loss: 0.78   Average_Loss: 0.80
2024-10-19 18:06:06,091 - 
Epoch 19/64,  Loss: 0.7973640883962313, Total time: 0h 1m 6s
2024-10-19 18:06:06,092 - -----------------validate-----------------
2024-10-19 18:08:42,533 - Epoch 19, total_user:6040.0 nDCG@5: 0.3529114659048309, HR5: 0.6774834437086092, nDCG@10: 0.3958402346098011, HR10: 0.8160596026490067, nDCG@20: 0.41747396366658807, HR20: 0.9029801324503312
2024-10-19 18:08:42,535 - Validation score increased.  Saving model ...
2024-10-19 18:08:57,269 - Epoch: 20/64 Batch: 1/48 Time: 14.7s Loss: 0.82   Average_Loss: 0.82
2024-10-19 18:09:36,258 - Epoch: 20/64 Batch: 33/48 Time: 53.7s Loss: 0.81   Average_Loss: 0.80
2024-10-19 18:09:48,281 - 
Epoch 20/64,  Loss: 0.7978323896725973, Total time: 0h 1m 5s
2024-10-19 18:09:48,282 - -----------------validate-----------------
2024-10-19 18:12:23,113 - Epoch 20, total_user:6040.0 nDCG@5: 0.3354742897057301, HR5: 0.6461920529801325, nDCG@10: 0.38591935466727634, HR10: 0.8086092715231789, nDCG@20: 0.4068689242095352, HR20: 0.8928807947019868
2024-10-19 18:12:23,113 - EarlyStopping counter: 1 out of 10
2024-10-19 18:12:41,062 - Epoch: 21/64 Batch: 1/48 Time: 17.9s Loss: 0.77   Average_Loss: 0.77
2024-10-19 18:13:14,684 - Epoch: 21/64 Batch: 33/48 Time: 51.6s Loss: 0.81   Average_Loss: 0.80
2024-10-19 18:13:32,660 - 
Epoch 21/64,  Loss: 0.7973198791344961, Total time: 0h 1m 9s
2024-10-19 18:13:32,661 - -----------------validate-----------------
2024-10-19 18:16:09,172 - Epoch 21, total_user:6040.0 nDCG@5: 0.35007978034834325, HR5: 0.6745033112582781, nDCG@10: 0.3937595093026065, HR10: 0.8144039735099338, nDCG@20: 0.4150932524967688, HR20: 0.9003311258278146
2024-10-19 18:16:09,173 - EarlyStopping counter: 2 out of 10
2024-10-19 18:16:23,987 - Epoch: 22/64 Batch: 1/48 Time: 14.8s Loss: 0.84   Average_Loss: 0.84
2024-10-19 18:16:59,799 - Epoch: 22/64 Batch: 33/48 Time: 50.6s Loss: 0.79   Average_Loss: 0.80
2024-10-19 18:17:17,012 - 
Epoch 22/64,  Loss: 0.7943147557477156, Total time: 0h 1m 7s
2024-10-19 18:17:17,013 - -----------------validate-----------------
2024-10-19 18:19:54,118 - Epoch 22, total_user:6040.0 nDCG@5: 0.35207055852985397, HR5: 0.6753311258278145, nDCG@10: 0.39732907820142066, HR10: 0.8208609271523178, nDCG@20: 0.41837011859740086, HR20: 0.9054635761589404
2024-10-19 18:19:54,118 - Validation score increased.  Saving model ...
2024-10-19 18:20:14,044 - Epoch: 23/64 Batch: 1/48 Time: 19.9s Loss: 0.75   Average_Loss: 0.75
2024-10-19 18:20:47,999 - Epoch: 23/64 Batch: 33/48 Time: 53.9s Loss: 0.79   Average_Loss: 0.79
2024-10-19 18:20:59,812 - 
Epoch 23/64,  Loss: 0.792132530361414, Total time: 0h 1m 5s
2024-10-19 18:20:59,813 - -----------------validate-----------------
2024-10-19 18:23:36,365 - Epoch 23, total_user:6040.0 nDCG@5: 0.35659951816045327, HR5: 0.6855960264900662, nDCG@10: 0.39893753924933234, HR10: 0.8216887417218544, nDCG@20: 0.4195633424711827, HR20: 0.904635761589404
2024-10-19 18:23:36,366 - Validation score increased.  Saving model ...
2024-10-19 18:23:49,261 - Epoch: 24/64 Batch: 1/48 Time: 12.9s Loss: 0.81   Average_Loss: 0.81
2024-10-19 18:24:29,042 - Epoch: 24/64 Batch: 33/48 Time: 52.7s Loss: 0.79   Average_Loss: 0.79
2024-10-19 18:24:43,594 - 
Epoch 24/64,  Loss: 0.793973454584678, Total time: 0h 1m 7s
2024-10-19 18:24:43,595 - -----------------validate-----------------
2024-10-19 18:27:19,766 - Epoch 24, total_user:6040.0 nDCG@5: 0.35695897778602975, HR5: 0.6857615894039735, nDCG@10: 0.3989429896468472, HR10: 0.8210264900662252, nDCG@20: 0.4210120785482006, HR20: 0.9097682119205298
2024-10-19 18:27:19,767 - Validation score increased.  Saving model ...
2024-10-19 18:27:35,228 - Epoch: 25/64 Batch: 1/48 Time: 15.4s Loss: 0.80   Average_Loss: 0.80
2024-10-19 18:28:08,769 - Epoch: 25/64 Batch: 33/48 Time: 49.0s Loss: 0.77   Average_Loss: 0.79
2024-10-19 18:28:23,949 - 
Epoch 25/64,  Loss: 0.7940122845272223, Total time: 0h 1m 4s
2024-10-19 18:28:23,950 - -----------------validate-----------------
2024-10-19 18:31:02,160 - Epoch 25, total_user:6040.0 nDCG@5: 0.35917502909563853, HR5: 0.6870860927152318, nDCG@10: 0.40148020166825427, HR10: 0.8231788079470199, nDCG@20: 0.4230932710182678, HR20: 0.909933774834437
2024-10-19 18:31:02,161 - Validation score increased.  Saving model ...
2024-10-19 18:31:19,028 - Epoch: 26/64 Batch: 1/48 Time: 16.9s Loss: 0.83   Average_Loss: 0.83
2024-10-19 18:31:52,160 - Epoch: 26/64 Batch: 33/48 Time: 50.0s Loss: 0.76   Average_Loss: 0.79
2024-10-19 18:32:09,830 - 
Epoch 26/64,  Loss: 0.7945737491051356, Total time: 0h 1m 7s
2024-10-19 18:32:09,831 - -----------------validate-----------------
2024-10-19 18:34:45,335 - Epoch 26, total_user:6040.0 nDCG@5: 0.35816525251682235, HR5: 0.6912251655629139, nDCG@10: 0.4011402953416003, HR10: 0.8301324503311258, nDCG@20: 0.42169321755868555, HR20: 0.9125827814569536
2024-10-19 18:34:45,336 - Validation score increased.  Saving model ...
2024-10-19 18:35:01,093 - Epoch: 27/64 Batch: 1/48 Time: 15.7s Loss: 0.82   Average_Loss: 0.82
2024-10-19 18:35:34,351 - Epoch: 27/64 Batch: 33/48 Time: 49.0s Loss: 0.78   Average_Loss: 0.79
2024-10-19 18:35:51,425 - 
Epoch 27/64,  Loss: 0.7922423221170902, Total time: 0h 1m 6s
2024-10-19 18:35:51,426 - -----------------validate-----------------
2024-10-19 18:38:27,265 - Epoch 27, total_user:6040.0 nDCG@5: 0.3591797079187272, HR5: 0.6892384105960265, nDCG@10: 0.4031826983038253, HR10: 0.8306291390728476, nDCG@20: 0.42369047478609284, HR20: 0.9130794701986755
2024-10-19 18:38:27,265 - Validation score increased.  Saving model ...
2024-10-19 18:38:42,874 - Epoch: 28/64 Batch: 1/48 Time: 15.6s Loss: 0.85   Average_Loss: 0.85
2024-10-19 18:39:18,611 - Epoch: 28/64 Batch: 33/48 Time: 51.3s Loss: 0.80   Average_Loss: 0.79
2024-10-19 18:39:34,916 - 
Epoch 28/64,  Loss: 0.7904859036207199, Total time: 0h 1m 7s
2024-10-19 18:39:34,917 - -----------------validate-----------------
2024-10-19 18:42:11,680 - Epoch 28, total_user:6040.0 nDCG@5: 0.3687554881842118, HR5: 0.7048013245033112, nDCG@10: 0.41221351816151874, HR10: 0.8447019867549669, nDCG@20: 0.4322560785297441, HR20: 0.925
2024-10-19 18:42:11,681 - Validation score increased.  Saving model ...
2024-10-19 18:42:30,035 - Epoch: 29/64 Batch: 1/48 Time: 18.3s Loss: 0.80   Average_Loss: 0.80
2024-10-19 18:43:03,502 - Epoch: 29/64 Batch: 33/48 Time: 51.8s Loss: 0.79   Average_Loss: 0.79
2024-10-19 18:43:17,505 - 
Epoch 29/64,  Loss: 0.7907711528241634, Total time: 0h 1m 5s
2024-10-19 18:43:17,506 - -----------------validate-----------------
2024-10-19 18:45:52,914 - Epoch 29, total_user:6040.0 nDCG@5: 0.3688886429346694, HR5: 0.7066225165562914, nDCG@10: 0.4106918795117658, HR10: 0.8415562913907285, nDCG@20: 0.43056376633519494, HR20: 0.9213576158940397
2024-10-19 18:45:52,915 - Validation score increased.  Saving model ...
2024-10-19 18:46:10,680 - Epoch: 30/64 Batch: 1/48 Time: 17.8s Loss: 0.78   Average_Loss: 0.78
2024-10-19 18:46:43,802 - Epoch: 30/64 Batch: 33/48 Time: 50.9s Loss: 0.79   Average_Loss: 0.79
2024-10-19 18:46:58,887 - 
Epoch 30/64,  Loss: 0.7918017593522867, Total time: 0h 1m 5s
2024-10-19 18:46:58,888 - -----------------validate-----------------
2024-10-19 18:49:33,642 - Epoch 30, total_user:6040.0 nDCG@5: 0.3692485163770354, HR5: 0.7091059602649007, nDCG@10: 0.4110879789803223, HR10: 0.8438741721854305, nDCG@20: 0.43047960123946927, HR20: 0.921523178807947
2024-10-19 18:49:33,643 - Validation score increased.  Saving model ...
2024-10-19 18:49:49,865 - Epoch: 31/64 Batch: 1/48 Time: 16.2s Loss: 0.77   Average_Loss: 0.77
2024-10-19 18:50:25,198 - Epoch: 31/64 Batch: 33/48 Time: 51.5s Loss: 0.79   Average_Loss: 0.79
2024-10-19 18:50:39,114 - 
Epoch 31/64,  Loss: 0.7910557587941488, Total time: 0h 1m 5s
2024-10-19 18:50:39,114 - -----------------validate-----------------
2024-10-19 18:53:12,652 - Epoch 31, total_user:6040.0 nDCG@5: 0.3769442855726593, HR5: 0.7173841059602649, nDCG@10: 0.41770274980064026, HR10: 0.8485099337748344, nDCG@20: 0.4371284354305536, HR20: 0.9263245033112583
2024-10-19 18:53:12,653 - Validation score increased.  Saving model ...
2024-10-19 18:53:30,850 - Epoch: 32/64 Batch: 1/48 Time: 18.2s Loss: 0.78   Average_Loss: 0.78
2024-10-19 18:54:04,152 - Epoch: 32/64 Batch: 33/48 Time: 51.5s Loss: 0.79   Average_Loss: 0.79
2024-10-19 18:54:18,334 - 
Epoch 32/64,  Loss: 0.788908859093984, Total time: 0h 1m 5s
2024-10-19 18:54:18,334 - -----------------validate-----------------
2024-10-19 18:56:54,989 - Epoch 32, total_user:6040.0 nDCG@5: 0.37155012156989975, HR5: 0.7087748344370861, nDCG@10: 0.4134602101258392, HR10: 0.8433774834437087, nDCG@20: 0.433731343007536, HR20: 0.9245033112582781
2024-10-19 18:56:54,989 - EarlyStopping counter: 1 out of 10
2024-10-19 18:57:09,595 - Epoch: 33/64 Batch: 1/48 Time: 14.6s Loss: 0.76   Average_Loss: 0.76
2024-10-19 18:57:47,331 - Epoch: 33/64 Batch: 33/48 Time: 52.3s Loss: 0.77   Average_Loss: 0.79
2024-10-19 18:58:00,662 - 
Epoch 33/64,  Loss: 0.7897929412623247, Total time: 0h 1m 5s
2024-10-19 18:58:00,663 - -----------------validate-----------------
2024-10-19 19:00:36,638 - Epoch 33, total_user:6040.0 nDCG@5: 0.36797902624869616, HR5: 0.7051324503311258, nDCG@10: 0.40848185529869235, HR10: 0.8354304635761589, nDCG@20: 0.42889947394438666, HR20: 0.9175496688741722
2024-10-19 19:00:36,639 - EarlyStopping counter: 2 out of 10
2024-10-19 19:00:52,685 - Epoch: 34/64 Batch: 1/48 Time: 16.0s Loss: 0.76   Average_Loss: 0.76
2024-10-19 19:01:25,276 - Epoch: 34/64 Batch: 33/48 Time: 48.6s Loss: 0.80   Average_Loss: 0.79
2024-10-19 19:01:38,231 - 
Epoch 34/64,  Loss: 0.7904546856880188, Total time: 0h 1m 1s
2024-10-19 19:01:38,232 - -----------------validate-----------------
2024-10-19 19:04:11,338 - Epoch 34, total_user:6040.0 nDCG@5: 0.3711905109729944, HR5: 0.7072847682119205, nDCG@10: 0.4121669831800953, HR10: 0.8392384105960264, nDCG@20: 0.43166554668201407, HR20: 0.9175496688741722
2024-10-19 19:04:11,339 - EarlyStopping counter: 3 out of 10
2024-10-19 19:04:26,666 - Epoch: 35/64 Batch: 1/48 Time: 15.3s Loss: 0.82   Average_Loss: 0.82
2024-10-19 19:05:01,583 - Epoch: 35/64 Batch: 33/48 Time: 50.2s Loss: 0.78   Average_Loss: 0.79
2024-10-19 19:05:17,292 - 
Epoch 35/64,  Loss: 0.7867766159276167, Total time: 0h 1m 5s
2024-10-19 19:05:17,293 - -----------------validate-----------------
2024-10-19 19:07:53,605 - Epoch 35, total_user:6040.0 nDCG@5: 0.37116592264186227, HR5: 0.7102649006622517, nDCG@10: 0.4121842870585012, HR10: 0.8418874172185431, nDCG@20: 0.4318637023895349, HR20: 0.9205298013245033
2024-10-19 19:07:53,606 - EarlyStopping counter: 4 out of 10
2024-10-19 19:08:10,013 - Epoch: 36/64 Batch: 1/48 Time: 16.4s Loss: 0.76   Average_Loss: 0.76
2024-10-19 19:08:42,994 - Epoch: 36/64 Batch: 33/48 Time: 49.4s Loss: 0.80   Average_Loss: 0.79
2024-10-19 19:08:59,262 - 
Epoch 36/64,  Loss: 0.788003459572792, Total time: 0h 1m 5s
2024-10-19 19:08:59,263 - -----------------validate-----------------
2024-10-19 19:11:35,887 - Epoch 36, total_user:6040.0 nDCG@5: 0.3778802932175023, HR5: 0.7198675496688741, nDCG@10: 0.41781860448798475, HR10: 0.8481788079470198, nDCG@20: 0.43772581269887895, HR20: 0.9276490066225166
2024-10-19 19:11:35,888 - Validation score increased.  Saving model ...
2024-10-19 19:11:53,671 - Epoch: 37/64 Batch: 1/48 Time: 17.8s Loss: 0.77   Average_Loss: 0.77
2024-10-19 19:12:27,806 - Epoch: 37/64 Batch: 33/48 Time: 51.9s Loss: 0.79   Average_Loss: 0.78
2024-10-19 19:12:41,145 - 
Epoch 37/64,  Loss: 0.7857564116517702, Total time: 0h 1m 5s
2024-10-19 19:12:41,145 - -----------------validate-----------------
2024-10-19 19:15:35,831 - Epoch 37, total_user:6040.0 nDCG@5: 0.3758286205625851, HR5: 0.7195364238410596, nDCG@10: 0.4168975538306504, HR10: 0.8514900662251655, nDCG@20: 0.4357633389202011, HR20: 0.927317880794702
2024-10-19 19:15:35,832 - Validation score increased.  Saving model ...
2024-10-19 19:15:52,168 - Epoch: 38/64 Batch: 1/48 Time: 16.3s Loss: 0.79   Average_Loss: 0.79
2024-10-19 19:16:22,177 - Epoch: 38/64 Batch: 33/48 Time: 46.3s Loss: 0.80   Average_Loss: 0.79
2024-10-19 19:16:37,900 - 
Epoch 38/64,  Loss: 0.7879602052271366, Total time: 0h 1m 2s
2024-10-19 19:16:37,900 - -----------------validate-----------------
2024-10-19 19:19:12,531 - Epoch 38, total_user:6040.0 nDCG@5: 0.37870832704628216, HR5: 0.7230132450331126, nDCG@10: 0.4181566602118467, HR10: 0.8501655629139073, nDCG@20: 0.43771186841501913, HR20: 0.9281456953642384
2024-10-19 19:19:12,532 - Validation score increased.  Saving model ...
2024-10-19 19:19:27,194 - Epoch: 39/64 Batch: 1/48 Time: 14.6s Loss: 0.79   Average_Loss: 0.79
2024-10-19 19:20:00,532 - Epoch: 39/64 Batch: 33/48 Time: 48.0s Loss: 0.80   Average_Loss: 0.79
2024-10-19 19:20:15,440 - 
Epoch 39/64,  Loss: 0.7834116208056608, Total time: 0h 1m 2s
2024-10-19 19:20:15,440 - -----------------validate-----------------
2024-10-19 19:22:48,466 - Epoch 39, total_user:6040.0 nDCG@5: 0.38011569721562305, HR5: 0.7230132450331126, nDCG@10: 0.41966616101803256, HR10: 0.8498344370860927, nDCG@20: 0.4393327951270972, HR20: 0.9283112582781456
2024-10-19 19:22:48,467 - Validation score increased.  Saving model ...
2024-10-19 19:23:03,503 - Epoch: 40/64 Batch: 1/48 Time: 15.0s Loss: 0.80   Average_Loss: 0.80
2024-10-19 19:23:38,994 - Epoch: 40/64 Batch: 33/48 Time: 50.5s Loss: 0.77   Average_Loss: 0.79
2024-10-19 19:23:51,460 - 
Epoch 40/64,  Loss: 0.7860613589485487, Total time: 0h 1m 2s
2024-10-19 19:23:51,460 - -----------------validate-----------------
2024-10-19 19:26:25,024 - Epoch 40, total_user:6040.0 nDCG@5: 0.37941657388238925, HR5: 0.723841059602649, nDCG@10: 0.41957469997517477, HR10: 0.8538079470198675, nDCG@20: 0.43861551950119754, HR20: 0.9298013245033112
2024-10-19 19:26:25,025 - Validation score increased.  Saving model ...
2024-10-19 19:26:39,092 - Epoch: 41/64 Batch: 1/48 Time: 14.1s Loss: 0.79   Average_Loss: 0.79
2024-10-19 19:27:12,734 - Epoch: 41/64 Batch: 33/48 Time: 47.7s Loss: 0.77   Average_Loss: 0.79
2024-10-19 19:27:25,961 - 
Epoch 41/64,  Loss: 0.7860979996621609, Total time: 0h 1m 0s
2024-10-19 19:27:25,962 - -----------------validate-----------------
2024-10-19 19:30:04,601 - Epoch 41, total_user:6040.0 nDCG@5: 0.3841480936310593, HR5: 0.7298013245033113, nDCG@10: 0.4233755857611886, HR10: 0.8559602649006622, nDCG@20: 0.4420728264313575, HR20: 0.930794701986755
2024-10-19 19:30:04,602 - Validation score increased.  Saving model ...
2024-10-19 19:30:20,947 - Epoch: 42/64 Batch: 1/48 Time: 16.3s Loss: 0.80   Average_Loss: 0.80
2024-10-19 19:30:52,318 - Epoch: 42/64 Batch: 33/48 Time: 47.7s Loss: 0.79   Average_Loss: 0.78
2024-10-19 19:31:06,453 - 
Epoch 42/64,  Loss: 0.7828340046107769, Total time: 0h 1m 1s
2024-10-19 19:31:06,454 - -----------------validate-----------------
2024-10-19 19:33:39,032 - Epoch 42, total_user:6040.0 nDCG@5: 0.38484606331389404, HR5: 0.7317880794701986, nDCG@10: 0.4240068162846155, HR10: 0.8584437086092715, nDCG@20: 0.4418241265633121, HR20: 0.9294701986754967
2024-10-19 19:33:39,034 - Validation score increased.  Saving model ...
2024-10-19 19:33:55,941 - Epoch: 43/64 Batch: 1/48 Time: 16.9s Loss: 0.77   Average_Loss: 0.77
2024-10-19 19:34:27,014 - Epoch: 43/64 Batch: 33/48 Time: 48.0s Loss: 0.81   Average_Loss: 0.79
2024-10-19 19:34:41,051 - 
Epoch 43/64,  Loss: 0.7845107950270176, Total time: 0h 1m 2s
2024-10-19 19:34:41,051 - -----------------validate-----------------
2024-10-19 19:37:13,736 - Epoch 43, total_user:6040.0 nDCG@5: 0.3849607428126231, HR5: 0.7327814569536424, nDCG@10: 0.42372665470918075, HR10: 0.858112582781457, nDCG@20: 0.4424754671684615, HR20: 0.9332781456953643
2024-10-19 19:37:13,737 - Validation score increased.  Saving model ...
2024-10-19 19:37:28,963 - Epoch: 44/64 Batch: 1/48 Time: 15.2s Loss: 0.78   Average_Loss: 0.78
2024-10-19 19:38:03,269 - Epoch: 44/64 Batch: 33/48 Time: 49.5s Loss: 0.75   Average_Loss: 0.78
2024-10-19 19:38:17,714 - 
Epoch 44/64,  Loss: 0.7847590607901415, Total time: 0h 1m 3s
2024-10-19 19:38:17,715 - -----------------validate-----------------
2024-10-19 19:40:52,149 - Epoch 44, total_user:6040.0 nDCG@5: 0.38431044181974333, HR5: 0.7317880794701986, nDCG@10: 0.42428654007540245, HR10: 0.8607615894039735, nDCG@20: 0.4426125325227723, HR20: 0.9337748344370861
2024-10-19 19:40:52,150 - Validation score increased.  Saving model ...
2024-10-19 19:41:06,758 - Epoch: 45/64 Batch: 1/48 Time: 14.6s Loss: 0.79   Average_Loss: 0.79
2024-10-19 19:41:38,508 - Epoch: 45/64 Batch: 33/48 Time: 46.3s Loss: 0.79   Average_Loss: 0.79
2024-10-19 19:41:52,533 - 
Epoch 45/64,  Loss: 0.7859595753252506, Total time: 0h 1m 0s
2024-10-19 19:41:52,534 - -----------------validate-----------------
2024-10-19 19:44:24,582 - Epoch 45, total_user:6040.0 nDCG@5: 0.38335531461801997, HR5: 0.7316225165562914, nDCG@10: 0.42273973333809123, HR10: 0.858112582781457, nDCG@20: 0.4417826966017994, HR20: 0.9341059602649007
2024-10-19 19:44:24,583 - EarlyStopping counter: 1 out of 10
2024-10-19 19:44:39,760 - Epoch: 46/64 Batch: 1/48 Time: 15.2s Loss: 0.76   Average_Loss: 0.76
2024-10-19 19:45:13,083 - Epoch: 46/64 Batch: 33/48 Time: 48.5s Loss: 0.78   Average_Loss: 0.79
2024-10-19 19:45:26,044 - 
Epoch 46/64,  Loss: 0.7855072468519211, Total time: 0h 1m 1s
2024-10-19 19:45:26,045 - -----------------validate-----------------
2024-10-19 19:48:00,232 - Epoch 46, total_user:6040.0 nDCG@5: 0.3773331689105178, HR5: 0.7182119205298013, nDCG@10: 0.41988991071506776, HR10: 0.8554635761589404, nDCG@20: 0.43787168106694335, HR20: 0.927317880794702
2024-10-19 19:48:00,233 - EarlyStopping counter: 2 out of 10
2024-10-19 19:48:14,501 - Epoch: 47/64 Batch: 1/48 Time: 14.3s Loss: 0.78   Average_Loss: 0.78
2024-10-19 19:48:48,503 - Epoch: 47/64 Batch: 33/48 Time: 48.3s Loss: 0.73   Average_Loss: 0.78
2024-10-19 19:49:02,338 - 
Epoch 47/64,  Loss: 0.7835756416122118, Total time: 0h 1m 2s
2024-10-19 19:49:02,338 - -----------------validate-----------------
2024-10-19 19:51:40,573 - Epoch 47, total_user:6040.0 nDCG@5: 0.38359780322379805, HR5: 0.729635761589404, nDCG@10: 0.4235612736471022, HR10: 0.8589403973509934, nDCG@20: 0.44174492621511025, HR20: 0.9316225165562914
2024-10-19 19:51:40,574 - EarlyStopping counter: 3 out of 10
2024-10-19 19:51:56,990 - Epoch: 48/64 Batch: 1/48 Time: 16.4s Loss: 0.78   Average_Loss: 0.78
2024-10-19 19:52:33,807 - Epoch: 48/64 Batch: 33/48 Time: 53.2s Loss: 0.78   Average_Loss: 0.78
2024-10-19 19:52:48,229 - 
Epoch 48/64,  Loss: 0.7828775644302368, Total time: 0h 1m 7s
2024-10-19 19:52:48,229 - -----------------validate-----------------
2024-10-19 19:55:25,640 - Epoch 48, total_user:6040.0 nDCG@5: 0.38394302001625363, HR5: 0.7299668874172185, nDCG@10: 0.4233322963978877, HR10: 0.8574503311258278, nDCG@20: 0.4417366539644466, HR20: 0.930794701986755
2024-10-19 19:55:25,641 - EarlyStopping counter: 4 out of 10
2024-10-19 19:55:40,041 - Epoch: 49/64 Batch: 1/48 Time: 14.4s Loss: 0.79   Average_Loss: 0.79
2024-10-19 19:56:18,510 - Epoch: 49/64 Batch: 33/48 Time: 52.9s Loss: 0.80   Average_Loss: 0.79
2024-10-19 19:56:32,007 - 
Epoch 49/64,  Loss: 0.7850408578912417, Total time: 0h 1m 6s
2024-10-19 19:56:32,008 - -----------------validate-----------------
2024-10-19 19:59:08,000 - Epoch 49, total_user:6040.0 nDCG@5: 0.3841953051740264, HR5: 0.729635761589404, nDCG@10: 0.42395619398841927, HR10: 0.8577814569536424, nDCG@20: 0.44220912061109097, HR20: 0.9306291390728477
2024-10-19 19:59:08,001 - EarlyStopping counter: 5 out of 10
2024-10-19 19:59:20,713 - Epoch: 50/64 Batch: 1/48 Time: 12.7s Loss: 0.82   Average_Loss: 0.82
2024-10-19 20:00:01,536 - Epoch: 50/64 Batch: 33/48 Time: 53.5s Loss: 0.76   Average_Loss: 0.78
2024-10-19 20:00:15,228 - 
Epoch 50/64,  Loss: 0.7829460427165031, Total time: 0h 1m 7s
2024-10-19 20:00:15,229 - -----------------validate-----------------
2024-10-19 20:02:50,391 - Epoch 50, total_user:6040.0 nDCG@5: 0.3852980847511308, HR5: 0.7354304635761589, nDCG@10: 0.42426510587060234, HR10: 0.8609271523178808, nDCG@20: 0.4424312265706594, HR20: 0.9327814569536423
2024-10-19 20:02:50,392 - Validation score increased.  Saving model ...
2024-10-19 20:03:05,487 - Epoch: 51/64 Batch: 1/48 Time: 15.1s Loss: 0.80   Average_Loss: 0.80
2024-10-19 20:03:42,786 - Epoch: 51/64 Batch: 33/48 Time: 52.4s Loss: 0.77   Average_Loss: 0.78
2024-10-19 20:03:56,633 - 
Epoch 51/64,  Loss: 0.7808920418222746, Total time: 0h 1m 6s
2024-10-19 20:03:56,634 - -----------------validate-----------------
2024-10-19 20:06:31,608 - Epoch 51, total_user:6040.0 nDCG@5: 0.38945366583824975, HR5: 0.7433774834437086, nDCG@10: 0.42812564795462416, HR10: 0.868046357615894, nDCG@20: 0.4456729409350131, HR20: 0.9382450331125828
2024-10-19 20:06:31,609 - Validation score increased.  Saving model ...
2024-10-19 20:06:48,800 - Epoch: 52/64 Batch: 1/48 Time: 17.2s Loss: 0.77   Average_Loss: 0.77
2024-10-19 20:07:24,593 - Epoch: 52/64 Batch: 33/48 Time: 53.0s Loss: 0.77   Average_Loss: 0.78
2024-10-19 20:07:37,322 - 
Epoch 52/64,  Loss: 0.7819506165881952, Total time: 0h 1m 5s
2024-10-19 20:07:37,323 - -----------------validate-----------------
2024-10-19 20:10:13,166 - Epoch 52, total_user:6040.0 nDCG@5: 0.38659497643848534, HR5: 0.7359271523178808, nDCG@10: 0.4244670409600279, HR10: 0.8582781456953642, nDCG@20: 0.44322828921687546, HR20: 0.9327814569536423
2024-10-19 20:10:13,167 - EarlyStopping counter: 1 out of 10
2024-10-19 20:10:28,759 - Epoch: 53/64 Batch: 1/48 Time: 15.6s Loss: 0.81   Average_Loss: 0.81
2024-10-19 20:10:59,341 - Epoch: 53/64 Batch: 33/48 Time: 46.2s Loss: 0.75   Average_Loss: 0.78
2024-10-19 20:11:15,165 - 
Epoch 53/64,  Loss: 0.7844370131691297, Total time: 0h 1m 1s
2024-10-19 20:11:15,166 - -----------------validate-----------------
2024-10-19 20:13:49,521 - Epoch 53, total_user:6040.0 nDCG@5: 0.3897207487712902, HR5: 0.7405629139072848, nDCG@10: 0.42661819228637715, HR10: 0.8597682119205298, nDCG@20: 0.44500070728176927, HR20: 0.9327814569536423
2024-10-19 20:13:49,522 - EarlyStopping counter: 2 out of 10
2024-10-19 20:14:05,008 - Epoch: 54/64 Batch: 1/48 Time: 15.5s Loss: 0.77   Average_Loss: 0.77
2024-10-19 20:14:37,792 - Epoch: 54/64 Batch: 33/48 Time: 48.3s Loss: 0.78   Average_Loss: 0.78
2024-10-19 20:14:52,096 - 
Epoch 54/64,  Loss: 0.7809293915828069, Total time: 0h 1m 2s
2024-10-19 20:14:52,097 - -----------------validate-----------------
2024-10-19 20:17:27,378 - Epoch 54, total_user:6040.0 nDCG@5: 0.38841240096338936, HR5: 0.7442052980132451, nDCG@10: 0.424478924049998, HR10: 0.8614238410596027, nDCG@20: 0.4419001544071519, HR20: 0.930794701986755
2024-10-19 20:17:27,379 - EarlyStopping counter: 3 out of 10
2024-10-19 20:17:45,648 - Epoch: 55/64 Batch: 1/48 Time: 18.3s Loss: 0.76   Average_Loss: 0.76
2024-10-19 20:18:17,408 - Epoch: 55/64 Batch: 33/48 Time: 50.0s Loss: 0.78   Average_Loss: 0.78
2024-10-19 20:18:30,729 - 
Epoch 55/64,  Loss: 0.7845077477395535, Total time: 0h 1m 3s
2024-10-19 20:18:30,729 - -----------------validate-----------------
2024-10-19 20:21:21,366 - Epoch 55, total_user:6040.0 nDCG@5: 0.3903130859117393, HR5: 0.7417218543046358, nDCG@10: 0.42890308074464, HR10: 0.866225165562914, nDCG@20: 0.44524650782357555, HR20: 0.9316225165562914
2024-10-19 20:21:21,367 - EarlyStopping counter: 4 out of 10
2024-10-19 20:21:36,328 - Epoch: 56/64 Batch: 1/48 Time: 15.0s Loss: 0.77   Average_Loss: 0.77
2024-10-19 20:22:12,202 - Epoch: 56/64 Batch: 33/48 Time: 50.8s Loss: 0.80   Average_Loss: 0.78
2024-10-19 20:22:25,465 - 
Epoch 56/64,  Loss: 0.7813078413407007, Total time: 0h 1m 4s
2024-10-19 20:22:25,466 - -----------------validate-----------------
2024-10-19 20:25:09,452 - Epoch 56, total_user:6040.0 nDCG@5: 0.387144332444937, HR5: 0.7334437086092715, nDCG@10: 0.4274919639787618, HR10: 0.8635761589403973, nDCG@20: 0.4467130600457603, HR20: 0.9405629139072847
2024-10-19 20:25:09,453 - Validation score increased.  Saving model ...
2024-10-19 20:25:25,168 - Epoch: 57/64 Batch: 1/48 Time: 15.7s Loss: 0.79   Average_Loss: 0.79
2024-10-19 20:25:59,921 - Epoch: 57/64 Batch: 33/48 Time: 50.5s Loss: 0.76   Average_Loss: 0.78
2024-10-19 20:26:13,321 - 
Epoch 57/64,  Loss: 0.7820892247060934, Total time: 0h 1m 3s
2024-10-19 20:26:13,322 - -----------------validate-----------------
2024-10-19 20:29:06,032 - Epoch 57, total_user:6040.0 nDCG@5: 0.3910271408171305, HR5: 0.7437086092715232, nDCG@10: 0.4287820181903684, HR10: 0.8655629139072848, nDCG@20: 0.44629112394550263, HR20: 0.9352649006622517
2024-10-19 20:29:06,033 - Validation score increased.  Saving model ...
2024-10-19 20:29:19,456 - Epoch: 58/64 Batch: 1/48 Time: 13.4s Loss: 0.76   Average_Loss: 0.76
2024-10-19 20:29:57,202 - Epoch: 58/64 Batch: 33/48 Time: 51.2s Loss: 0.79   Average_Loss: 0.78
2024-10-19 20:30:09,529 - 
Epoch 58/64,  Loss: 0.7820488276580969, Total time: 0h 1m 3s
2024-10-19 20:30:09,529 - -----------------validate-----------------
2024-10-19 20:32:57,315 - Epoch 58, total_user:6040.0 nDCG@5: 0.38770818371454796, HR5: 0.7369205298013245, nDCG@10: 0.4276606960753187, HR10: 0.8655629139072848, nDCG@20: 0.4453197273357756, HR20: 0.9357615894039735
2024-10-19 20:32:57,316 - EarlyStopping counter: 1 out of 10
2024-10-19 20:33:16,140 - Epoch: 59/64 Batch: 1/48 Time: 18.8s Loss: 0.75   Average_Loss: 0.75
2024-10-19 20:33:52,656 - Epoch: 59/64 Batch: 33/48 Time: 55.3s Loss: 0.76   Average_Loss: 0.78
2024-10-19 20:34:07,972 - 
Epoch 59/64,  Loss: 0.7795585592587789, Total time: 0h 1m 10s
2024-10-19 20:34:07,972 - -----------------validate-----------------
2024-10-19 20:36:48,598 - Epoch 59, total_user:6040.0 nDCG@5: 0.38926033558594086, HR5: 0.7420529801324504, nDCG@10: 0.4263155594070098, HR10: 0.8615894039735099, nDCG@20: 0.4444783983990763, HR20: 0.9339403973509933
2024-10-19 20:36:48,599 - EarlyStopping counter: 2 out of 10
2024-10-19 20:37:05,710 - Epoch: 60/64 Batch: 1/48 Time: 17.1s Loss: 0.76   Average_Loss: 0.76
2024-10-19 20:37:39,935 - Epoch: 60/64 Batch: 33/48 Time: 51.3s Loss: 0.79   Average_Loss: 0.78
2024-10-19 20:37:54,377 - 
Epoch 60/64,  Loss: 0.7821057115991911, Total time: 0h 1m 5s
2024-10-19 20:37:54,378 - -----------------validate-----------------
2024-10-19 20:40:31,876 - Epoch 60, total_user:6040.0 nDCG@5: 0.3895243878706163, HR5: 0.7425496688741722, nDCG@10: 0.42703988031517404, HR10: 0.8634105960264901, nDCG@20: 0.4446438389105631, HR20: 0.9331125827814569
2024-10-19 20:40:31,877 - EarlyStopping counter: 3 out of 10
2024-10-19 20:40:50,659 - Epoch: 61/64 Batch: 1/48 Time: 18.8s Loss: 0.78   Average_Loss: 0.78
2024-10-19 20:41:30,145 - Epoch: 61/64 Batch: 33/48 Time: 58.3s Loss: 0.80   Average_Loss: 0.78
2024-10-19 20:41:45,439 - 
Epoch 61/64,  Loss: 0.7832934583226839, Total time: 0h 1m 13s
2024-10-19 20:41:45,439 - -----------------validate-----------------
2024-10-19 20:44:43,434 - Epoch 61, total_user:6040.0 nDCG@5: 0.39242448415457615, HR5: 0.7460264900662251, nDCG@10: 0.42903817300720465, HR10: 0.8644039735099338, nDCG@20: 0.44752430797668113, HR20: 0.9382450331125828
2024-10-19 20:44:43,434 - Validation score increased.  Saving model ...
2024-10-19 20:45:00,646 - Epoch: 62/64 Batch: 1/48 Time: 17.2s Loss: 0.78   Average_Loss: 0.78
2024-10-19 20:45:40,195 - Epoch: 62/64 Batch: 33/48 Time: 56.8s Loss: 0.75   Average_Loss: 0.78
2024-10-19 20:45:52,842 - 
Epoch 62/64,  Loss: 0.778506321211656, Total time: 0h 1m 9s
2024-10-19 20:45:52,843 - -----------------validate-----------------
2024-10-19 20:48:35,107 - Epoch 62, total_user:6040.0 nDCG@5: 0.39019616961805575, HR5: 0.7420529801324504, nDCG@10: 0.4297614645015791, HR10: 0.8697019867549669, nDCG@20: 0.44669201606868236, HR20: 0.9374172185430464
2024-10-19 20:48:35,108 - Validation score increased.  Saving model ...
2024-10-19 20:48:52,916 - Epoch: 63/64 Batch: 1/48 Time: 17.8s Loss: 0.78   Average_Loss: 0.78
2024-10-19 20:49:29,901 - Epoch: 63/64 Batch: 33/48 Time: 54.8s Loss: 0.82   Average_Loss: 0.78
2024-10-19 20:49:44,274 - 
Epoch 63/64,  Loss: 0.7826788164675236, Total time: 0h 1m 9s
2024-10-19 20:49:44,275 - -----------------validate-----------------
2024-10-19 20:52:24,894 - Epoch 63, total_user:6040.0 nDCG@5: 0.38779104658105956, HR5: 0.7355960264900663, nDCG@10: 0.4279734741048541, HR10: 0.8649006622516556, nDCG@20: 0.44593923320742895, HR20: 0.9364238410596026
2024-10-19 20:52:24,895 - EarlyStopping counter: 1 out of 10
2024-10-19 20:52:45,881 - Epoch: 64/64 Batch: 1/48 Time: 21.0s Loss: 0.76   Average_Loss: 0.76
2024-10-19 20:53:22,077 - Epoch: 64/64 Batch: 33/48 Time: 57.2s Loss: 0.78   Average_Loss: 0.78
2024-10-19 20:53:36,575 - 
Epoch 64/64,  Loss: 0.7805879252652327, Total time: 0h 1m 11s
2024-10-19 20:53:36,576 - -----------------validate-----------------
2024-10-19 20:56:18,247 - Epoch 64, total_user:6040.0 nDCG@5: 0.3897049105104064, HR5: 0.7422185430463576, nDCG@10: 0.4272683623768715, HR10: 0.8637417218543046, nDCG@20: 0.44479008305652584, HR20: 0.9336092715231789
2024-10-19 20:56:18,248 - EarlyStopping counter: 2 out of 10
2024-10-19 20:56:18,248 - ---------------Test Score---------------
2024-10-19 20:56:18,261 - -----------------test-----------------
2024-10-19 20:59:00,042 - Epoch 1, total_user:6040.0 nDCG@5: 0.31623973115416887, HR5: 0.6064569536423841, nDCG@10: 0.3595989137111265, HR10: 0.7473509933774835, nDCG@20: 0.3976376209300259, HR20: 0.8996688741721854
2024-10-19 20:59:00,042 - Oct-19-2024_16-59-28
2024-10-26 04:01:44,568 - read <class 'data_processing.ml_1m'>
2024-10-26 04:01:49,154 - Namespace(data_dir='./data/', output_dir='output/', data_name='ml-1m', llm_path='./bert-base-uncased', do_eval=True, load_model='BSARec', train_name='Oct-26-2024_04-01-44', num_items=3952, num_users=6040, num_neg_sample=100, lr=0.003, weight_decay=0, batch_size=128, num_epochs=64, patience=5, num_workers=4, seed=42, model_type='BSARec', max_seq_length=50, dropout_rate=0.5, hidden_size=64, num_hidden_layers=2, attn_dropout_rate=0.5, n_heads=8, e_layers=4, alpha=0.8, device=device(type='cuda'), checkpoint_path='output/ml-1m/BSARec.pt', dim_user_discrete_data=[2, 7, 21, 3439], dim_item_discrete_data=18)
2024-10-26 04:01:49,187 - BSARec(
  (item_emb): Embedding(3953, 64, padding_idx=0)
  (pos_emb): Embedding(50, 64)
  (dropout): Dropout(p=0.5, inplace=False)
  (attention_blocks): ModuleList(
    (0-3): 4 x TransformerBlock(
      (attention): MultiheadAttention(
        (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
      )
      (filter_layer): FrequencyLayer(
        (out_dropout): Dropout(p=0.5, inplace=False)
        (layer_norm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      )
      (ffn): Sequential(
        (0): Linear(in_features=64, out_features=64, bias=True)
        (1): ReLU()
        (2): Dropout(p=0.5, inplace=False)
        (3): Linear(in_features=64, out_features=64, bias=True)
      )
      (norm1): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
      (norm2): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
      (dropout): Dropout(p=0.5, inplace=False)
    )
  )
)
2024-10-26 04:01:49,306 - Load model from output/ml-1m/BSARec.pt for test!
2024-10-26 04:01:49,306 - -----------------test-----------------
2024-10-26 04:04:28,096 - Epoch 2, total_user:6040.0 nDCG@5: 0.3169740009567005, HR5: 0.6077814569536424, nDCG@10: 0.3618385866932882, HR10: 0.7536423841059603, nDCG@20: 0.3981047908001984, HR20: 0.8993377483443709
2024-10-26 04:04:28,097 - Oct-26-2024_04-01-44
