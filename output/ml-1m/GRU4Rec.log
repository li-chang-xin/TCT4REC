2024-10-19 21:31:44,242 - read <class 'data_processing.ml_1m'>
2024-10-19 21:31:48,744 - Namespace(data_dir='./data/', output_dir='output/', data_name='ml-1m', llm_path='./bert-base-uncased', do_eval=False, load_model='TCTRec', train_name='Oct-19-2024_21-31-44', num_items=3952, num_users=6040, num_neg_sample=100, lr=0.003, weight_decay=0, batch_size=128, num_epochs=64, patience=10, num_workers=4, model_type='GRU4Rec', max_seq_length=50, dropout_rate=0.5, hidden_size=64, num_hidden_layers=2, attn_dropout_rate=0.5, n_heads=8, e_layers=4, alpha=0.8, gru_hidden_size=64, initializer_range=0.02, device=device(type='cuda'), checkpoint_path='output/ml-1m/GRU4Rec.pt', dim_user_discrete_data=[2, 7, 21, 3439], dim_item_discrete_data=18)
2024-10-19 21:31:48,777 - GRU4Rec(
  (item_embeddings): Embedding(3953, 64, padding_idx=0)
  (gru_layers): GRU(64, 64, num_layers=2, bias=False, batch_first=True)
  (emb_dropout): Dropout(p=0.5, inplace=False)
  (dense): Linear(in_features=64, out_features=64, bias=True)
)
2024-10-19 21:31:49,477 - training start
2024-10-19 21:32:05,968 - Epoch: 1/64 Batch: 1/48 Time: 16.5s Loss: 0.69   Average_Loss: 0.69
2024-10-19 21:32:42,618 - Epoch: 1/64 Batch: 33/48 Time: 53.1s Loss: 0.33   Average_Loss: 0.46
2024-10-19 21:32:56,607 - 
Epoch 1/64,  Loss: 0.4120307117700577, Total time: 0h 1m 7s
2024-10-19 21:32:56,608 - -----------------validate-----------------
2024-10-19 21:34:03,058 - Epoch 1, total_user:6040.0 nDCG@5: 0.29138339069130276, HR5: 0.5662251655629139, nDCG@10: 0.34283282878564647, HR10: 0.7334437086092715, nDCG@20: 0.37191877538714546, HR20: 0.8498344370860927
2024-10-19 21:34:03,059 - Validation score increased.  Saving model ...
2024-10-19 21:34:17,669 - Epoch: 2/64 Batch: 1/48 Time: 14.6s Loss: 0.31   Average_Loss: 0.31
2024-10-19 21:34:55,556 - Epoch: 2/64 Batch: 33/48 Time: 52.5s Loss: 0.29   Average_Loss: 0.30
2024-10-19 21:35:13,833 - 
Epoch 2/64,  Loss: 0.29937566444277763, Total time: 0h 1m 10s
2024-10-19 21:35:13,833 - -----------------validate-----------------
2024-10-19 21:36:20,012 - Epoch 2, total_user:6040.0 nDCG@5: 0.30188278784711203, HR5: 0.5885761589403974, nDCG@10: 0.353035714552158, HR10: 0.7538079470198675, nDCG@20: 0.37865605906078464, HR20: 0.8566225165562914
2024-10-19 21:36:20,013 - Validation score increased.  Saving model ...
2024-10-19 21:36:35,903 - Epoch: 3/64 Batch: 1/48 Time: 15.9s Loss: 0.29   Average_Loss: 0.29
2024-10-19 21:37:12,894 - Epoch: 3/64 Batch: 33/48 Time: 52.9s Loss: 0.29   Average_Loss: 0.28
2024-10-19 21:37:26,353 - 
Epoch 3/64,  Loss: 0.2773385876789689, Total time: 0h 1m 6s
2024-10-19 21:37:26,354 - -----------------validate-----------------
2024-10-19 21:38:32,470 - Epoch 3, total_user:6040.0 nDCG@5: 0.3024559852161615, HR5: 0.5928807947019867, nDCG@10: 0.3536322616339478, HR10: 0.7591059602649006, nDCG@20: 0.3862837667793594, HR20: 0.8899006622516556
2024-10-19 21:38:32,470 - Validation score increased.  Saving model ...
2024-10-19 21:38:49,936 - Epoch: 4/64 Batch: 1/48 Time: 17.5s Loss: 0.25   Average_Loss: 0.25
2024-10-19 21:39:22,272 - Epoch: 4/64 Batch: 33/48 Time: 49.8s Loss: 0.22   Average_Loss: 0.24
2024-10-19 21:39:37,745 - 
Epoch 4/64,  Loss: 0.22800773258010545, Total time: 0h 1m 5s
2024-10-19 21:39:37,746 - -----------------validate-----------------
2024-10-19 21:40:43,837 - Epoch 4, total_user:6040.0 nDCG@5: 0.3399786758816703, HR5: 0.6490066225165563, nDCG@10: 0.38272734984678114, HR10: 0.7877483443708609, nDCG@20: 0.41306561128022723, HR20: 0.909271523178808
2024-10-19 21:40:43,838 - Validation score increased.  Saving model ...
2024-10-19 21:40:58,566 - Epoch: 5/64 Batch: 1/48 Time: 14.7s Loss: 0.21   Average_Loss: 0.21
2024-10-19 21:41:35,161 - Epoch: 5/64 Batch: 33/48 Time: 51.3s Loss: 0.22   Average_Loss: 0.21
2024-10-19 21:41:52,903 - 
Epoch 5/64,  Loss: 0.20523163924614587, Total time: 0h 1m 9s
2024-10-19 21:41:52,904 - -----------------validate-----------------
2024-10-19 21:43:00,850 - Epoch 5, total_user:6040.0 nDCG@5: 0.35153884273774433, HR5: 0.6801324503311258, nDCG@10: 0.40042003346549393, HR10: 0.8379139072847682, nDCG@20: 0.4230564419430934, HR20: 0.928476821192053
2024-10-19 21:43:00,851 - Validation score increased.  Saving model ...
2024-10-19 21:43:17,666 - Epoch: 6/64 Batch: 1/48 Time: 16.8s Loss: 0.18   Average_Loss: 0.18
2024-10-19 21:43:53,687 - Epoch: 6/64 Batch: 33/48 Time: 52.8s Loss: 0.17   Average_Loss: 0.20
2024-10-19 21:44:06,610 - 
Epoch 6/64,  Loss: 0.19337718499203524, Total time: 0h 1m 5s
2024-10-19 21:44:06,610 - -----------------validate-----------------
2024-10-19 21:45:12,224 - Epoch 6, total_user:6040.0 nDCG@5: 0.3467607783073283, HR5: 0.6874172185430464, nDCG@10: 0.3951490262506124, HR10: 0.8432119205298013, nDCG@20: 0.4167436930358944, HR20: 0.929635761589404
2024-10-19 21:45:12,225 - Validation score increased.  Saving model ...
2024-10-19 21:45:30,401 - Epoch: 7/64 Batch: 1/48 Time: 18.2s Loss: 0.18   Average_Loss: 0.18
2024-10-19 21:46:06,158 - Epoch: 7/64 Batch: 33/48 Time: 53.9s Loss: 0.18   Average_Loss: 0.18
2024-10-19 21:46:20,044 - 
Epoch 7/64,  Loss: 0.17956941667944193, Total time: 0h 1m 7s
2024-10-19 21:46:20,045 - -----------------validate-----------------
2024-10-19 21:47:28,712 - Epoch 7, total_user:6040.0 nDCG@5: 0.4178746374890812, HR5: 0.7897350993377483, nDCG@10: 0.45496737277449095, HR10: 0.9094370860927152, nDCG@20: 0.467199807774828, HR20: 0.9579470198675497
2024-10-19 21:47:28,712 - Validation score increased.  Saving model ...
2024-10-19 21:47:44,537 - Epoch: 8/64 Batch: 1/48 Time: 15.8s Loss: 0.17   Average_Loss: 0.17
2024-10-19 21:48:21,348 - Epoch: 8/64 Batch: 33/48 Time: 52.6s Loss: 0.19   Average_Loss: 0.17
2024-10-19 21:48:36,180 - 
Epoch 8/64,  Loss: 0.1665618180607756, Total time: 0h 1m 7s
2024-10-19 21:48:36,180 - -----------------validate-----------------
2024-10-19 21:49:41,543 - Epoch 8, total_user:6040.0 nDCG@5: 0.42393187236543706, HR5: 0.7995033112582781, nDCG@10: 0.4647312926287733, HR10: 0.9302980132450331, nDCG@20: 0.47320398995551916, HR20: 0.9637417218543046
2024-10-19 21:49:41,543 - Validation score increased.  Saving model ...
2024-10-19 21:50:00,135 - Epoch: 9/64 Batch: 1/48 Time: 18.6s Loss: 0.13   Average_Loss: 0.13
2024-10-19 21:50:35,369 - Epoch: 9/64 Batch: 33/48 Time: 53.8s Loss: 0.13   Average_Loss: 0.15
2024-10-19 21:50:47,849 - 
Epoch 9/64,  Loss: 0.15625065844506025, Total time: 0h 1m 6s
2024-10-19 21:50:47,849 - -----------------validate-----------------
2024-10-19 21:51:54,252 - Epoch 9, total_user:6040.0 nDCG@5: 0.46653641292518894, HR5: 0.8655629139072848, nDCG@10: 0.4925230251517221, HR10: 0.9483443708609272, nDCG@20: 0.4979563922379722, HR20: 0.9698675496688741
2024-10-19 21:51:54,252 - Validation score increased.  Saving model ...
2024-10-19 21:52:08,150 - Epoch: 10/64 Batch: 1/48 Time: 13.9s Loss: 0.18   Average_Loss: 0.18
2024-10-19 21:52:47,951 - Epoch: 10/64 Batch: 33/48 Time: 53.7s Loss: 0.13   Average_Loss: 0.14
2024-10-19 21:52:59,028 - 
Epoch 10/64,  Loss: 0.146502949607869, Total time: 0h 1m 4s
2024-10-19 21:52:59,028 - -----------------validate-----------------
2024-10-19 21:54:05,152 - Epoch 10, total_user:6040.0 nDCG@5: 0.4758146007366502, HR5: 0.8774834437086093, nDCG@10: 0.49847060551051997, HR10: 0.95, nDCG@20: 0.5031196852070094, HR20: 0.9683774834437087
2024-10-19 21:54:05,153 - Validation score increased.  Saving model ...
2024-10-19 21:54:20,436 - Epoch: 11/64 Batch: 1/48 Time: 15.3s Loss: 0.14   Average_Loss: 0.14
2024-10-19 21:54:54,971 - Epoch: 11/64 Batch: 33/48 Time: 49.8s Loss: 0.13   Average_Loss: 0.14
2024-10-19 21:55:10,216 - 
Epoch 11/64,  Loss: 0.13838371184344092, Total time: 0h 1m 5s
2024-10-19 21:55:10,216 - -----------------validate-----------------
2024-10-19 21:56:15,778 - Epoch 11, total_user:6040.0 nDCG@5: 0.48502292286508225, HR5: 0.8913907284768212, nDCG@10: 0.5059456651352954, HR10: 0.9582781456953643, nDCG@20: 0.5104703494113363, HR20: 0.9763245033112583
2024-10-19 21:56:15,779 - Validation score increased.  Saving model ...
2024-10-19 21:56:32,671 - Epoch: 12/64 Batch: 1/48 Time: 16.9s Loss: 0.12   Average_Loss: 0.12
2024-10-19 21:57:03,194 - Epoch: 12/64 Batch: 33/48 Time: 47.4s Loss: 0.14   Average_Loss: 0.13
2024-10-19 21:57:16,228 - 
Epoch 12/64,  Loss: 0.13329151350383958, Total time: 0h 1m 0s
2024-10-19 21:57:16,228 - -----------------validate-----------------
2024-10-19 21:58:14,921 - Epoch 12, total_user:6040.0 nDCG@5: 0.47840252545196116, HR5: 0.8730132450331126, nDCG@10: 0.5022047628069869, HR10: 0.9491721854304636, nDCG@20: 0.5083323767496685, HR20: 0.9735099337748344
2024-10-19 21:58:14,922 - EarlyStopping counter: 1 out of 10
2024-10-19 21:58:29,716 - Epoch: 13/64 Batch: 1/48 Time: 14.8s Loss: 0.12   Average_Loss: 0.12
2024-10-19 21:59:00,262 - Epoch: 13/64 Batch: 33/48 Time: 45.3s Loss: 0.14   Average_Loss: 0.13
2024-10-19 21:59:18,572 - 
Epoch 13/64,  Loss: 0.1320629371330142, Total time: 0h 1m 3s
2024-10-19 21:59:18,573 - -----------------validate-----------------
2024-10-19 22:00:18,554 - Epoch 13, total_user:6040.0 nDCG@5: 0.4772490323131484, HR5: 0.8743377483443708, nDCG@10: 0.499857967850532, HR10: 0.9463576158940398, nDCG@20: 0.5051789440890919, HR20: 0.9675496688741722
2024-10-19 22:00:18,555 - EarlyStopping counter: 2 out of 10
2024-10-19 22:00:35,536 - Epoch: 14/64 Batch: 1/48 Time: 17.0s Loss: 0.14   Average_Loss: 0.14
2024-10-19 22:01:05,865 - Epoch: 14/64 Batch: 33/48 Time: 47.3s Loss: 0.12   Average_Loss: 0.13
2024-10-19 22:01:21,673 - 
Epoch 14/64,  Loss: 0.13002248744790754, Total time: 0h 1m 3s
2024-10-19 22:01:21,673 - -----------------validate-----------------
2024-10-19 22:02:20,961 - Epoch 14, total_user:6040.0 nDCG@5: 0.49250324327408845, HR5: 0.8961920529801325, nDCG@10: 0.5106075496946176, HR10: 0.9543046357615894, nDCG@20: 0.515150356975917, HR20: 0.9723509933774834
2024-10-19 22:02:20,961 - Validation score increased.  Saving model ...
2024-10-19 22:02:35,588 - Epoch: 15/64 Batch: 1/48 Time: 14.6s Loss: 0.12   Average_Loss: 0.12
2024-10-19 22:03:08,645 - Epoch: 15/64 Batch: 33/48 Time: 47.7s Loss: 0.12   Average_Loss: 0.13
2024-10-19 22:03:23,793 - 
Epoch 15/64,  Loss: 0.12747079894567528, Total time: 0h 1m 2s
2024-10-19 22:03:23,793 - -----------------validate-----------------
2024-10-19 22:04:22,840 - Epoch 15, total_user:6040.0 nDCG@5: 0.4880983190391346, HR5: 0.8925496688741722, nDCG@10: 0.5065035631383084, HR10: 0.9509933774834437, nDCG@20: 0.5109446928646444, HR20: 0.9687086092715231
2024-10-19 22:04:22,841 - EarlyStopping counter: 1 out of 10
2024-10-19 22:04:38,108 - Epoch: 16/64 Batch: 1/48 Time: 15.3s Loss: 0.13   Average_Loss: 0.13
2024-10-19 22:05:08,712 - Epoch: 16/64 Batch: 33/48 Time: 45.9s Loss: 0.12   Average_Loss: 0.13
2024-10-19 22:05:24,746 - 
Epoch 16/64,  Loss: 0.12542423962925872, Total time: 0h 1m 1s
2024-10-19 22:05:24,747 - -----------------validate-----------------
2024-10-19 22:06:25,777 - Epoch 16, total_user:6040.0 nDCG@5: 0.49417780798506294, HR5: 0.8948675496688742, nDCG@10: 0.5138739547651493, HR10: 0.9577814569536424, nDCG@20: 0.5178987253405654, HR20: 0.973841059602649
2024-10-19 22:06:25,778 - Validation score increased.  Saving model ...
2024-10-19 22:06:41,904 - Epoch: 17/64 Batch: 1/48 Time: 16.1s Loss: 0.12   Average_Loss: 0.12
2024-10-19 22:07:12,554 - Epoch: 17/64 Batch: 33/48 Time: 46.8s Loss: 0.14   Average_Loss: 0.12
2024-10-19 22:07:26,085 - 
Epoch 17/64,  Loss: 0.12489160522818565, Total time: 0h 1m 0s
2024-10-19 22:07:26,086 - -----------------validate-----------------
2024-10-19 22:08:25,857 - Epoch 17, total_user:6040.0 nDCG@5: 0.49806310755502176, HR5: 0.898841059602649, nDCG@10: 0.5156282333373899, HR10: 0.9548013245033112, nDCG@20: 0.520860105229952, HR20: 0.9754966887417219
2024-10-19 22:08:25,858 - Validation score increased.  Saving model ...
2024-10-19 22:08:38,975 - Epoch: 18/64 Batch: 1/48 Time: 13.1s Loss: 0.14   Average_Loss: 0.14
2024-10-19 22:09:15,154 - Epoch: 18/64 Batch: 33/48 Time: 49.3s Loss: 0.13   Average_Loss: 0.12
2024-10-19 22:09:28,632 - 
Epoch 18/64,  Loss: 0.1225060778670013, Total time: 0h 1m 2s
2024-10-19 22:09:28,632 - -----------------validate-----------------
2024-10-19 22:10:29,136 - Epoch 18, total_user:6040.0 nDCG@5: 0.5059622339987334, HR5: 0.9089403973509934, nDCG@10: 0.5217330330419323, HR10: 0.9592715231788079, nDCG@20: 0.5258166143319909, HR20: 0.9754966887417219
2024-10-19 22:10:29,137 - Validation score increased.  Saving model ...
2024-10-19 22:10:45,303 - Epoch: 19/64 Batch: 1/48 Time: 16.2s Loss: 0.10   Average_Loss: 0.10
2024-10-19 22:11:19,559 - Epoch: 19/64 Batch: 33/48 Time: 50.4s Loss: 0.12   Average_Loss: 0.12
2024-10-19 22:11:32,859 - 
Epoch 19/64,  Loss: 0.12271579292913277, Total time: 0h 1m 3s
2024-10-19 22:11:32,860 - -----------------validate-----------------
2024-10-19 22:12:34,097 - Epoch 19, total_user:6040.0 nDCG@5: 0.5046850265363477, HR5: 0.9024834437086092, nDCG@10: 0.5218079122019299, HR10: 0.9571192052980132, nDCG@20: 0.5262954195463205, HR20: 0.9748344370860927
2024-10-19 22:12:34,098 - EarlyStopping counter: 1 out of 10
2024-10-19 22:12:52,731 - Epoch: 20/64 Batch: 1/48 Time: 18.6s Loss: 0.11   Average_Loss: 0.11
2024-10-19 22:13:23,996 - Epoch: 20/64 Batch: 33/48 Time: 49.9s Loss: 0.15   Average_Loss: 0.12
2024-10-19 22:13:37,781 - 
Epoch 20/64,  Loss: 0.11996020485336582, Total time: 0h 1m 3s
2024-10-19 22:13:37,781 - -----------------validate-----------------
2024-10-19 22:14:38,135 - Epoch 20, total_user:6040.0 nDCG@5: 0.4918583432991189, HR5: 0.8927152317880794, nDCG@10: 0.5100137476796055, HR10: 0.9504966887417219, nDCG@20: 0.5148758168701235, HR20: 0.9698675496688741
2024-10-19 22:14:38,136 - EarlyStopping counter: 2 out of 10
2024-10-19 22:14:52,048 - Epoch: 21/64 Batch: 1/48 Time: 13.9s Loss: 0.16   Average_Loss: 0.16
2024-10-19 22:15:26,285 - Epoch: 21/64 Batch: 33/48 Time: 48.1s Loss: 0.11   Average_Loss: 0.12
2024-10-19 22:15:39,864 - 
Epoch 21/64,  Loss: 0.11652883235365152, Total time: 0h 1m 1s
2024-10-19 22:15:39,865 - -----------------validate-----------------
2024-10-19 22:16:39,894 - Epoch 21, total_user:6040.0 nDCG@5: 0.49983559572995895, HR5: 0.9, nDCG@10: 0.516943691404691, HR10: 0.9544701986754967, nDCG@20: 0.521493692080465, HR20: 0.972682119205298
2024-10-19 22:16:39,895 - EarlyStopping counter: 3 out of 10
2024-10-19 22:16:54,117 - Epoch: 22/64 Batch: 1/48 Time: 14.2s Loss: 0.11   Average_Loss: 0.11
2024-10-19 22:17:29,451 - Epoch: 22/64 Batch: 33/48 Time: 49.6s Loss: 0.11   Average_Loss: 0.12
2024-10-19 22:17:42,220 - 
Epoch 22/64,  Loss: 0.11600760106618206, Total time: 0h 1m 2s
2024-10-19 22:17:42,221 - -----------------validate-----------------
2024-10-19 22:18:42,140 - Epoch 22, total_user:6040.0 nDCG@5: 0.5010350333535506, HR5: 0.902317880794702, nDCG@10: 0.5182161917553727, HR10: 0.956953642384106, nDCG@20: 0.523036946029211, HR20: 0.9763245033112583
2024-10-19 22:18:42,140 - EarlyStopping counter: 4 out of 10
2024-10-19 22:18:56,593 - Epoch: 23/64 Batch: 1/48 Time: 14.5s Loss: 0.14   Average_Loss: 0.14
2024-10-19 22:19:32,477 - Epoch: 23/64 Batch: 33/48 Time: 50.3s Loss: 0.12   Average_Loss: 0.11
2024-10-19 22:19:44,589 - 
Epoch 23/64,  Loss: 0.1158109304184715, Total time: 0h 1m 2s
2024-10-19 22:19:44,590 - -----------------validate-----------------
2024-10-19 22:20:45,560 - Epoch 23, total_user:6040.0 nDCG@5: 0.5085567459582658, HR5: 0.9052980132450331, nDCG@10: 0.5244729958718016, HR10: 0.9561258278145696, nDCG@20: 0.5289650976867296, HR20: 0.9740066225165563
2024-10-19 22:20:45,561 - Validation score increased.  Saving model ...
2024-10-19 22:21:01,597 - Epoch: 24/64 Batch: 1/48 Time: 16.0s Loss: 0.12   Average_Loss: 0.12
2024-10-19 22:21:34,576 - Epoch: 24/64 Batch: 33/48 Time: 49.0s Loss: 0.11   Average_Loss: 0.12
2024-10-19 22:21:49,170 - 
Epoch 24/64,  Loss: 0.1145156725930671, Total time: 0h 1m 3s
2024-10-19 22:21:49,171 - -----------------validate-----------------
2024-10-19 22:22:50,842 - Epoch 24, total_user:6040.0 nDCG@5: 0.5057558535224564, HR5: 0.9057947019867549, nDCG@10: 0.5220342690604544, HR10: 0.9577814569536424, nDCG@20: 0.5264694896437325, HR20: 0.9754966887417219
2024-10-19 22:22:50,843 - Validation score increased.  Saving model ...
2024-10-19 22:23:05,234 - Epoch: 25/64 Batch: 1/48 Time: 14.4s Loss: 0.11   Average_Loss: 0.11
2024-10-19 22:23:40,264 - Epoch: 25/64 Batch: 33/48 Time: 49.4s Loss: 0.09   Average_Loss: 0.11
2024-10-19 22:23:53,623 - 
Epoch 25/64,  Loss: 0.11340975761413574, Total time: 0h 1m 2s
2024-10-19 22:23:53,623 - -----------------validate-----------------
2024-10-19 22:24:55,866 - Epoch 25, total_user:6040.0 nDCG@5: 0.5096310928361124, HR5: 0.9051324503311259, nDCG@10: 0.5255334305910346, HR10: 0.9559602649006622, nDCG@20: 0.5298334863138903, HR20: 0.9730132450331126
2024-10-19 22:24:55,867 - Validation score increased.  Saving model ...
2024-10-19 22:25:10,132 - Epoch: 26/64 Batch: 1/48 Time: 14.3s Loss: 0.12   Average_Loss: 0.12
2024-10-19 22:25:46,201 - Epoch: 26/64 Batch: 33/48 Time: 50.3s Loss: 0.12   Average_Loss: 0.11
2024-10-19 22:25:58,334 - 
Epoch 26/64,  Loss: 0.11332429945468903, Total time: 0h 1m 2s
2024-10-19 22:25:58,334 - -----------------validate-----------------
2024-10-19 22:26:59,437 - Epoch 26, total_user:6040.0 nDCG@5: 0.5108073446174565, HR5: 0.9119205298013245, nDCG@10: 0.5260214612615624, HR10: 0.9605960264900663, nDCG@20: 0.5303527072286367, HR20: 0.9776490066225165
2024-10-19 22:26:59,438 - Validation score increased.  Saving model ...
2024-10-19 22:27:13,633 - Epoch: 27/64 Batch: 1/48 Time: 14.2s Loss: 0.10   Average_Loss: 0.10
2024-10-19 22:27:48,869 - Epoch: 27/64 Batch: 33/48 Time: 49.4s Loss: 0.12   Average_Loss: 0.11
2024-10-19 22:28:04,172 - 
Epoch 27/64,  Loss: 0.11261117660130064, Total time: 0h 1m 4s
2024-10-19 22:28:04,172 - -----------------validate-----------------
2024-10-19 22:29:05,407 - Epoch 27, total_user:6040.0 nDCG@5: 0.5099520091467432, HR5: 0.9089403973509934, nDCG@10: 0.5253992748776508, HR10: 0.9582781456953643, nDCG@20: 0.5296137751510981, HR20: 0.9751655629139073
2024-10-19 22:29:05,408 - EarlyStopping counter: 1 out of 10
2024-10-19 22:29:18,846 - Epoch: 28/64 Batch: 1/48 Time: 13.4s Loss: 0.11   Average_Loss: 0.11
2024-10-19 22:29:55,579 - Epoch: 28/64 Batch: 33/48 Time: 50.2s Loss: 0.10   Average_Loss: 0.11
2024-10-19 22:30:09,471 - 
Epoch 28/64,  Loss: 0.1119190954292814, Total time: 0h 1m 4s
2024-10-19 22:30:09,472 - -----------------validate-----------------
2024-10-19 22:31:10,563 - Epoch 28, total_user:6040.0 nDCG@5: 0.510347472916915, HR5: 0.9074503311258278, nDCG@10: 0.5259861747062926, HR10: 0.9572847682119205, nDCG@20: 0.5300492945246238, HR20: 0.9731788079470198
2024-10-19 22:31:10,564 - EarlyStopping counter: 2 out of 10
2024-10-19 22:31:25,609 - Epoch: 29/64 Batch: 1/48 Time: 15.0s Loss: 0.11   Average_Loss: 0.11
2024-10-19 22:31:58,930 - Epoch: 29/64 Batch: 33/48 Time: 48.4s Loss: 0.14   Average_Loss: 0.11
2024-10-19 22:32:14,142 - 
Epoch 29/64,  Loss: 0.11083759274333715, Total time: 0h 1m 3s
2024-10-19 22:32:14,142 - -----------------validate-----------------
2024-10-19 22:33:14,758 - Epoch 29, total_user:6040.0 nDCG@5: 0.509949790372314, HR5: 0.9087748344370861, nDCG@10: 0.5254389789550761, HR10: 0.958112582781457, nDCG@20: 0.5302145556759535, HR20: 0.9769867549668875
2024-10-19 22:33:14,759 - EarlyStopping counter: 3 out of 10
2024-10-19 22:33:31,745 - Epoch: 30/64 Batch: 1/48 Time: 17.0s Loss: 0.10   Average_Loss: 0.10
2024-10-19 22:34:03,901 - Epoch: 30/64 Batch: 33/48 Time: 49.1s Loss: 0.12   Average_Loss: 0.11
2024-10-19 22:34:19,476 - 
Epoch 30/64,  Loss: 0.11107323753337066, Total time: 0h 1m 4s
2024-10-19 22:34:19,476 - -----------------validate-----------------
2024-10-19 22:35:19,324 - Epoch 30, total_user:6040.0 nDCG@5: 0.5108678414944265, HR5: 0.9127483443708609, nDCG@10: 0.5262156586731223, HR10: 0.9620860927152318, nDCG@20: 0.5300302221447134, HR20: 0.9771523178807947
2024-10-19 22:35:19,325 - Validation score increased.  Saving model ...
2024-10-19 22:35:34,777 - Epoch: 31/64 Batch: 1/48 Time: 15.4s Loss: 0.11   Average_Loss: 0.11
2024-10-19 22:36:08,121 - Epoch: 31/64 Batch: 33/48 Time: 48.8s Loss: 0.11   Average_Loss: 0.11
2024-10-19 22:36:26,235 - 
Epoch 31/64,  Loss: 0.10975927766412497, Total time: 0h 1m 6s
2024-10-19 22:36:26,235 - -----------------validate-----------------
2024-10-19 22:37:26,692 - Epoch 31, total_user:6040.0 nDCG@5: 0.5109259120978006, HR5: 0.9122516556291391, nDCG@10: 0.5251494254770476, HR10: 0.9579470198675497, nDCG@20: 0.5297486652914762, HR20: 0.976158940397351
2024-10-19 22:37:26,692 - EarlyStopping counter: 1 out of 10
2024-10-19 22:37:42,571 - Epoch: 32/64 Batch: 1/48 Time: 15.9s Loss: 0.10   Average_Loss: 0.10
2024-10-19 22:38:17,173 - Epoch: 32/64 Batch: 33/48 Time: 50.5s Loss: 0.10   Average_Loss: 0.11
2024-10-19 22:38:29,978 - 
Epoch 32/64,  Loss: 0.10944203473627567, Total time: 0h 1m 3s
2024-10-19 22:38:29,978 - -----------------validate-----------------
2024-10-19 22:39:30,645 - Epoch 32, total_user:6040.0 nDCG@5: 0.5164940281789187, HR5: 0.9167218543046357, nDCG@10: 0.5304040710650938, HR10: 0.9614238410596027, nDCG@20: 0.5341517291399189, HR20: 0.9763245033112583
2024-10-19 22:39:30,646 - Validation score increased.  Saving model ...
2024-10-19 22:39:48,215 - Epoch: 33/64 Batch: 1/48 Time: 17.6s Loss: 0.12   Average_Loss: 0.12
2024-10-19 22:40:20,797 - Epoch: 33/64 Batch: 33/48 Time: 50.1s Loss: 0.13   Average_Loss: 0.11
2024-10-19 22:40:35,522 - 
Epoch 33/64,  Loss: 0.10915582114830613, Total time: 0h 1m 4s
2024-10-19 22:40:35,522 - -----------------validate-----------------
2024-10-19 22:41:35,373 - Epoch 33, total_user:6040.0 nDCG@5: 0.5179344258402897, HR5: 0.9172185430463576, nDCG@10: 0.5316603298037395, HR10: 0.9610927152317881, nDCG@20: 0.5358520400745218, HR20: 0.9776490066225165
2024-10-19 22:41:35,374 - Validation score increased.  Saving model ...
2024-10-19 22:41:52,818 - Epoch: 34/64 Batch: 1/48 Time: 17.4s Loss: 0.09   Average_Loss: 0.09
2024-10-19 22:42:24,582 - Epoch: 34/64 Batch: 33/48 Time: 49.2s Loss: 0.10   Average_Loss: 0.11
2024-10-19 22:42:39,104 - 
Epoch 34/64,  Loss: 0.10885859342912833, Total time: 0h 1m 3s
2024-10-19 22:42:39,105 - -----------------validate-----------------
2024-10-19 22:43:39,290 - Epoch 34, total_user:6040.0 nDCG@5: 0.5185483945784845, HR5: 0.9170529801324503, nDCG@10: 0.5328105498647306, HR10: 0.9624172185430464, nDCG@20: 0.5369932652961623, HR20: 0.9789735099337749
2024-10-19 22:43:39,291 - Validation score increased.  Saving model ...
2024-10-19 22:43:53,946 - Epoch: 35/64 Batch: 1/48 Time: 14.7s Loss: 0.11   Average_Loss: 0.11
2024-10-19 22:44:28,436 - Epoch: 35/64 Batch: 33/48 Time: 49.1s Loss: 0.11   Average_Loss: 0.11
2024-10-19 22:44:42,858 - 
Epoch 35/64,  Loss: 0.10787183077385028, Total time: 0h 1m 3s
2024-10-19 22:44:42,859 - -----------------validate-----------------
2024-10-19 22:45:45,327 - Epoch 35, total_user:6040.0 nDCG@5: 0.515790438763217, HR5: 0.9182119205298013, nDCG@10: 0.529399238836746, HR10: 0.9614238410596027, nDCG@20: 0.5329630957528233, HR20: 0.9756622516556291
2024-10-19 22:45:45,327 - Validation score increased.  Saving model ...
2024-10-19 22:46:03,405 - Epoch: 36/64 Batch: 1/48 Time: 18.1s Loss: 0.11   Average_Loss: 0.11
2024-10-19 22:46:35,276 - Epoch: 36/64 Batch: 33/48 Time: 49.9s Loss: 0.12   Average_Loss: 0.11
2024-10-19 22:46:49,490 - 
Epoch 36/64,  Loss: 0.10766925957674782, Total time: 0h 1m 4s
2024-10-19 22:46:49,491 - -----------------validate-----------------
2024-10-19 22:47:50,839 - Epoch 36, total_user:6040.0 nDCG@5: 0.5149776963144685, HR5: 0.9155629139072847, nDCG@10: 0.5292084910199645, HR10: 0.9612582781456953, nDCG@20: 0.5331103157371365, HR20: 0.9768211920529801
2024-10-19 22:47:50,840 - Validation score increased.  Saving model ...
2024-10-19 22:48:08,285 - Epoch: 37/64 Batch: 1/48 Time: 17.4s Loss: 0.12   Average_Loss: 0.12
2024-10-19 22:48:40,377 - Epoch: 37/64 Batch: 33/48 Time: 49.5s Loss: 0.09   Average_Loss: 0.11
2024-10-19 22:48:53,898 - 
Epoch 37/64,  Loss: 0.10836090597634514, Total time: 0h 1m 3s
2024-10-19 22:48:53,898 - -----------------validate-----------------
2024-10-19 22:49:56,180 - Epoch 37, total_user:6040.0 nDCG@5: 0.516515527594256, HR5: 0.9162251655629139, nDCG@10: 0.5302710396501092, HR10: 0.9600993377483443, nDCG@20: 0.534177521415791, HR20: 0.9754966887417219
2024-10-19 22:49:56,181 - Validation score increased.  Saving model ...
2024-10-19 22:50:12,375 - Epoch: 38/64 Batch: 1/48 Time: 16.2s Loss: 0.09   Average_Loss: 0.09
2024-10-19 22:50:44,750 - Epoch: 38/64 Batch: 33/48 Time: 48.6s Loss: 0.10   Average_Loss: 0.11
2024-10-19 22:50:57,704 - 
Epoch 38/64,  Loss: 0.10771887795999646, Total time: 0h 1m 1s
2024-10-19 22:50:57,704 - -----------------validate-----------------
2024-10-19 22:51:58,150 - Epoch 38, total_user:6040.0 nDCG@5: 0.5192000495438044, HR5: 0.9190397350993378, nDCG@10: 0.5333862914352622, HR10: 0.9642384105960264, nDCG@20: 0.5371632022861722, HR20: 0.9791390728476821
2024-10-19 22:51:58,151 - Validation score increased.  Saving model ...
2024-10-19 22:52:12,633 - Epoch: 39/64 Batch: 1/48 Time: 14.5s Loss: 0.11   Average_Loss: 0.11
2024-10-19 22:52:47,068 - Epoch: 39/64 Batch: 33/48 Time: 48.9s Loss: 0.09   Average_Loss: 0.11
2024-10-19 22:52:59,951 - 
Epoch 39/64,  Loss: 0.10650974589710434, Total time: 0h 1m 1s
2024-10-19 22:52:59,951 - -----------------validate-----------------
2024-10-19 22:54:00,573 - Epoch 39, total_user:6040.0 nDCG@5: 0.5172453768835154, HR5: 0.9183774834437086, nDCG@10: 0.5310023436002687, HR10: 0.9624172185430464, nDCG@20: 0.5346441965262323, HR20: 0.9768211920529801
2024-10-19 22:54:00,574 - EarlyStopping counter: 1 out of 10
2024-10-19 22:54:15,021 - Epoch: 40/64 Batch: 1/48 Time: 14.4s Loss: 0.12   Average_Loss: 0.12
2024-10-19 22:54:48,330 - Epoch: 40/64 Batch: 33/48 Time: 47.8s Loss: 0.11   Average_Loss: 0.11
2024-10-19 22:55:02,493 - 
Epoch 40/64,  Loss: 0.10863412218168378, Total time: 0h 1m 1s
2024-10-19 22:55:02,493 - -----------------validate-----------------
2024-10-19 22:56:03,055 - Epoch 40, total_user:6040.0 nDCG@5: 0.5152981250477771, HR5: 0.9177152317880795, nDCG@10: 0.5288786439364196, HR10: 0.9605960264900663, nDCG@20: 0.5330179708600522, HR20: 0.9768211920529801
2024-10-19 22:56:03,055 - EarlyStopping counter: 2 out of 10
2024-10-19 22:56:19,806 - Epoch: 41/64 Batch: 1/48 Time: 16.8s Loss: 0.09   Average_Loss: 0.09
2024-10-19 22:56:49,703 - Epoch: 41/64 Batch: 33/48 Time: 46.6s Loss: 0.11   Average_Loss: 0.11
2024-10-19 22:57:04,870 - 
Epoch 41/64,  Loss: 0.10809837374836206, Total time: 0h 1m 1s
2024-10-19 22:57:04,870 - -----------------validate-----------------
2024-10-19 22:58:05,313 - Epoch 41, total_user:6040.0 nDCG@5: 0.5182274093407996, HR5: 0.9173841059602649, nDCG@10: 0.532458969238355, HR10: 0.9625827814569536, nDCG@20: 0.5356807361414857, HR20: 0.9753311258278146
2024-10-19 22:58:05,313 - EarlyStopping counter: 3 out of 10
2024-10-19 22:58:20,808 - Epoch: 42/64 Batch: 1/48 Time: 15.5s Loss: 0.10   Average_Loss: 0.10
2024-10-19 22:58:53,366 - Epoch: 42/64 Batch: 33/48 Time: 48.1s Loss: 0.12   Average_Loss: 0.11
2024-10-19 22:59:07,096 - 
Epoch 42/64,  Loss: 0.1064498460230728, Total time: 0h 1m 1s
2024-10-19 22:59:07,097 - -----------------validate-----------------
2024-10-19 23:00:07,372 - Epoch 42, total_user:6040.0 nDCG@5: 0.5170090808443709, HR5: 0.9177152317880795, nDCG@10: 0.5306372393504576, HR10: 0.9614238410596027, nDCG@20: 0.5341986178266751, HR20: 0.9756622516556291
2024-10-19 23:00:07,372 - EarlyStopping counter: 4 out of 10
2024-10-19 23:00:22,084 - Epoch: 43/64 Batch: 1/48 Time: 14.7s Loss: 0.11   Average_Loss: 0.11
2024-10-19 23:00:55,509 - Epoch: 43/64 Batch: 33/48 Time: 48.1s Loss: 0.10   Average_Loss: 0.11
2024-10-19 23:01:09,500 - 
Epoch 43/64,  Loss: 0.1064179598664244, Total time: 0h 1m 2s
2024-10-19 23:01:09,501 - -----------------validate-----------------
2024-10-19 23:02:10,565 - Epoch 43, total_user:6040.0 nDCG@5: 0.5167421971181463, HR5: 0.9153973509933775, nDCG@10: 0.5312330383113267, HR10: 0.9617549668874172, nDCG@20: 0.5346718299988354, HR20: 0.9754966887417219
2024-10-19 23:02:10,566 - EarlyStopping counter: 5 out of 10
2024-10-19 23:02:25,507 - Epoch: 44/64 Batch: 1/48 Time: 14.9s Loss: 0.10   Average_Loss: 0.10
2024-10-19 23:02:59,175 - Epoch: 44/64 Batch: 33/48 Time: 48.6s Loss: 0.08   Average_Loss: 0.11
2024-10-19 23:03:13,250 - 
Epoch 44/64,  Loss: 0.107075119856745, Total time: 0h 1m 2s
2024-10-19 23:03:13,250 - -----------------validate-----------------
2024-10-19 23:04:14,336 - Epoch 44, total_user:6040.0 nDCG@5: 0.5156553376918221, HR5: 0.9144039735099337, nDCG@10: 0.5299785685399819, HR10: 0.9602649006622517, nDCG@20: 0.5336500144849532, HR20: 0.9748344370860927
2024-10-19 23:04:14,337 - EarlyStopping counter: 6 out of 10
2024-10-19 23:04:27,205 - Epoch: 45/64 Batch: 1/48 Time: 12.9s Loss: 0.12   Average_Loss: 0.12
2024-10-19 23:05:03,624 - Epoch: 45/64 Batch: 33/48 Time: 49.3s Loss: 0.09   Average_Loss: 0.11
2024-10-19 23:05:20,052 - 
Epoch 45/64,  Loss: 0.1065530941511194, Total time: 0h 1m 5s
2024-10-19 23:05:20,052 - -----------------validate-----------------
2024-10-19 23:06:20,854 - Epoch 45, total_user:6040.0 nDCG@5: 0.516238875465792, HR5: 0.9142384105960265, nDCG@10: 0.531057621973847, HR10: 0.9614238410596027, nDCG@20: 0.53461820348614, HR20: 0.9754966887417219
2024-10-19 23:06:20,854 - EarlyStopping counter: 7 out of 10
2024-10-19 23:06:37,410 - Epoch: 46/64 Batch: 1/48 Time: 16.6s Loss: 0.11   Average_Loss: 0.11
2024-10-19 23:07:09,281 - Epoch: 46/64 Batch: 33/48 Time: 48.4s Loss: 0.11   Average_Loss: 0.10
2024-10-19 23:07:21,412 - 
Epoch 46/64,  Loss: 0.10643320266778271, Total time: 0h 1m 0s
2024-10-19 23:07:21,412 - -----------------validate-----------------
2024-10-19 23:08:22,121 - Epoch 46, total_user:6040.0 nDCG@5: 0.5197056742980062, HR5: 0.9195364238410596, nDCG@10: 0.5332488988753579, HR10: 0.9629139072847682, nDCG@20: 0.5364458108872414, HR20: 0.9754966887417219
2024-10-19 23:08:22,122 - EarlyStopping counter: 8 out of 10
2024-10-19 23:08:38,342 - Epoch: 47/64 Batch: 1/48 Time: 16.2s Loss: 0.13   Average_Loss: 0.13
2024-10-19 23:09:12,331 - Epoch: 47/64 Batch: 33/48 Time: 50.2s Loss: 0.10   Average_Loss: 0.11
2024-10-19 23:09:27,606 - 
Epoch 47/64,  Loss: 0.1056347267391781, Total time: 0h 1m 5s
2024-10-19 23:09:27,606 - -----------------validate-----------------
2024-10-19 23:10:31,689 - Epoch 47, total_user:6040.0 nDCG@5: 0.5206327822079767, HR5: 0.9231788079470199, nDCG@10: 0.5335377476458333, HR10: 0.9647350993377484, nDCG@20: 0.5371666506160115, HR20: 0.9791390728476821
2024-10-19 23:10:31,690 - Validation score increased.  Saving model ...
2024-10-19 23:10:47,877 - Epoch: 48/64 Batch: 1/48 Time: 16.2s Loss: 0.10   Average_Loss: 0.10
2024-10-19 23:11:21,672 - Epoch: 48/64 Batch: 33/48 Time: 50.0s Loss: 0.08   Average_Loss: 0.11
2024-10-19 23:11:35,176 - 
Epoch 48/64,  Loss: 0.1058002463541925, Total time: 0h 1m 3s
2024-10-19 23:11:35,177 - -----------------validate-----------------
2024-10-19 23:12:38,374 - Epoch 48, total_user:6040.0 nDCG@5: 0.5186886953508446, HR5: 0.919205298013245, nDCG@10: 0.533010570247386, HR10: 0.9649006622516556, nDCG@20: 0.5365631434941623, HR20: 0.9791390728476821
2024-10-19 23:12:38,375 - EarlyStopping counter: 1 out of 10
2024-10-19 23:12:53,781 - Epoch: 49/64 Batch: 1/48 Time: 15.4s Loss: 0.13   Average_Loss: 0.13
2024-10-19 23:13:27,674 - Epoch: 49/64 Batch: 33/48 Time: 49.3s Loss: 0.10   Average_Loss: 0.11
2024-10-19 23:13:42,413 - 
Epoch 49/64,  Loss: 0.1057226238772273, Total time: 0h 1m 4s
2024-10-19 23:13:42,414 - -----------------validate-----------------
2024-10-19 23:14:46,258 - Epoch 49, total_user:6040.0 nDCG@5: 0.5186820695925078, HR5: 0.9178807947019868, nDCG@10: 0.5327404708382631, HR10: 0.9630794701986755, nDCG@20: 0.5364854293072646, HR20: 0.9779801324503311
2024-10-19 23:14:46,259 - EarlyStopping counter: 2 out of 10
2024-10-19 23:15:02,676 - Epoch: 50/64 Batch: 1/48 Time: 16.4s Loss: 0.09   Average_Loss: 0.09
2024-10-19 23:15:38,590 - Epoch: 50/64 Batch: 33/48 Time: 52.3s Loss: 0.10   Average_Loss: 0.11
2024-10-19 23:15:52,926 - 
Epoch 50/64,  Loss: 0.10551632397497694, Total time: 0h 1m 6s
2024-10-19 23:15:52,927 - -----------------validate-----------------
2024-10-19 23:16:55,608 - Epoch 50, total_user:6040.0 nDCG@5: 0.5188716271772893, HR5: 0.9163907284768212, nDCG@10: 0.5328965116926314, HR10: 0.9612582781456953, nDCG@20: 0.5367568168364046, HR20: 0.9766556291390729
2024-10-19 23:16:55,608 - EarlyStopping counter: 3 out of 10
2024-10-19 23:17:13,581 - Epoch: 51/64 Batch: 1/48 Time: 18.0s Loss: 0.10   Average_Loss: 0.10
2024-10-19 23:17:45,459 - Epoch: 51/64 Batch: 33/48 Time: 49.9s Loss: 0.09   Average_Loss: 0.11
2024-10-19 23:18:00,773 - 
Epoch 51/64,  Loss: 0.10642799735069275, Total time: 0h 1m 5s
2024-10-19 23:18:00,773 - -----------------validate-----------------
2024-10-19 23:19:04,068 - Epoch 51, total_user:6040.0 nDCG@5: 0.5172238693072462, HR5: 0.9140728476821192, nDCG@10: 0.5317923787332082, HR10: 0.9607615894039735, nDCG@20: 0.5357961690309935, HR20: 0.9766556291390729
2024-10-19 23:19:04,069 - EarlyStopping counter: 4 out of 10
2024-10-19 23:19:18,263 - Epoch: 52/64 Batch: 1/48 Time: 14.2s Loss: 0.11   Average_Loss: 0.11
2024-10-19 23:19:54,491 - Epoch: 52/64 Batch: 33/48 Time: 50.4s Loss: 0.10   Average_Loss: 0.11
2024-10-19 23:20:07,405 - 
Epoch 52/64,  Loss: 0.10640922359501322, Total time: 0h 1m 3s
2024-10-19 23:20:07,405 - -----------------validate-----------------
2024-10-19 23:21:08,862 - Epoch 52, total_user:6040.0 nDCG@5: 0.5198630274058715, HR5: 0.9178807947019868, nDCG@10: 0.5335312510920407, HR10: 0.9617549668874172, nDCG@20: 0.537552076279612, HR20: 0.9778145695364239
2024-10-19 23:21:08,863 - EarlyStopping counter: 5 out of 10
2024-10-19 23:21:22,164 - Epoch: 53/64 Batch: 1/48 Time: 13.3s Loss: 0.10   Average_Loss: 0.10
2024-10-19 23:21:57,280 - Epoch: 53/64 Batch: 33/48 Time: 48.4s Loss: 0.09   Average_Loss: 0.10
2024-10-19 23:22:11,902 - 
Epoch 53/64,  Loss: 0.10470293369144201, Total time: 0h 1m 3s
2024-10-19 23:22:11,902 - -----------------validate-----------------
2024-10-19 23:23:13,090 - Epoch 53, total_user:6040.0 nDCG@5: 0.5239815570471932, HR5: 0.921523178807947, nDCG@10: 0.5366947599136309, HR10: 0.9620860927152318, nDCG@20: 0.5411216692859568, HR20: 0.9794701986754967
2024-10-19 23:23:13,090 - Validation score increased.  Saving model ...
2024-10-19 23:23:29,754 - Epoch: 54/64 Batch: 1/48 Time: 16.7s Loss: 0.09   Average_Loss: 0.09
2024-10-19 23:24:02,077 - Epoch: 54/64 Batch: 33/48 Time: 49.0s Loss: 0.12   Average_Loss: 0.11
2024-10-19 23:24:14,757 - 
Epoch 54/64,  Loss: 0.10552244167774916, Total time: 0h 1m 1s
2024-10-19 23:24:14,758 - -----------------validate-----------------
2024-10-19 23:25:16,194 - Epoch 54, total_user:6040.0 nDCG@5: 0.5168314537811151, HR5: 0.9153973509933775, nDCG@10: 0.5301470715694157, HR10: 0.9576158940397351, nDCG@20: 0.5342367527970201, HR20: 0.9740066225165563
2024-10-19 23:25:16,195 - EarlyStopping counter: 1 out of 10
2024-10-19 23:25:28,817 - Epoch: 55/64 Batch: 1/48 Time: 12.6s Loss: 0.13   Average_Loss: 0.13
2024-10-19 23:26:04,756 - Epoch: 55/64 Batch: 33/48 Time: 48.6s Loss: 0.11   Average_Loss: 0.10
2024-10-19 23:26:19,396 - 
Epoch 55/64,  Loss: 0.10450582206249237, Total time: 0h 1m 3s
2024-10-19 23:26:19,396 - -----------------validate-----------------
2024-10-19 23:27:19,687 - Epoch 55, total_user:6040.0 nDCG@5: 0.5225039966262659, HR5: 0.9221854304635762, nDCG@10: 0.5361444450791173, HR10: 0.965728476821192, nDCG@20: 0.539551366847741, HR20: 0.9793046357615894
2024-10-19 23:27:19,688 - Validation score increased.  Saving model ...
2024-10-19 23:27:33,870 - Epoch: 56/64 Batch: 1/48 Time: 14.2s Loss: 0.13   Average_Loss: 0.13
2024-10-19 23:28:08,541 - Epoch: 56/64 Batch: 33/48 Time: 48.8s Loss: 0.12   Average_Loss: 0.10
2024-10-19 23:28:22,333 - 
Epoch 56/64,  Loss: 0.10600856163849433, Total time: 0h 1m 2s
2024-10-19 23:28:22,333 - -----------------validate-----------------
2024-10-19 23:29:23,638 - Epoch 56, total_user:6040.0 nDCG@5: 0.5200191545534482, HR5: 0.9183774834437086, nDCG@10: 0.533599082636489, HR10: 0.9619205298013245, nDCG@20: 0.5378793249210596, HR20: 0.9789735099337749
2024-10-19 23:29:23,639 - EarlyStopping counter: 1 out of 10
2024-10-19 23:29:38,413 - Epoch: 57/64 Batch: 1/48 Time: 14.8s Loss: 0.10   Average_Loss: 0.10
2024-10-19 23:30:13,064 - Epoch: 57/64 Batch: 33/48 Time: 49.4s Loss: 0.09   Average_Loss: 0.10
2024-10-19 23:30:27,020 - 
Epoch 57/64,  Loss: 0.10479147282118599, Total time: 0h 1m 3s
2024-10-19 23:30:27,020 - -----------------validate-----------------
2024-10-19 23:31:27,494 - Epoch 57, total_user:6040.0 nDCG@5: 0.5213526035635916, HR5: 0.9170529801324503, nDCG@10: 0.5344901571447292, HR10: 0.9589403973509933, nDCG@20: 0.5389655841588277, HR20: 0.9766556291390729
2024-10-19 23:31:27,495 - EarlyStopping counter: 2 out of 10
2024-10-19 23:31:41,439 - Epoch: 58/64 Batch: 1/48 Time: 13.9s Loss: 0.11   Average_Loss: 0.11
2024-10-19 23:32:16,101 - Epoch: 58/64 Batch: 33/48 Time: 48.6s Loss: 0.09   Average_Loss: 0.10
2024-10-19 23:32:30,543 - 
Epoch 58/64,  Loss: 0.10481790329019229, Total time: 0h 1m 3s
2024-10-19 23:32:30,544 - -----------------validate-----------------
2024-10-19 23:33:30,791 - Epoch 58, total_user:6040.0 nDCG@5: 0.5206044160862326, HR5: 0.9173841059602649, nDCG@10: 0.5347699873402464, HR10: 0.9627483443708609, nDCG@20: 0.5388596529316106, HR20: 0.9789735099337749
2024-10-19 23:33:30,792 - EarlyStopping counter: 3 out of 10
2024-10-19 23:33:44,512 - Epoch: 59/64 Batch: 1/48 Time: 13.7s Loss: 0.11   Average_Loss: 0.11
2024-10-19 23:34:17,849 - Epoch: 59/64 Batch: 33/48 Time: 47.1s Loss: 0.09   Average_Loss: 0.10
2024-10-19 23:34:31,660 - 
Epoch 59/64,  Loss: 0.10513139671335618, Total time: 0h 1m 0s
2024-10-19 23:34:31,661 - -----------------validate-----------------
2024-10-19 23:35:33,767 - Epoch 59, total_user:6040.0 nDCG@5: 0.5205874025213711, HR5: 0.918046357615894, nDCG@10: 0.5346483374676948, HR10: 0.9629139072847682, nDCG@20: 0.5382172288283862, HR20: 0.9771523178807947
2024-10-19 23:35:33,768 - EarlyStopping counter: 4 out of 10
2024-10-19 23:35:52,412 - Epoch: 60/64 Batch: 1/48 Time: 18.6s Loss: 0.10   Average_Loss: 0.10
2024-10-19 23:36:22,557 - Epoch: 60/64 Batch: 33/48 Time: 48.8s Loss: 0.09   Average_Loss: 0.10
2024-10-19 23:36:35,677 - 
Epoch 60/64,  Loss: 0.10512364966173966, Total time: 0h 1m 1s
2024-10-19 23:36:35,678 - -----------------validate-----------------
2024-10-19 23:37:36,036 - Epoch 60, total_user:6040.0 nDCG@5: 0.521711164019853, HR5: 0.920364238410596, nDCG@10: 0.5353785104946268, HR10: 0.9640728476821192, nDCG@20: 0.5393073902620442, HR20: 0.9798013245033113
2024-10-19 23:37:36,036 - EarlyStopping counter: 5 out of 10
2024-10-19 23:37:50,601 - Epoch: 61/64 Batch: 1/48 Time: 14.6s Loss: 0.10   Average_Loss: 0.10
2024-10-19 23:38:23,086 - Epoch: 61/64 Batch: 33/48 Time: 47.0s Loss: 0.11   Average_Loss: 0.11
2024-10-19 23:38:37,712 - 
Epoch 61/64,  Loss: 0.1065822212646405, Total time: 0h 1m 1s
2024-10-19 23:38:37,713 - -----------------validate-----------------
2024-10-19 23:39:38,944 - Epoch 61, total_user:6040.0 nDCG@5: 0.5206613608807709, HR5: 0.9178807947019868, nDCG@10: 0.5347457947209738, HR10: 0.9627483443708609, nDCG@20: 0.5381799386607393, HR20: 0.9763245033112583
2024-10-19 23:39:38,945 - EarlyStopping counter: 6 out of 10
2024-10-19 23:39:56,530 - Epoch: 62/64 Batch: 1/48 Time: 17.6s Loss: 0.10   Average_Loss: 0.10
2024-10-19 23:40:27,276 - Epoch: 62/64 Batch: 33/48 Time: 48.3s Loss: 0.10   Average_Loss: 0.11
2024-10-19 23:40:42,225 - 
Epoch 62/64,  Loss: 0.10515778573850791, Total time: 0h 1m 3s
2024-10-19 23:40:42,225 - -----------------validate-----------------
2024-10-19 23:41:43,648 - Epoch 62, total_user:6040.0 nDCG@5: 0.5213130619546823, HR5: 0.9197019867549668, nDCG@10: 0.5347232036844946, HR10: 0.9625827814569536, nDCG@20: 0.5383807676458628, HR20: 0.9771523178807947
2024-10-19 23:41:43,649 - EarlyStopping counter: 7 out of 10
2024-10-19 23:42:00,132 - Epoch: 63/64 Batch: 1/48 Time: 16.5s Loss: 0.10   Average_Loss: 0.10
2024-10-19 23:42:31,204 - Epoch: 63/64 Batch: 33/48 Time: 47.6s Loss: 0.10   Average_Loss: 0.10
2024-10-19 23:42:45,219 - 
Epoch 63/64,  Loss: 0.10471989493817091, Total time: 0h 1m 1s
2024-10-19 23:42:45,220 - -----------------validate-----------------
2024-10-19 23:43:45,611 - Epoch 63, total_user:6040.0 nDCG@5: 0.520908136526448, HR5: 0.9220198675496689, nDCG@10: 0.5339549930424288, HR10: 0.9635761589403974, nDCG@20: 0.5371195059846292, HR20: 0.976158940397351
2024-10-19 23:43:45,612 - EarlyStopping counter: 8 out of 10
2024-10-19 23:44:00,212 - Epoch: 64/64 Batch: 1/48 Time: 14.6s Loss: 0.10   Average_Loss: 0.10
2024-10-19 23:44:32,392 - Epoch: 64/64 Batch: 33/48 Time: 46.8s Loss: 0.11   Average_Loss: 0.10
2024-10-19 23:44:48,954 - 
Epoch 64/64,  Loss: 0.1044008197883765, Total time: 0h 1m 3s
2024-10-19 23:44:48,955 - -----------------validate-----------------
2024-10-19 23:45:49,661 - Epoch 64, total_user:6040.0 nDCG@5: 0.5220217547705248, HR5: 0.920364238410596, nDCG@10: 0.5352332339771818, HR10: 0.9625827814569536, nDCG@20: 0.5386138886132307, HR20: 0.9759933774834437
2024-10-19 23:45:49,662 - EarlyStopping counter: 9 out of 10
2024-10-19 23:45:49,662 - ---------------Test Score---------------
2024-10-19 23:45:49,668 - -----------------test-----------------
2024-10-19 23:46:50,762 - Epoch 1, total_user:6040.0 nDCG@5: 0.47278226185054156, HR5: 0.8779801324503311, nDCG@10: 0.4954718664310435, HR10: 0.9503311258278145, nDCG@20: 0.5007394822757565, HR20: 0.9713576158940397
2024-10-19 23:46:50,763 - Oct-19-2024_21-31-44
2024-10-26 03:58:12,035 - read <class 'data_processing.ml_1m'>
2024-10-26 03:58:17,180 - Namespace(data_dir='./data/', output_dir='output/', data_name='ml-1m', llm_path='./bert-base-uncased', do_eval=True, load_model='GRU4Rec', train_name='Oct-26-2024_03-58-12', num_items=3952, num_users=6040, num_neg_sample=100, lr=0.003, weight_decay=0, batch_size=128, num_epochs=64, patience=5, num_workers=4, seed=42, model_type='GRU4Rec', max_seq_length=50, dropout_rate=0.5, hidden_size=64, num_hidden_layers=2, attn_dropout_rate=0.5, n_heads=8, e_layers=4, alpha=0.8, gru_hidden_size=64, initializer_range=0.02, device=device(type='cuda'), checkpoint_path='output/ml-1m/GRU4Rec.pt', dim_user_discrete_data=[2, 7, 21, 3439], dim_item_discrete_data=18)
2024-10-26 03:58:17,211 - GRU4Rec(
  (item_embeddings): Embedding(3953, 64, padding_idx=0)
  (gru_layers): GRU(64, 64, num_layers=2, bias=False, batch_first=True)
  (emb_dropout): Dropout(p=0.5, inplace=False)
  (dense): Linear(in_features=64, out_features=64, bias=True)
)
2024-10-26 03:58:17,356 - Load model from output/ml-1m/GRU4Rec.pt for test!
2024-10-26 03:58:17,356 - -----------------test-----------------
2024-10-26 03:59:20,888 - Epoch 2, total_user:6040.0 nDCG@5: 0.46874506746959876, HR5: 0.871523178807947, nDCG@10: 0.4940622157587939, HR10: 0.9519867549668874, nDCG@20: 0.4988862934289057, HR20: 0.9711920529801324
2024-10-26 03:59:20,889 - Oct-26-2024_03-58-12
