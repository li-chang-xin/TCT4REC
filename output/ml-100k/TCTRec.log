2024-10-24 21:14:38,538 - read <class 'data_processing.ml_100k'>2024-10-24 21:14:38,609 - Namespace(data_dir='./data/', output_dir='output/', data_name='ml-100k', llm_path='./bert-base-uncased', do_eval=False, load_model='TCTRec', train_name='Oct-24-2024_21-14-38', num_items=1682, num_users=943, num_neg_sample=100, lr=0.003, weight_decay=0, batch_size=32, num_epochs=64, patience=5, num_workers=4, model_type='TCTRec', max_seq_length=50, dropout_rate=0.5, hidden_size=64, num_hidden_layers=2, attn_dropout_rate=0.5, n_heads=8, e_layers=4, alpha=0.8, device=device(type='cuda'), checkpoint_path='output/ml-100k/TCTRec.pt', dim_user_discrete_data=[2, 61, 21, 795], dim_item_discrete_data=19)2024-10-24 21:14:38,732 - TCTRec(  (BiTransformer): Bidimensional_Transformer(    (encoder): Encoder(      (embedding): Embedding(1683, 64, padding_idx=0)      (ivert_embedding): Linear(in_features=50, out_features=64, bias=True)      (static_embedding): Linear(in_features=5, out_features=64, bias=True)      (dropout): Dropout(p=0.5, inplace=False)      (projector): Linear(in_features=64, out_features=50, bias=True)      (pos_emb): Embedding(50, 64)      (layers): ModuleList(        (0-3): 4 x EncoderLayer(          (mha): MultiheadAttention(            (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)          )          (ivert_mha): MultiheadAttention(            (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)          )          (ff): FeedForward(            (linear1): Linear(in_features=64, out_features=64, bias=True)            (dropout): Dropout(p=0.5, inplace=False)            (linear2): Linear(in_features=64, out_features=64, bias=True)          )          (ivert_ff): FeedForward(            (linear1): Linear(in_features=64, out_features=64, bias=True)            (dropout): Dropout(p=0.5, inplace=False)            (linear2): Linear(in_features=64, out_features=64, bias=True)          )          (layernorm1): LayerNorm((64,), eps=1e-05, elementwise_affine=True)          (layernorm2): LayerNorm((64,), eps=1e-05, elementwise_affine=True)          (ivert_layernorm1): LayerNorm((64,), eps=1e-05, elementwise_affine=True)          (ivert_layernorm2): LayerNorm((64,), eps=1e-05, elementwise_affine=True)          (dropout): Dropout(p=0.5, inplace=False)        )      )    )  ))2024-10-24 21:14:39,473 - training start2024-10-24 21:14:44,241 - Epoch: 1/64 Batch: 1/30 Time: 4.8s Loss: 5.41   Average_Loss: 5.412024-10-24 21:14:46,555 - Epoch 1/64,  Loss: 4.514747325579325, Total time: 0h 0m 7s2024-10-24 21:14:46,555 - -----------------validate-----------------2024-10-24 21:15:14,341 - Epoch 1, total_user:943.0 nDCG@5: 0.030510765876619717, HR5: 0.06256627783669141, nDCG@10: 0.04261979413427551, HR10: 0.10286320254506894, nDCG@20: 0.07979368925638948, HR20: 0.25450689289501592024-10-24 21:15:14,341 - Validation score increased.  Saving model ...2024-10-24 21:15:16,940 - Epoch: 2/64 Batch: 1/30 Time: 2.6s Loss: 3.62   Average_Loss: 3.622024-10-24 21:15:22,167 - Epoch 2/64,  Loss: 2.9802211999893187, Total time: 0h 0m 7s2024-10-24 21:15:22,168 - -----------------validate-----------------2024-10-24 21:15:49,832 - Epoch 2, total_user:943.0 nDCG@5: 0.03947692376019326, HR5: 0.08483563096500531, nDCG@10: 0.0629389851523761, HR10: 0.16436903499469777, nDCG@20: 0.11144574946366448, HR20: 0.36373276776246022024-10-24 21:15:49,833 - Validation score increased.  Saving model ...2024-10-24 21:15:52,246 - Epoch: 3/64 Batch: 1/30 Time: 2.4s Loss: 2.28   Average_Loss: 2.282024-10-24 21:15:57,793 - Epoch 3/64,  Loss: 2.0534591952959698, Total time: 0h 0m 7s2024-10-24 21:15:57,794 - -----------------validate-----------------2024-10-24 21:16:25,392 - Epoch 3, total_user:943.0 nDCG@5: 0.07492961199265584, HR5: 0.16436903499469777, nDCG@10: 0.11310582193443239, HR10: 0.28950159066808057, nDCG@20: 0.16471457320055352, HR20: 0.49734888653234362024-10-24 21:16:25,393 - Validation score increased.  Saving model ...2024-10-24 21:16:27,821 - Epoch: 4/64 Batch: 1/30 Time: 2.4s Loss: 1.82   Average_Loss: 1.822024-10-24 21:16:32,941 - Epoch 4/64,  Loss: 1.5518851121266684, Total time: 0h 0m 7s2024-10-24 21:16:32,942 - -----------------validate-----------------2024-10-24 21:17:00,514 - Epoch 4, total_user:943.0 nDCG@5: 0.11905655175533289, HR5: 0.256627783669141, nDCG@10: 0.1674775673468029, HR10: 0.41569459172852596, nDCG@20: 0.21594925815937385, HR20: 0.61293743372216342024-10-24 21:17:00,515 - Validation score increased.  Saving model ...2024-10-24 21:17:02,730 - Epoch: 5/64 Batch: 1/30 Time: 2.2s Loss: 1.38   Average_Loss: 1.382024-10-24 21:17:08,200 - Epoch 5/64,  Loss: 1.303336505095164, Total time: 0h 0m 7s2024-10-24 21:17:08,201 - -----------------validate-----------------2024-10-24 21:17:35,831 - Epoch 5, total_user:943.0 nDCG@5: 0.15705075012703731, HR5: 0.33191940615058324, nDCG@10: 0.20866785121860132, HR10: 0.5005302226935313, nDCG@20: 0.24542383106371496, HR20: 0.64899257688229062024-10-24 21:17:35,832 - Validation score increased.  Saving model ...2024-10-24 21:17:37,904 - Epoch: 6/64 Batch: 1/30 Time: 2.1s Loss: 1.21   Average_Loss: 1.212024-10-24 21:17:43,157 - Epoch 6/64,  Loss: 1.17784587542216, Total time: 0h 0m 7s2024-10-24 21:17:43,158 - -----------------validate-----------------2024-10-24 21:18:11,116 - Epoch 6, total_user:943.0 nDCG@5: 0.1691700561137902, HR5: 0.3563096500530223, nDCG@10: 0.21661932970159772, HR10: 0.513255567338282, nDCG@20: 0.2567966055144322, HR20: 0.67444326617179222024-10-24 21:18:11,117 - Validation score increased.  Saving model ...2024-10-24 21:18:13,424 - Epoch: 7/64 Batch: 1/30 Time: 2.3s Loss: 1.13   Average_Loss: 1.132024-10-24 21:18:18,975 - Epoch 7/64,  Loss: 1.093398646513621, Total time: 0h 0m 7s2024-10-24 21:18:18,976 - -----------------validate-----------------2024-10-24 21:18:46,746 - Epoch 7, total_user:943.0 nDCG@5: 0.17306210115291293, HR5: 0.35949098621421, nDCG@10: 0.2245650052495991, HR10: 0.5270413573700954, nDCG@20: 0.2662790655980647, HR20: 0.69565217391304352024-10-24 21:18:46,746 - Validation score increased.  Saving model ...2024-10-24 21:18:48,994 - Epoch: 8/64 Batch: 1/30 Time: 2.2s Loss: 1.05   Average_Loss: 1.052024-10-24 21:18:54,228 - Epoch 8/64,  Loss: 1.0532633980115256, Total time: 0h 0m 7s2024-10-24 21:18:54,228 - -----------------validate-----------------2024-10-24 21:19:21,349 - Epoch 8, total_user:943.0 nDCG@5: 0.1858128130974257, HR5: 0.3711558854718982, nDCG@10: 0.23892820730279715, HR10: 0.545068928950159, nDCG@20: 0.28035482172510195, HR20: 0.71261930010604462024-10-24 21:19:21,349 - Validation score increased.  Saving model ...2024-10-24 21:19:24,011 - Epoch: 9/64 Batch: 1/30 Time: 2.6s Loss: 1.01   Average_Loss: 1.012024-10-24 21:19:28,950 - Epoch 9/64,  Loss: 1.012500947713852, Total time: 0h 0m 7s2024-10-24 21:19:28,951 - -----------------validate-----------------2024-10-24 21:19:56,472 - Epoch 9, total_user:943.0 nDCG@5: 0.18935553973956765, HR5: 0.37009544008483564, nDCG@10: 0.2451017740287928, HR10: 0.5524920466595971, nDCG@20: 0.28900974567943266, HR20: 0.72958642629904562024-10-24 21:19:56,472 - Validation score increased.  Saving model ...2024-10-24 21:19:58,780 - Epoch: 10/64 Batch: 1/30 Time: 2.3s Loss: 0.97   Average_Loss: 0.972024-10-24 21:20:03,815 - Epoch 10/64,  Loss: 0.9925939281781514, Total time: 0h 0m 7s2024-10-24 21:20:03,816 - -----------------validate-----------------2024-10-24 21:20:31,433 - Epoch 10, total_user:943.0 nDCG@5: 0.18994546033778592, HR5: 0.37645811240721105, nDCG@10: 0.24158076537541995, HR10: 0.5440084835630965, nDCG@20: 0.284992467156733, HR20: 0.718981972428422024-10-24 21:20:31,433 - Validation score increased.  Saving model ...2024-10-24 21:20:34,053 - Epoch: 11/64 Batch: 1/30 Time: 2.6s Loss: 0.97   Average_Loss: 0.972024-10-24 21:20:38,672 - Epoch 11/64,  Loss: 0.9737245361010234, Total time: 0h 0m 7s2024-10-24 21:20:38,673 - -----------------validate-----------------2024-10-24 21:21:06,513 - Epoch 11, total_user:943.0 nDCG@5: 0.19909595853269732, HR5: 0.391304347826087, nDCG@10: 0.24721444172887064, HR10: 0.5493107104984093, nDCG@20: 0.28689929446637413, HR20: 0.70943796394485682024-10-24 21:21:06,514 - Validation score increased.  Saving model ...2024-10-24 21:21:09,243 - Epoch: 12/64 Batch: 1/30 Time: 2.7s Loss: 0.96   Average_Loss: 0.962024-10-24 21:21:14,289 - Epoch 12/64,  Loss: 0.9575396656990052, Total time: 0h 0m 7s2024-10-24 21:21:14,290 - -----------------validate-----------------2024-10-24 21:21:41,951 - Epoch 12, total_user:943.0 nDCG@5: 0.19135332679474543, HR5: 0.37645811240721105, nDCG@10: 0.24810155427962377, HR10: 0.5609756097560976, nDCG@20: 0.2864099196933535, HR20: 0.71580063626723222024-10-24 21:21:41,952 - Validation score increased.  Saving model ...2024-10-24 21:21:44,593 - Epoch: 13/64 Batch: 1/30 Time: 2.6s Loss: 0.96   Average_Loss: 0.962024-10-24 21:21:49,712 - Epoch 13/64,  Loss: 0.9604813516139984, Total time: 0h 0m 7s2024-10-24 21:21:49,713 - -----------------validate-----------------2024-10-24 21:22:17,426 - Epoch 13, total_user:943.0 nDCG@5: 0.19239744057393507, HR5: 0.38494167550371156, nDCG@10: 0.24320714350069347, HR10: 0.5524920466595971, nDCG@20: 0.2863842152633196, HR20: 0.72640509013785792024-10-24 21:22:17,427 - Validation score increased.  Saving model ...2024-10-24 21:22:19,558 - Epoch: 14/64 Batch: 1/30 Time: 2.1s Loss: 0.90   Average_Loss: 0.902024-10-24 21:22:24,465 - Epoch 14/64,  Loss: 0.9589881698290507, Total time: 0h 0m 7s2024-10-24 21:22:24,466 - -----------------validate-----------------2024-10-24 21:22:52,117 - Epoch 14, total_user:943.0 nDCG@5: 0.1925990363460012, HR5: 0.3828207847295864, nDCG@10: 0.24422720304198195, HR10: 0.5524920466595971, nDCG@20: 0.2835767902177677, HR20: 0.7115588547189822024-10-24 21:22:52,118 - Validation score increased.  Saving model ...2024-10-24 21:22:54,884 - Epoch: 15/64 Batch: 1/30 Time: 2.8s Loss: 0.97   Average_Loss: 0.972024-10-24 21:22:59,161 - Epoch 15/64,  Loss: 0.9507963458697001, Total time: 0h 0m 7s2024-10-24 21:22:59,162 - -----------------validate-----------------2024-10-24 21:23:26,932 - Epoch 15, total_user:943.0 nDCG@5: 0.20099024549568215, HR5: 0.4029692470837752, nDCG@10: 0.24524975414215405, HR10: 0.5482502651113468, nDCG@20: 0.2876394842845601, HR20: 0.718981972428422024-10-24 21:23:26,933 - Validation score increased.  Saving model ...2024-10-24 21:23:29,813 - Epoch: 16/64 Batch: 1/30 Time: 2.9s Loss: 0.99   Average_Loss: 0.992024-10-24 21:23:34,696 - Epoch 16/64,  Loss: 0.9516714751720429, Total time: 0h 0m 7s2024-10-24 21:23:34,696 - -----------------validate-----------------2024-10-24 21:24:02,248 - Epoch 16, total_user:943.0 nDCG@5: 0.19442461998554425, HR5: 0.38918345705196183, nDCG@10: 0.24592527879091525, HR10: 0.5588547189819725, nDCG@20: 0.2862468764106487, HR20: 0.7211028632025452024-10-24 21:24:02,249 - Validation score increased.  Saving model ...2024-10-24 21:24:05,067 - Epoch: 17/64 Batch: 1/30 Time: 2.8s Loss: 0.90   Average_Loss: 0.902024-10-24 21:24:09,543 - Epoch 17/64,  Loss: 0.941742604970932, Total time: 0h 0m 7s2024-10-24 21:24:09,543 - -----------------validate-----------------2024-10-24 21:24:36,866 - Epoch 17, total_user:943.0 nDCG@5: 0.19541505847192592, HR5: 0.3870625662778367, nDCG@10: 0.24289439441059887, HR10: 0.5418875927889714, nDCG@20: 0.28534497604842307, HR20: 0.71261930010604462024-10-24 21:24:36,866 - EarlyStopping counter: 1 out of 52024-10-24 21:24:39,155 - Epoch: 18/64 Batch: 1/30 Time: 2.3s Loss: 0.94   Average_Loss: 0.942024-10-24 21:24:44,455 - Epoch 18/64,  Loss: 0.9409750441710154, Total time: 0h 0m 7s2024-10-24 21:24:44,456 - -----------------validate-----------------2024-10-24 21:25:12,405 - Epoch 18, total_user:943.0 nDCG@5: 0.19440444401486176, HR5: 0.3902439024390244, nDCG@10: 0.24321519498258856, HR10: 0.5493107104984093, nDCG@20: 0.2895075891138213, HR20: 0.7359490986214212024-10-24 21:25:12,406 - Validation score increased.  Saving model ...2024-10-24 21:25:14,745 - Epoch: 19/64 Batch: 1/30 Time: 2.3s Loss: 0.92   Average_Loss: 0.922024-10-24 21:25:19,602 - Epoch 19/64,  Loss: 0.9403649906317393, Total time: 0h 0m 7s2024-10-24 21:25:19,603 - -----------------validate-----------------2024-10-24 21:25:47,571 - Epoch 19, total_user:943.0 nDCG@5: 0.19947834317341964, HR5: 0.39236479321314954, nDCG@10: 0.24450714447002, HR10: 0.5387062566277837, nDCG@20: 0.2902373421498653, HR20: 0.72322375397667022024-10-24 21:25:47,572 - Validation score increased.  Saving model ...2024-10-24 21:25:50,071 - Epoch: 20/64 Batch: 1/30 Time: 2.5s Loss: 0.90   Average_Loss: 0.902024-10-24 21:25:54,699 - Epoch 20/64,  Loss: 0.9277831633885701, Total time: 0h 0m 7s2024-10-24 21:25:54,700 - -----------------validate-----------------2024-10-24 21:26:22,269 - Epoch 20, total_user:943.0 nDCG@5: 0.20330769817952576, HR5: 0.3955461293743372, nDCG@10: 0.25089810544149926, HR10: 0.5514316012725344, nDCG@20: 0.29544142697249504, HR20: 0.73170731707317072024-10-24 21:26:22,270 - Validation score increased.  Saving model ...2024-10-24 21:26:24,951 - Epoch: 21/64 Batch: 1/30 Time: 2.7s Loss: 0.93   Average_Loss: 0.932024-10-24 21:26:29,835 - Epoch 21/64,  Loss: 0.9330855508645376, Total time: 0h 0m 7s2024-10-24 21:26:29,836 - -----------------validate-----------------2024-10-24 21:26:57,689 - Epoch 21, total_user:943.0 nDCG@5: 0.19858407188135224, HR5: 0.3944856839872747, nDCG@10: 0.24764218072604796, HR10: 0.5556733828207847, nDCG@20: 0.2869215903321302, HR20: 0.71474019088016972024-10-24 21:26:57,690 - Validation score increased.  Saving model ...2024-10-24 21:26:59,931 - Epoch: 22/64 Batch: 1/30 Time: 2.2s Loss: 0.94   Average_Loss: 0.942024-10-24 21:27:04,717 - Epoch 22/64,  Loss: 0.9361509581406912, Total time: 0h 0m 7s2024-10-24 21:27:04,718 - -----------------validate-----------------2024-10-24 21:27:32,399 - Epoch 22, total_user:943.0 nDCG@5: 0.19727360269144054, HR5: 0.38812301166489926, nDCG@10: 0.24774285633585305, HR10: 0.5524920466595971, nDCG@20: 0.28832554567523416, HR20: 0.71580063626723222024-10-24 21:27:32,400 - Validation score increased.  Saving model ...2024-10-24 21:27:35,101 - Epoch: 23/64 Batch: 1/30 Time: 2.7s Loss: 0.93   Average_Loss: 0.932024-10-24 21:27:39,439 - Epoch 23/64,  Loss: 0.9285446365674337, Total time: 0h 0m 7s2024-10-24 21:27:39,439 - -----------------validate-----------------2024-10-24 21:28:08,383 - Epoch 23, total_user:943.0 nDCG@5: 0.20672801199295227, HR5: 0.41145281018027574, nDCG@10: 0.2488246012040922, HR10: 0.5482502651113468, nDCG@20: 0.2919629050611598, HR20: 0.72216330858960762024-10-24 21:28:08,384 - Validation score increased.  Saving model ...2024-10-24 21:28:11,928 - Epoch: 24/64 Batch: 1/30 Time: 3.5s Loss: 0.90   Average_Loss: 0.902024-10-24 21:28:15,860 - Epoch 24/64,  Loss: 0.9251410802205403, Total time: 0h 0m 7s2024-10-24 21:28:15,861 - -----------------validate-----------------2024-10-24 21:28:43,755 - Epoch 24, total_user:943.0 nDCG@5: 0.19984634436806892, HR5: 0.3902439024390244, nDCG@10: 0.24834346049902256, HR10: 0.5493107104984093, nDCG@20: 0.2895145809892607, HR20: 0.71580063626723222024-10-24 21:28:43,756 - Validation score increased.  Saving model ...2024-10-24 21:28:46,319 - Epoch: 25/64 Batch: 1/30 Time: 2.6s Loss: 0.97   Average_Loss: 0.972024-10-24 21:28:51,919 - Epoch 25/64,  Loss: 0.9288337508837382, Total time: 0h 0m 8s2024-10-24 21:28:51,920 - -----------------validate-----------------2024-10-24 21:29:19,622 - Epoch 25, total_user:943.0 nDCG@5: 0.19979595240698245, HR5: 0.39236479321314954, nDCG@10: 0.2489970539804412, HR10: 0.5524920466595971, nDCG@20: 0.29246171909390695, HR20: 0.72852598091198312024-10-24 21:29:19,623 - Validation score increased.  Saving model ...2024-10-24 21:29:22,289 - Epoch: 26/64 Batch: 1/30 Time: 2.7s Loss: 0.99   Average_Loss: 0.992024-10-24 21:29:27,171 - Epoch 26/64,  Loss: 0.9252948621908824, Total time: 0h 0m 7s2024-10-24 21:29:27,172 - -----------------validate-----------------2024-10-24 21:29:55,087 - Epoch 26, total_user:943.0 nDCG@5: 0.20160458571472234, HR5: 0.4029692470837752, nDCG@10: 0.2528174132205735, HR10: 0.5705196182396607, nDCG@20: 0.2918891987506015, HR20: 0.72852598091198312024-10-24 21:29:55,088 - Validation score increased.  Saving model ...2024-10-24 21:29:57,790 - Epoch: 27/64 Batch: 1/30 Time: 2.7s Loss: 0.92   Average_Loss: 0.922024-10-24 21:30:02,099 - Epoch 27/64,  Loss: 0.9249733269214631, Total time: 0h 0m 6s2024-10-24 21:30:02,100 - -----------------validate-----------------2024-10-24 21:30:29,454 - Epoch 27, total_user:943.0 nDCG@5: 0.1899635688622362, HR5: 0.3753976670201485, nDCG@10: 0.24507222153418046, HR10: 0.5535524920466596, nDCG@20: 0.28400995361585385, HR20: 0.7115588547189822024-10-24 21:30:29,455 - EarlyStopping counter: 1 out of 52024-10-24 21:30:32,565 - Epoch: 28/64 Batch: 1/30 Time: 3.1s Loss: 0.95   Average_Loss: 0.952024-10-24 21:30:36,456 - Epoch 28/64,  Loss: 0.9216914753119151, Total time: 0h 0m 7s2024-10-24 21:30:36,457 - -----------------validate-----------------2024-10-24 21:31:04,325 - Epoch 28, total_user:943.0 nDCG@5: 0.1917581768469509, HR5: 0.37645811240721105, nDCG@10: 0.24705931189949448, HR10: 0.5556733828207847, nDCG@20: 0.28785817523631696, HR20: 0.7211028632025452024-10-24 21:31:04,326 - EarlyStopping counter: 2 out of 52024-10-24 21:31:06,893 - Epoch: 29/64 Batch: 1/30 Time: 2.6s Loss: 0.94   Average_Loss: 0.942024-10-24 21:31:12,079 - Epoch 29/64,  Loss: 0.9250433305899303, Total time: 0h 0m 7s2024-10-24 21:31:12,080 - -----------------validate-----------------2024-10-24 21:31:39,966 - Epoch 29, total_user:943.0 nDCG@5: 0.20011242520921532, HR5: 0.3934252386002121, nDCG@10: 0.24679210976534793, HR10: 0.5461293743372216, nDCG@20: 0.28586301059914787, HR20: 0.7041357370095442024-10-24 21:31:39,967 - EarlyStopping counter: 3 out of 52024-10-24 21:31:42,371 - Epoch: 30/64 Batch: 1/30 Time: 2.4s Loss: 0.88   Average_Loss: 0.882024-10-24 21:31:47,331 - Epoch 30/64,  Loss: 0.9222468574841817, Total time: 0h 0m 7s2024-10-24 21:31:47,332 - -----------------validate-----------------2024-10-24 21:32:15,078 - Epoch 30, total_user:943.0 nDCG@5: 0.20030392880824505, HR5: 0.39660657476139977, nDCG@10: 0.24750849637533998, HR10: 0.5503711558854719, nDCG@20: 0.28998405363679763, HR20: 0.72216330858960762024-10-24 21:32:15,079 - EarlyStopping counter: 4 out of 52024-10-24 21:32:18,436 - Epoch: 31/64 Batch: 1/30 Time: 3.4s Loss: 0.94   Average_Loss: 0.942024-10-24 21:32:22,683 - Epoch 31/64,  Loss: 0.9224355677763622, Total time: 0h 0m 7s2024-10-24 21:32:22,684 - -----------------validate-----------------2024-10-24 21:32:50,428 - Epoch 31, total_user:943.0 nDCG@5: 0.19359094992907067, HR5: 0.3806998939554613, nDCG@10: 0.24787775145984964, HR10: 0.5567338282078473, nDCG@20: 0.2900791645278324, HR20: 0.72746553552492042024-10-24 21:32:50,429 - EarlyStopping counter: 5 out of 52024-10-24 21:32:50,429 - Early stopping2024-10-24 21:32:50,429 - ---------------Test Score---------------2024-10-24 21:32:50,446 - -----------------test-----------------2024-10-24 21:33:17,792 - Epoch 1, total_user:943.0 nDCG@5: 0.1910839218571063, HR5: 0.3722163308589608, nDCG@10: 0.24820509477472985, HR10: 0.5577942735949099, nDCG@20: 0.28322802318032353, HR20: 0.69883351007423122024-10-24 21:33:17,792 - Oct-24-2024_21-14-382024-10-26 01:13:56,745 - read <class 'data_processing.ml_100k'>
2024-10-26 01:13:56,812 - Namespace(data_dir='./data/', output_dir='output/', data_name='ml-100k', llm_path='./bert-base-uncased', do_eval=True, load_model='TCTRec', train_name='Oct-26-2024_01-13-56', num_items=1682, num_users=943, num_neg_sample=100, lr=0.003, weight_decay=0, batch_size=128, num_epochs=64, patience=5, num_workers=4, seed=42, model_type='TCTRec', max_seq_length=50, dropout_rate=0.5, hidden_size=64, num_hidden_layers=2, attn_dropout_rate=0.5, n_heads=8, e_layers=4, alpha=0.8, device=device(type='cuda'), checkpoint_path='output/ml-100k/TCTRec.pt', dim_user_discrete_data=[2, 61, 21, 795], dim_item_discrete_data=19)
2024-10-26 01:13:56,926 - TCTRec(
  (BiTransformer): Bidimensional_Transformer(
    (encoder): Encoder(
      (embedding): Embedding(1683, 64, padding_idx=0)
      (ivert_embedding): Linear(in_features=50, out_features=64, bias=True)
      (static_embedding): Linear(in_features=5, out_features=64, bias=True)
      (dropout): Dropout(p=0.5, inplace=False)
      (projector): Linear(in_features=64, out_features=50, bias=True)
      (pos_emb): Embedding(50, 64)
      (layers): ModuleList(
        (0-3): 4 x EncoderLayer(
          (mha): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
          )
          (ivert_mha): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
          )
          (ff): FeedForward(
            (linear1): Linear(in_features=64, out_features=64, bias=True)
            (dropout): Dropout(p=0.5, inplace=False)
            (linear2): Linear(in_features=64, out_features=64, bias=True)
          )
          (ivert_ff): FeedForward(
            (linear1): Linear(in_features=64, out_features=64, bias=True)
            (dropout): Dropout(p=0.5, inplace=False)
            (linear2): Linear(in_features=64, out_features=64, bias=True)
          )
          (layernorm1): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
          (layernorm2): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
          (ivert_layernorm1): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
          (ivert_layernorm2): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
          (dropout): Dropout(p=0.5, inplace=False)
        )
      )
    )
  )
)
2024-10-26 01:13:56,945 - Load model from output/ml-100k/TCTRec.pt for test!
2024-10-26 01:13:56,945 - -----------------test-----------------
2024-10-26 01:14:30,382 - Epoch 2, total_user:943.0 nDCG@5: 0.19925285367174578, HR5: 0.38918345705196183, nDCG@10: 0.25376763124155005, HR10: 0.5683987274655355, nDCG@20: 0.2880663987970814, HR20: 0.7073170731707317
2024-10-26 01:14:30,383 - Oct-26-2024_01-13-56
