2024-10-19 16:17:34,678 - read <class 'data_processing.ml_100k'>
2024-10-19 16:17:34,743 - Namespace(data_dir='./data/', output_dir='output/', data_name='ml-100k', llm_path='./bert-base-uncased', do_eval=False, load_model='TCTRec', train_name='Oct-19-2024_16-17-34', num_items=1682, num_users=943, num_neg_sample=100, lr=0.003, weight_decay=0, batch_size=128, num_epochs=64, patience=10, num_workers=4, model_type='BSARec', max_seq_length=50, dropout_rate=0.5, hidden_size=64, num_hidden_layers=2, attn_dropout_rate=0.5, n_heads=8, e_layers=4, alpha=0.8, device=device(type='cuda'), checkpoint_path='output/ml-100k/BSARec.pt', dim_user_discrete_data=[2, 61, 21, 795], dim_item_discrete_data=19)
2024-10-19 16:17:34,751 - BSARec(
  (item_emb): Embedding(1683, 64, padding_idx=0)
  (pos_emb): Embedding(50, 64)
  (dropout): Dropout(p=0.5, inplace=False)
  (attention_blocks): ModuleList(
    (0-3): 4 x TransformerBlock(
      (attention): MultiheadAttention(
        (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
      )
      (filter_layer): FrequencyLayer(
        (out_dropout): Dropout(p=0.5, inplace=False)
        (layer_norm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      )
      (ffn): Sequential(
        (0): Linear(in_features=64, out_features=64, bias=True)
        (1): ReLU()
        (2): Dropout(p=0.5, inplace=False)
        (3): Linear(in_features=64, out_features=64, bias=True)
      )
      (norm1): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
      (norm2): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
      (dropout): Dropout(p=0.5, inplace=False)
    )
  )
)
2024-10-19 16:17:35,528 - training start
2024-10-19 16:17:44,324 - Epoch: 1/64 Batch: 1/8 Time: 8.8s Loss: 7.11   Average_Loss: 7.11
2024-10-19 16:17:45,105 - 
Epoch 1/64,  Loss: 6.418453574180603, Total time: 0h 0m 9s
2024-10-19 16:17:45,106 - -----------------validate-----------------
2024-10-19 16:18:20,297 - Epoch 1, total_user:943.0 nDCG@5: 0.04751286839674594, HR5: 0.10498409331919406, nDCG@10: 0.07097305932954243, HR10: 0.1823966065747614, nDCG@20: 0.0995677467655439, HR20: 0.2979851537645811
2024-10-19 16:18:20,298 - Validation score increased.  Saving model ...
2024-10-19 16:18:27,550 - Epoch: 2/64 Batch: 1/8 Time: 7.2s Loss: 5.57   Average_Loss: 5.57
2024-10-19 16:18:29,742 - 
Epoch 2/64,  Loss: 5.232136785984039, Total time: 0h 0m 9s
2024-10-19 16:18:29,743 - -----------------validate-----------------
2024-10-19 16:18:58,535 - Epoch 2, total_user:943.0 nDCG@5: 0.04766833748233222, HR5: 0.10604453870625663, nDCG@10: 0.07203332339329625, HR10: 0.18663838812301167, nDCG@20: 0.10132535591326068, HR20: 0.3064687168610817
2024-10-19 16:18:58,536 - Validation score increased.  Saving model ...
2024-10-19 16:19:06,168 - Epoch: 3/64 Batch: 1/8 Time: 7.6s Loss: 4.62   Average_Loss: 4.62
2024-10-19 16:19:07,845 - 
Epoch 3/64,  Loss: 4.30650532245636, Total time: 0h 0m 9s
2024-10-19 16:19:07,846 - -----------------validate-----------------
2024-10-19 16:19:36,660 - Epoch 3, total_user:943.0 nDCG@5: 0.05481105064255488, HR5: 0.11876988335100742, nDCG@10: 0.08488700984636592, HR10: 0.21739130434782608, nDCG@20: 0.12085601487786031, HR20: 0.3647932131495228
2024-10-19 16:19:36,660 - Validation score increased.  Saving model ...
2024-10-19 16:19:44,793 - Epoch: 4/64 Batch: 1/8 Time: 8.1s Loss: 3.98   Average_Loss: 3.98
2024-10-19 16:19:46,588 - 
Epoch 4/64,  Loss: 3.663551241159439, Total time: 0h 0m 9s
2024-10-19 16:19:46,588 - -----------------validate-----------------
2024-10-19 16:20:15,491 - Epoch 4, total_user:943.0 nDCG@5: 0.06666004191371201, HR5: 0.14316012725344646, nDCG@10: 0.09772389835793624, HR10: 0.24390243902439024, nDCG@20: 0.13718639277651504, HR20: 0.4050901378579003
2024-10-19 16:20:15,492 - Validation score increased.  Saving model ...
2024-10-19 16:20:22,676 - Epoch: 5/64 Batch: 1/8 Time: 7.2s Loss: 3.34   Average_Loss: 3.34
2024-10-19 16:20:25,569 - 
Epoch 5/64,  Loss: 3.1434570848941803, Total time: 0h 0m 10s
2024-10-19 16:20:25,569 - -----------------validate-----------------
2024-10-19 16:20:54,427 - Epoch 5, total_user:943.0 nDCG@5: 0.06788885639195019, HR5: 0.1474019088016967, nDCG@10: 0.11293815567131767, HR10: 0.2948038176033934, nDCG@20: 0.15794921370528892, HR20: 0.47720042417815484
2024-10-19 16:20:54,428 - Validation score increased.  Saving model ...
2024-10-19 16:21:02,664 - Epoch: 6/64 Batch: 1/8 Time: 8.2s Loss: 2.85   Average_Loss: 2.85
2024-10-19 16:21:03,584 - 
Epoch 6/64,  Loss: 2.650783032178879, Total time: 0h 0m 9s
2024-10-19 16:21:03,585 - -----------------validate-----------------
2024-10-19 16:21:38,512 - Epoch 6, total_user:943.0 nDCG@5: 0.09200093021203125, HR5: 0.20254506892895016, nDCG@10: 0.1333145874514069, HR10: 0.3372216330858961, nDCG@20: 0.1759653829734633, HR20: 0.5090137857900318
2024-10-19 16:21:38,513 - Validation score increased.  Saving model ...
2024-10-19 16:21:46,596 - Epoch: 7/64 Batch: 1/8 Time: 8.1s Loss: 2.44   Average_Loss: 2.44
2024-10-19 16:21:47,574 - 
Epoch 7/64,  Loss: 2.3505927324295044, Total time: 0h 0m 9s
2024-10-19 16:21:47,575 - -----------------validate-----------------
2024-10-19 16:22:19,364 - Epoch 7, total_user:943.0 nDCG@5: 0.09130281289273623, HR5: 0.19724284199363734, nDCG@10: 0.1458507930337179, HR10: 0.3753976670201485, nDCG@20: 0.18534700134851934, HR20: 0.5344644750795334
2024-10-19 16:22:19,365 - Validation score increased.  Saving model ...
2024-10-19 16:22:28,304 - Epoch: 8/64 Batch: 1/8 Time: 8.9s Loss: 2.12   Average_Loss: 2.12
2024-10-19 16:22:28,581 - 
Epoch 8/64,  Loss: 2.0828482657670975, Total time: 0h 0m 9s
2024-10-19 16:22:28,582 - -----------------validate-----------------
2024-10-19 16:22:57,758 - Epoch 8, total_user:943.0 nDCG@5: 0.11170017757731085, HR5: 0.24284199363732767, nDCG@10: 0.15811899394998757, HR10: 0.3934252386002121, nDCG@20: 0.20459248568372587, HR20: 0.5811240721102863
2024-10-19 16:22:57,758 - Validation score increased.  Saving model ...
2024-10-19 16:23:06,949 - Epoch: 9/64 Batch: 1/8 Time: 9.2s Loss: 1.91   Average_Loss: 1.91
2024-10-19 16:23:07,598 - 
Epoch 9/64,  Loss: 1.8545746803283691, Total time: 0h 0m 9s
2024-10-19 16:23:07,599 - -----------------validate-----------------
2024-10-19 16:23:36,251 - Epoch 9, total_user:943.0 nDCG@5: 0.12939573769703086, HR5: 0.2788971367974549, nDCG@10: 0.18162454333650122, HR10: 0.4485683987274655, nDCG@20: 0.22778070156107272, HR20: 0.6362672322375398
2024-10-19 16:23:36,252 - Validation score increased.  Saving model ...
2024-10-19 16:23:44,523 - Epoch: 10/64 Batch: 1/8 Time: 8.3s Loss: 1.76   Average_Loss: 1.76
2024-10-19 16:23:45,640 - 
Epoch 10/64,  Loss: 1.6957574635744095, Total time: 0h 0m 9s
2024-10-19 16:23:45,640 - -----------------validate-----------------
2024-10-19 16:24:14,509 - Epoch 10, total_user:943.0 nDCG@5: 0.1535172804985652, HR5: 0.32237539766702017, nDCG@10: 0.19933421045771266, HR10: 0.47295864262990456, nDCG@20: 0.2444750452212057, HR20: 0.6564156945917285
2024-10-19 16:24:14,510 - Validation score increased.  Saving model ...
2024-10-19 16:24:22,947 - Epoch: 11/64 Batch: 1/8 Time: 8.4s Loss: 1.65   Average_Loss: 1.65
2024-10-19 16:24:24,439 - 
Epoch 11/64,  Loss: 1.5896861404180527, Total time: 0h 0m 9s
2024-10-19 16:24:24,440 - -----------------validate-----------------
2024-10-19 16:24:53,360 - Epoch 11, total_user:943.0 nDCG@5: 0.1617687351843166, HR5: 0.3329798515376458, nDCG@10: 0.20695557493013234, HR10: 0.4814422057264051, nDCG@20: 0.2497823831757099, HR20: 0.6553552492046659
2024-10-19 16:24:53,361 - Validation score increased.  Saving model ...
2024-10-19 16:25:02,375 - Epoch: 12/64 Batch: 1/8 Time: 9.0s Loss: 1.55   Average_Loss: 1.55
2024-10-19 16:25:02,666 - 
Epoch 12/64,  Loss: 1.507755234837532, Total time: 0h 0m 9s
2024-10-19 16:25:02,667 - -----------------validate-----------------
2024-10-19 16:25:31,634 - Epoch 12, total_user:943.0 nDCG@5: 0.1552577787201082, HR5: 0.3244962884411453, nDCG@10: 0.2050901024998687, HR10: 0.4878048780487805, nDCG@20: 0.24734843089347786, HR20: 0.6574761399787911
2024-10-19 16:25:31,635 - Validation score increased.  Saving model ...
2024-10-19 16:25:39,600 - Epoch: 13/64 Batch: 1/8 Time: 8.0s Loss: 1.53   Average_Loss: 1.53
2024-10-19 16:25:40,884 - 
Epoch 13/64,  Loss: 1.4768542796373367, Total time: 0h 0m 9s
2024-10-19 16:25:40,885 - -----------------validate-----------------
2024-10-19 16:26:09,949 - Epoch 13, total_user:943.0 nDCG@5: 0.15595197473819172, HR5: 0.32343584305408274, nDCG@10: 0.20833076689253976, HR10: 0.4931071049840933, nDCG@20: 0.25042087161289633, HR20: 0.662778366914104
2024-10-19 16:26:09,950 - Validation score increased.  Saving model ...
2024-10-19 16:26:18,182 - Epoch: 14/64 Batch: 1/8 Time: 8.2s Loss: 1.39   Average_Loss: 1.39
2024-10-19 16:26:19,299 - 
Epoch 14/64,  Loss: 1.4278892278671265, Total time: 0h 0m 9s
2024-10-19 16:26:19,300 - -----------------validate-----------------
2024-10-19 16:26:48,270 - Epoch 14, total_user:943.0 nDCG@5: 0.16975237584710937, HR5: 0.344644750795334, nDCG@10: 0.21992414989021852, HR10: 0.5079533404029692, nDCG@20: 0.26313107417073106, HR20: 0.6839872746553552
2024-10-19 16:26:48,271 - Validation score increased.  Saving model ...
2024-10-19 16:26:58,027 - Epoch: 15/64 Batch: 1/8 Time: 9.8s Loss: 1.43   Average_Loss: 1.43
2024-10-19 16:26:58,300 - 
Epoch 15/64,  Loss: 1.3874719887971878, Total time: 0h 0m 10s
2024-10-19 16:26:58,300 - -----------------validate-----------------
2024-10-19 16:27:27,332 - Epoch 15, total_user:943.0 nDCG@5: 0.1702388314814427, HR5: 0.35418875927889715, nDCG@10: 0.21807473673190933, HR10: 0.5100742311770944, nDCG@20: 0.25876549867735543, HR20: 0.6755037115588547
2024-10-19 16:27:27,333 - Validation score increased.  Saving model ...
2024-10-19 16:27:35,397 - Epoch: 16/64 Batch: 1/8 Time: 8.1s Loss: 1.34   Average_Loss: 1.34
2024-10-19 16:27:36,511 - 
Epoch 16/64,  Loss: 1.3486246168613434, Total time: 0h 0m 9s
2024-10-19 16:27:36,511 - -----------------validate-----------------
2024-10-19 16:28:05,396 - Epoch 16, total_user:943.0 nDCG@5: 0.1723801064974771, HR5: 0.35100742311770944, nDCG@10: 0.22123451851731787, HR10: 0.5100742311770944, nDCG@20: 0.2666698496928754, HR20: 0.6935312831389183
2024-10-19 16:28:05,396 - Validation score increased.  Saving model ...
2024-10-19 16:28:14,272 - Epoch: 17/64 Batch: 1/8 Time: 8.9s Loss: 1.31   Average_Loss: 1.31
2024-10-19 16:28:14,537 - 
Epoch 17/64,  Loss: 1.335587278008461, Total time: 0h 0m 9s
2024-10-19 16:28:14,538 - -----------------validate-----------------
2024-10-19 16:28:43,487 - Epoch 17, total_user:943.0 nDCG@5: 0.17763630237172953, HR5: 0.35949098621421, nDCG@10: 0.22728684988799114, HR10: 0.5217391304347826, nDCG@20: 0.2697590940863957, HR20: 0.6935312831389183
2024-10-19 16:28:43,489 - Validation score increased.  Saving model ...
2024-10-19 16:28:52,810 - Epoch: 18/64 Batch: 1/8 Time: 9.3s Loss: 1.38   Average_Loss: 1.38
2024-10-19 16:28:53,104 - 
Epoch 18/64,  Loss: 1.2924480587244034, Total time: 0h 0m 9s
2024-10-19 16:28:53,104 - -----------------validate-----------------
2024-10-19 16:29:22,061 - Epoch 18, total_user:943.0 nDCG@5: 0.18213511685949066, HR5: 0.3647932131495228, nDCG@10: 0.2289524894047789, HR10: 0.5174973488865323, nDCG@20: 0.2749359002630549, HR20: 0.7030752916224814
2024-10-19 16:29:22,061 - Validation score increased.  Saving model ...
2024-10-19 16:29:30,689 - Epoch: 19/64 Batch: 1/8 Time: 8.6s Loss: 1.29   Average_Loss: 1.29
2024-10-19 16:29:30,975 - 
Epoch 19/64,  Loss: 1.2569084614515305, Total time: 0h 0m 8s
2024-10-19 16:29:30,976 - -----------------validate-----------------
2024-10-19 16:30:00,005 - Epoch 19, total_user:943.0 nDCG@5: 0.1852084589775252, HR5: 0.37009544008483564, nDCG@10: 0.23272554971408554, HR10: 0.5238600212089077, nDCG@20: 0.2758644768957047, HR20: 0.6977730646871686
2024-10-19 16:30:00,006 - Validation score increased.  Saving model ...
2024-10-19 16:30:08,999 - Epoch: 20/64 Batch: 1/8 Time: 9.0s Loss: 1.29   Average_Loss: 1.29
2024-10-19 16:30:09,272 - 
Epoch 20/64,  Loss: 1.2467868328094482, Total time: 0h 0m 9s
2024-10-19 16:30:09,273 - -----------------validate-----------------
2024-10-19 16:30:38,323 - Epoch 20, total_user:943.0 nDCG@5: 0.18511797915301179, HR5: 0.37327677624602335, nDCG@10: 0.23520217734589519, HR10: 0.5376458112407211, nDCG@20: 0.2761360171813749, HR20: 0.7030752916224814
2024-10-19 16:30:38,323 - Validation score increased.  Saving model ...
2024-10-19 16:30:46,936 - Epoch: 21/64 Batch: 1/8 Time: 8.6s Loss: 1.21   Average_Loss: 1.21
2024-10-19 16:30:47,455 - 
Epoch 21/64,  Loss: 1.2280156165361404, Total time: 0h 0m 9s
2024-10-19 16:30:47,456 - -----------------validate-----------------
2024-10-19 16:31:16,173 - Epoch 21, total_user:943.0 nDCG@5: 0.18487564452906874, HR5: 0.3679745493107105, nDCG@10: 0.23552313261505647, HR10: 0.5344644750795334, nDCG@20: 0.28007209598967353, HR20: 0.7136797454931071
2024-10-19 16:31:16,173 - Validation score increased.  Saving model ...
2024-10-19 16:31:24,028 - Epoch: 22/64 Batch: 1/8 Time: 7.8s Loss: 1.21   Average_Loss: 1.21
2024-10-19 16:31:25,411 - 
Epoch 22/64,  Loss: 1.2193972617387772, Total time: 0h 0m 9s
2024-10-19 16:31:25,412 - -----------------validate-----------------
2024-10-19 16:31:54,300 - Epoch 22, total_user:943.0 nDCG@5: 0.19089386795898625, HR5: 0.3743372216330859, nDCG@10: 0.23678108325756458, HR10: 0.5249204665959704, nDCG@20: 0.2826084478081106, HR20: 0.7083775185577943
2024-10-19 16:31:54,300 - Validation score increased.  Saving model ...
2024-10-19 16:32:02,276 - Epoch: 23/64 Batch: 1/8 Time: 8.0s Loss: 1.22   Average_Loss: 1.22
2024-10-19 16:32:04,290 - 
Epoch 23/64,  Loss: 1.2206611931324005, Total time: 0h 0m 9s
2024-10-19 16:32:04,291 - -----------------validate-----------------
2024-10-19 16:32:33,290 - Epoch 23, total_user:943.0 nDCG@5: 0.19701585687763418, HR5: 0.38494167550371156, nDCG@10: 0.2399289373212101, HR10: 0.5249204665959704, nDCG@20: 0.2835434269256556, HR20: 0.7009544008483564
2024-10-19 16:32:33,291 - Validation score increased.  Saving model ...
2024-10-19 16:32:41,959 - Epoch: 24/64 Batch: 1/8 Time: 8.7s Loss: 1.22   Average_Loss: 1.22
2024-10-19 16:32:42,753 - 
Epoch 24/64,  Loss: 1.189044788479805, Total time: 0h 0m 9s
2024-10-19 16:32:42,754 - -----------------validate-----------------
2024-10-19 16:33:11,572 - Epoch 24, total_user:943.0 nDCG@5: 0.19208857943310922, HR5: 0.38176033934252385, nDCG@10: 0.24128525566171707, HR10: 0.542948038176034, nDCG@20: 0.2843927960682982, HR20: 0.7168610816542949
2024-10-19 16:33:11,573 - Validation score increased.  Saving model ...
2024-10-19 16:33:19,462 - Epoch: 25/64 Batch: 1/8 Time: 7.9s Loss: 1.22   Average_Loss: 1.22
2024-10-19 16:33:21,612 - 
Epoch 25/64,  Loss: 1.1849196702241898, Total time: 0h 0m 10s
2024-10-19 16:33:21,612 - -----------------validate-----------------
2024-10-19 16:33:50,614 - Epoch 25, total_user:943.0 nDCG@5: 0.19325297888033297, HR5: 0.38176033934252385, nDCG@10: 0.24303694713451746, HR10: 0.5440084835630965, nDCG@20: 0.28261920532147866, HR20: 0.704135737009544
2024-10-19 16:33:50,614 - Validation score increased.  Saving model ...
2024-10-19 16:33:58,280 - Epoch: 26/64 Batch: 1/8 Time: 7.7s Loss: 1.19   Average_Loss: 1.19
2024-10-19 16:33:59,857 - 
Epoch 26/64,  Loss: 1.1726814806461334, Total time: 0h 0m 9s
2024-10-19 16:33:59,857 - -----------------validate-----------------
2024-10-19 16:34:28,973 - Epoch 26, total_user:943.0 nDCG@5: 0.19477714369198107, HR5: 0.38812301166489926, nDCG@10: 0.24072299108322012, HR10: 0.5387062566277837, nDCG@20: 0.2826361801526434, HR20: 0.7083775185577943
2024-10-19 16:34:28,974 - Validation score increased.  Saving model ...
2024-10-19 16:34:36,781 - Epoch: 27/64 Batch: 1/8 Time: 7.8s Loss: 1.13   Average_Loss: 1.13
2024-10-19 16:34:38,322 - 
Epoch 27/64,  Loss: 1.1674098521471024, Total time: 0h 0m 9s
2024-10-19 16:34:38,323 - -----------------validate-----------------
2024-10-19 16:35:07,070 - Epoch 27, total_user:943.0 nDCG@5: 0.19657923357359902, HR5: 0.38812301166489926, nDCG@10: 0.24691298539222542, HR10: 0.5535524920466596, nDCG@20: 0.2871816631125303, HR20: 0.7158006362672322
2024-10-19 16:35:07,071 - Validation score increased.  Saving model ...
2024-10-19 16:35:15,000 - Epoch: 28/64 Batch: 1/8 Time: 7.9s Loss: 1.13   Average_Loss: 1.13
2024-10-19 16:35:16,839 - 
Epoch 28/64,  Loss: 1.163205549120903, Total time: 0h 0m 9s
2024-10-19 16:35:16,840 - -----------------validate-----------------
2024-10-19 16:35:45,653 - Epoch 28, total_user:943.0 nDCG@5: 0.19794662039082936, HR5: 0.38812301166489926, nDCG@10: 0.24764023405667254, HR10: 0.5514316012725344, nDCG@20: 0.2889550107350976, HR20: 0.7179215270413574
2024-10-19 16:35:45,654 - Validation score increased.  Saving model ...
2024-10-19 16:35:52,734 - Epoch: 29/64 Batch: 1/8 Time: 7.1s Loss: 1.11   Average_Loss: 1.11
2024-10-19 16:35:55,139 - 
Epoch 29/64,  Loss: 1.160840630531311, Total time: 0h 0m 9s
2024-10-19 16:35:55,140 - -----------------validate-----------------
2024-10-19 16:36:23,981 - Epoch 29, total_user:943.0 nDCG@5: 0.20176589672774012, HR5: 0.38812301166489926, nDCG@10: 0.2503767079691563, HR10: 0.5471898197242842, nDCG@20: 0.2913627527311053, HR20: 0.7126193001060446
2024-10-19 16:36:23,982 - Validation score increased.  Saving model ...
2024-10-19 16:36:32,941 - Epoch: 30/64 Batch: 1/8 Time: 9.0s Loss: 1.15   Average_Loss: 1.15
2024-10-19 16:36:33,584 - 
Epoch 30/64,  Loss: 1.1358091831207275, Total time: 0h 0m 9s
2024-10-19 16:36:33,584 - -----------------validate-----------------
2024-10-19 16:37:02,644 - Epoch 30, total_user:943.0 nDCG@5: 0.19180694732596837, HR5: 0.37857900318133614, nDCG@10: 0.23930403455493118, HR10: 0.5344644750795334, nDCG@20: 0.2830802755082889, HR20: 0.7104984093319194
2024-10-19 16:37:02,645 - EarlyStopping counter: 1 out of 10
2024-10-19 16:37:11,479 - Epoch: 31/64 Batch: 1/8 Time: 8.8s Loss: 1.16   Average_Loss: 1.16
2024-10-19 16:37:11,971 - 
Epoch 31/64,  Loss: 1.1342985033988953, Total time: 0h 0m 9s
2024-10-19 16:37:11,972 - -----------------validate-----------------
2024-10-19 16:37:40,908 - Epoch 31, total_user:943.0 nDCG@5: 0.19388342753187843, HR5: 0.3828207847295864, nDCG@10: 0.24041175040379542, HR10: 0.5344644750795334, nDCG@20: 0.28488632923817314, HR20: 0.7136797454931071
2024-10-19 16:37:40,909 - Validation score increased.  Saving model ...
2024-10-19 16:37:48,687 - Epoch: 32/64 Batch: 1/8 Time: 7.8s Loss: 1.14   Average_Loss: 1.14
2024-10-19 16:37:49,845 - 
Epoch 32/64,  Loss: 1.13884137570858, Total time: 0h 0m 8s
2024-10-19 16:37:49,845 - -----------------validate-----------------
2024-10-19 16:38:18,765 - Epoch 32, total_user:943.0 nDCG@5: 0.1937142118004755, HR5: 0.3860021208907741, nDCG@10: 0.24157664733591638, HR10: 0.542948038176034, nDCG@20: 0.2823601505657465, HR20: 0.7073170731707317
2024-10-19 16:38:18,766 - Validation score increased.  Saving model ...
2024-10-19 16:38:26,490 - Epoch: 33/64 Batch: 1/8 Time: 7.7s Loss: 1.14   Average_Loss: 1.14
2024-10-19 16:38:28,924 - 
Epoch 33/64,  Loss: 1.1269841641187668, Total time: 0h 0m 10s
2024-10-19 16:38:28,925 - -----------------validate-----------------
2024-10-19 16:38:57,724 - Epoch 33, total_user:943.0 nDCG@5: 0.19088360359371412, HR5: 0.3753976670201485, nDCG@10: 0.244613417477085, HR10: 0.5493107104984093, nDCG@20: 0.2870797570450945, HR20: 0.721102863202545
2024-10-19 16:38:57,726 - Validation score increased.  Saving model ...
2024-10-19 16:39:06,182 - Epoch: 34/64 Batch: 1/8 Time: 8.4s Loss: 1.13   Average_Loss: 1.13
2024-10-19 16:39:07,338 - 
Epoch 34/64,  Loss: 1.1163312643766403, Total time: 0h 0m 9s
2024-10-19 16:39:07,339 - -----------------validate-----------------
2024-10-19 16:39:36,309 - Epoch 34, total_user:943.0 nDCG@5: 0.19595016620836692, HR5: 0.3860021208907741, nDCG@10: 0.24876070936435235, HR10: 0.5588547189819725, nDCG@20: 0.2878809730261748, HR20: 0.7158006362672322
2024-10-19 16:39:36,310 - Validation score increased.  Saving model ...
2024-10-19 16:39:44,137 - Epoch: 35/64 Batch: 1/8 Time: 7.8s Loss: 1.14   Average_Loss: 1.14
2024-10-19 16:39:45,859 - 
Epoch 35/64,  Loss: 1.1204495579004288, Total time: 0h 0m 9s
2024-10-19 16:39:45,860 - -----------------validate-----------------
2024-10-19 16:40:14,728 - Epoch 35, total_user:943.0 nDCG@5: 0.19807668245488227, HR5: 0.38918345705196183, nDCG@10: 0.24290407006078907, HR10: 0.5365853658536586, nDCG@20: 0.2863616471528547, HR20: 0.711558854718982
2024-10-19 16:40:14,729 - Validation score increased.  Saving model ...
2024-10-19 16:40:22,972 - Epoch: 36/64 Batch: 1/8 Time: 8.2s Loss: 1.15   Average_Loss: 1.15
2024-10-19 16:40:24,022 - 
Epoch 36/64,  Loss: 1.1206876635551453, Total time: 0h 0m 9s
2024-10-19 16:40:24,023 - -----------------validate-----------------
2024-10-19 16:40:52,914 - Epoch 36, total_user:943.0 nDCG@5: 0.19619152761979258, HR5: 0.3860021208907741, nDCG@10: 0.24511336129788924, HR10: 0.545068928950159, nDCG@20: 0.2857918556896287, HR20: 0.7083775185577943
2024-10-19 16:40:52,915 - Validation score increased.  Saving model ...
2024-10-19 16:41:00,804 - Epoch: 37/64 Batch: 1/8 Time: 7.9s Loss: 1.08   Average_Loss: 1.08
2024-10-19 16:41:02,677 - 
Epoch 37/64,  Loss: 1.1177191585302353, Total time: 0h 0m 9s
2024-10-19 16:41:02,677 - -----------------validate-----------------
2024-10-19 16:41:31,682 - Epoch 37, total_user:943.0 nDCG@5: 0.19223459921348332, HR5: 0.38176033934252385, nDCG@10: 0.23991180304438295, HR10: 0.5365853658536586, nDCG@20: 0.281565825692948, HR20: 0.7030752916224814
2024-10-19 16:41:31,682 - EarlyStopping counter: 1 out of 10
2024-10-19 16:41:39,240 - Epoch: 38/64 Batch: 1/8 Time: 7.6s Loss: 1.10   Average_Loss: 1.10
2024-10-19 16:41:41,531 - 
Epoch 38/64,  Loss: 1.102880135178566, Total time: 0h 0m 9s
2024-10-19 16:41:41,531 - -----------------validate-----------------
2024-10-19 16:42:10,118 - Epoch 38, total_user:943.0 nDCG@5: 0.19112658433936788, HR5: 0.37751855779427357, nDCG@10: 0.24312795419191605, HR10: 0.5482502651113468, nDCG@20: 0.28509552397517535, HR20: 0.7179215270413574
2024-10-19 16:42:10,119 - Validation score increased.  Saving model ...
2024-10-19 16:42:18,627 - Epoch: 39/64 Batch: 1/8 Time: 8.5s Loss: 1.13   Average_Loss: 1.13
2024-10-19 16:42:19,309 - 
Epoch 39/64,  Loss: 1.1137483716011047, Total time: 0h 0m 9s
2024-10-19 16:42:19,310 - -----------------validate-----------------
2024-10-19 16:42:47,933 - Epoch 39, total_user:943.0 nDCG@5: 0.19695001723661704, HR5: 0.3860021208907741, nDCG@10: 0.24300291633608778, HR10: 0.5365853658536586, nDCG@20: 0.2885856448735719, HR20: 0.7200424178154825
2024-10-19 16:42:47,934 - Validation score increased.  Saving model ...
2024-10-19 16:42:56,650 - Epoch: 40/64 Batch: 1/8 Time: 8.7s Loss: 1.10   Average_Loss: 1.10
2024-10-19 16:42:57,050 - 
Epoch 40/64,  Loss: 1.1175866723060608, Total time: 0h 0m 9s
2024-10-19 16:42:57,050 - -----------------validate-----------------
2024-10-19 16:43:26,044 - Epoch 40, total_user:943.0 nDCG@5: 0.20365538603469432, HR5: 0.40402969247083775, nDCG@10: 0.24987425788835857, HR10: 0.5556733828207847, nDCG@20: 0.2879345436541092, HR20: 0.7094379639448568
2024-10-19 16:43:26,044 - Validation score increased.  Saving model ...
2024-10-19 16:43:35,658 - Epoch: 41/64 Batch: 1/8 Time: 9.6s Loss: 1.13   Average_Loss: 1.13
2024-10-19 16:43:35,944 - 
Epoch 41/64,  Loss: 1.1160552650690079, Total time: 0h 0m 9s
2024-10-19 16:43:35,944 - -----------------validate-----------------
2024-10-19 16:44:04,917 - Epoch 41, total_user:943.0 nDCG@5: 0.19943775557366392, HR5: 0.39236479321314954, nDCG@10: 0.24715109058207013, HR10: 0.5482502651113468, nDCG@20: 0.28788974367757436, HR20: 0.7126193001060446
2024-10-19 16:44:04,917 - Validation score increased.  Saving model ...
2024-10-19 16:44:13,055 - Epoch: 42/64 Batch: 1/8 Time: 8.1s Loss: 1.09   Average_Loss: 1.09
2024-10-19 16:44:14,397 - 
Epoch 42/64,  Loss: 1.092845767736435, Total time: 0h 0m 9s
2024-10-19 16:44:14,398 - -----------------validate-----------------
2024-10-19 16:44:43,184 - Epoch 42, total_user:943.0 nDCG@5: 0.1947624591535311, HR5: 0.383881230116649, nDCG@10: 0.24165892361877592, HR10: 0.5376458112407211, nDCG@20: 0.28083518960851694, HR20: 0.694591728525981
2024-10-19 16:44:43,185 - EarlyStopping counter: 1 out of 10
2024-10-19 16:44:51,222 - Epoch: 43/64 Batch: 1/8 Time: 8.0s Loss: 1.12   Average_Loss: 1.12
2024-10-19 16:44:53,170 - 
Epoch 43/64,  Loss: 1.1003752499818802, Total time: 0h 0m 9s
2024-10-19 16:44:53,171 - -----------------validate-----------------
2024-10-19 16:45:22,151 - Epoch 43, total_user:943.0 nDCG@5: 0.20049268110894636, HR5: 0.4029692470837752, nDCG@10: 0.24381333296891244, HR10: 0.545068928950159, nDCG@20: 0.2867539938378891, HR20: 0.71898197242842
2024-10-19 16:45:22,152 - Validation score increased.  Saving model ...
2024-10-19 16:45:31,033 - Epoch: 44/64 Batch: 1/8 Time: 8.9s Loss: 1.13   Average_Loss: 1.13
2024-10-19 16:45:31,415 - 
Epoch 44/64,  Loss: 1.1094057261943817, Total time: 0h 0m 9s
2024-10-19 16:45:31,416 - -----------------validate-----------------
2024-10-19 16:46:00,327 - Epoch 44, total_user:943.0 nDCG@5: 0.19389752464129975, HR5: 0.3796394485683987, nDCG@10: 0.24722136316310028, HR10: 0.5535524920466596, nDCG@20: 0.2861866606921949, HR20: 0.7094379639448568
2024-10-19 16:46:00,328 - Validation score increased.  Saving model ...
2024-10-19 16:46:09,148 - Epoch: 45/64 Batch: 1/8 Time: 8.8s Loss: 1.09   Average_Loss: 1.09
2024-10-19 16:46:09,591 - 
Epoch 45/64,  Loss: 1.0953507870435715, Total time: 0h 0m 9s
2024-10-19 16:46:09,591 - -----------------validate-----------------
2024-10-19 16:46:38,623 - Epoch 45, total_user:943.0 nDCG@5: 0.19765818133911978, HR5: 0.3934252386002121, nDCG@10: 0.24432978323368856, HR10: 0.5461293743372216, nDCG@20: 0.28595409239774416, HR20: 0.7147401908801697
2024-10-19 16:46:38,623 - Validation score increased.  Saving model ...
2024-10-19 16:46:47,645 - Epoch: 46/64 Batch: 1/8 Time: 9.0s Loss: 1.08   Average_Loss: 1.08
2024-10-19 16:46:48,515 - 
Epoch 46/64,  Loss: 1.0955642759799957, Total time: 0h 0m 9s
2024-10-19 16:46:48,516 - -----------------validate-----------------
2024-10-19 16:47:17,504 - Epoch 46, total_user:943.0 nDCG@5: 0.19146642045066908, HR5: 0.37645811240721105, nDCG@10: 0.24058772931125422, HR10: 0.5365853658536586, nDCG@20: 0.2859946313202663, HR20: 0.7200424178154825
2024-10-19 16:47:17,505 - Validation score increased.  Saving model ...
2024-10-19 16:47:26,008 - Epoch: 47/64 Batch: 1/8 Time: 8.5s Loss: 1.11   Average_Loss: 1.11
2024-10-19 16:47:27,825 - 
Epoch 47/64,  Loss: 1.1030488312244415, Total time: 0h 0m 10s
2024-10-19 16:47:27,826 - -----------------validate-----------------
2024-10-19 16:47:57,476 - Epoch 47, total_user:943.0 nDCG@5: 0.1927769427399595, HR5: 0.37645811240721105, nDCG@10: 0.24035087822732057, HR10: 0.5312831389183457, nDCG@20: 0.2837369019150428, HR20: 0.704135737009544
2024-10-19 16:47:57,476 - Validation score increased.  Saving model ...
2024-10-19 16:48:06,696 - Epoch: 48/64 Batch: 1/8 Time: 9.2s Loss: 1.09   Average_Loss: 1.09
2024-10-19 16:48:06,982 - 
Epoch 48/64,  Loss: 1.0968351513147354, Total time: 0h 0m 9s
2024-10-19 16:48:06,982 - -----------------validate-----------------
2024-10-19 16:48:36,025 - Epoch 48, total_user:943.0 nDCG@5: 0.197056264625711, HR5: 0.38812301166489926, nDCG@10: 0.24439746519540326, HR10: 0.542948038176034, nDCG@20: 0.28770054596910055, HR20: 0.7168610816542949
2024-10-19 16:48:36,026 - Validation score increased.  Saving model ...
2024-10-19 16:48:44,852 - Epoch: 49/64 Batch: 1/8 Time: 8.8s Loss: 1.06   Average_Loss: 1.06
2024-10-19 16:48:45,959 - 
Epoch 49/64,  Loss: 1.091393992304802, Total time: 0h 0m 9s
2024-10-19 16:48:45,960 - -----------------validate-----------------
2024-10-19 16:49:15,229 - Epoch 49, total_user:943.0 nDCG@5: 0.19705387212321768, HR5: 0.38812301166489926, nDCG@10: 0.24488682120051386, HR10: 0.545068928950159, nDCG@20: 0.28686575135138453, HR20: 0.7147401908801697
2024-10-19 16:49:15,230 - Validation score increased.  Saving model ...
2024-10-19 16:49:23,510 - Epoch: 50/64 Batch: 1/8 Time: 8.3s Loss: 1.08   Average_Loss: 1.08
2024-10-19 16:49:25,259 - 
Epoch 50/64,  Loss: 1.0937662571668625, Total time: 0h 0m 10s
2024-10-19 16:49:25,260 - -----------------validate-----------------
2024-10-19 16:49:54,217 - Epoch 50, total_user:943.0 nDCG@5: 0.19978817009048958, HR5: 0.3955461293743372, nDCG@10: 0.2465912306067586, HR10: 0.5503711558854719, nDCG@20: 0.289066982430913, HR20: 0.721102863202545
2024-10-19 16:49:54,217 - Validation score increased.  Saving model ...
2024-10-19 16:50:03,800 - Epoch: 51/64 Batch: 1/8 Time: 9.6s Loss: 1.11   Average_Loss: 1.11
2024-10-19 16:50:04,099 - 
Epoch 51/64,  Loss: 1.0863780230283737, Total time: 0h 0m 9s
2024-10-19 16:50:04,100 - -----------------validate-----------------
2024-10-19 16:50:33,128 - Epoch 51, total_user:943.0 nDCG@5: 0.19671657462651457, HR5: 0.38918345705196183, nDCG@10: 0.244481264784094, HR10: 0.5471898197242842, nDCG@20: 0.2853955697610174, HR20: 0.711558854718982
2024-10-19 16:50:33,129 - EarlyStopping counter: 1 out of 10
2024-10-19 16:50:41,433 - Epoch: 52/64 Batch: 1/8 Time: 8.3s Loss: 1.10   Average_Loss: 1.10
2024-10-19 16:50:42,816 - 
Epoch 52/64,  Loss: 1.0940183401107788, Total time: 0h 0m 9s
2024-10-19 16:50:42,817 - -----------------validate-----------------
2024-10-19 16:51:11,802 - Epoch 52, total_user:943.0 nDCG@5: 0.1951111980435866, HR5: 0.3828207847295864, nDCG@10: 0.24888666948643812, HR10: 0.5577942735949099, nDCG@20: 0.28519054945301153, HR20: 0.704135737009544
2024-10-19 16:51:11,803 - Validation score increased.  Saving model ...
2024-10-19 16:51:20,645 - Epoch: 53/64 Batch: 1/8 Time: 8.8s Loss: 1.11   Average_Loss: 1.11
2024-10-19 16:51:20,964 - 
Epoch 53/64,  Loss: 1.089021697640419, Total time: 0h 0m 9s
2024-10-19 16:51:20,965 - -----------------validate-----------------
2024-10-19 16:51:49,838 - Epoch 53, total_user:943.0 nDCG@5: 0.19429681250726008, HR5: 0.3860021208907741, nDCG@10: 0.24407786142661428, HR10: 0.5482502651113468, nDCG@20: 0.28426958132155417, HR20: 0.7094379639448568
2024-10-19 16:51:49,839 - Validation score increased.  Saving model ...
2024-10-19 16:51:59,320 - Epoch: 54/64 Batch: 1/8 Time: 9.5s Loss: 1.07   Average_Loss: 1.07
2024-10-19 16:51:59,601 - 
Epoch 54/64,  Loss: 1.0820722132921219, Total time: 0h 0m 9s
2024-10-19 16:51:59,601 - -----------------validate-----------------
2024-10-19 16:52:28,427 - Epoch 54, total_user:943.0 nDCG@5: 0.19831054355566416, HR5: 0.39236479321314954, nDCG@10: 0.24417195002203396, HR10: 0.542948038176034, nDCG@20: 0.28198467288284307, HR20: 0.694591728525981
2024-10-19 16:52:28,427 - Validation score increased.  Saving model ...
2024-10-19 16:52:36,394 - Epoch: 55/64 Batch: 1/8 Time: 8.0s Loss: 1.12   Average_Loss: 1.12
2024-10-19 16:52:38,322 - 
Epoch 55/64,  Loss: 1.1010200083255768, Total time: 0h 0m 9s
2024-10-19 16:52:38,323 - -----------------validate-----------------
2024-10-19 16:53:07,339 - Epoch 55, total_user:943.0 nDCG@5: 0.20078414675607245, HR5: 0.3934252386002121, nDCG@10: 0.24750869935110065, HR10: 0.5461293743372216, nDCG@20: 0.2906474599007694, HR20: 0.7221633085896076
2024-10-19 16:53:07,340 - Validation score increased.  Saving model ...
2024-10-19 16:53:14,897 - Epoch: 56/64 Batch: 1/8 Time: 7.5s Loss: 1.12   Average_Loss: 1.12
2024-10-19 16:53:17,125 - 
Epoch 56/64,  Loss: 1.0907274782657623, Total time: 0h 0m 9s
2024-10-19 16:53:17,125 - -----------------validate-----------------
2024-10-19 16:53:46,671 - Epoch 56, total_user:943.0 nDCG@5: 0.19856226491462145, HR5: 0.391304347826087, nDCG@10: 0.24871777138785606, HR10: 0.5546129374337222, nDCG@20: 0.2877370659666126, HR20: 0.711558854718982
2024-10-19 16:53:46,671 - Validation score increased.  Saving model ...
2024-10-19 16:53:56,165 - Epoch: 57/64 Batch: 1/8 Time: 9.5s Loss: 1.11   Average_Loss: 1.11
2024-10-19 16:53:56,456 - 
Epoch 57/64,  Loss: 1.0856748223304749, Total time: 0h 0m 9s
2024-10-19 16:53:56,456 - -----------------validate-----------------
2024-10-19 16:54:25,478 - Epoch 57, total_user:943.0 nDCG@5: 0.19337331522662787, HR5: 0.37751855779427357, nDCG@10: 0.24749989794074972, HR10: 0.5546129374337222, nDCG@20: 0.2875920709139739, HR20: 0.7158006362672322
2024-10-19 16:54:25,479 - Validation score increased.  Saving model ...
2024-10-19 16:54:34,414 - Epoch: 58/64 Batch: 1/8 Time: 8.9s Loss: 1.09   Average_Loss: 1.09
2024-10-19 16:54:35,000 - 
Epoch 58/64,  Loss: 1.0999976247549057, Total time: 0h 0m 9s
2024-10-19 16:54:35,001 - -----------------validate-----------------
2024-10-19 16:55:04,153 - Epoch 58, total_user:943.0 nDCG@5: 0.19846346213471533, HR5: 0.3902439024390244, nDCG@10: 0.24829001133609102, HR10: 0.5535524920466596, nDCG@20: 0.28918067694129274, HR20: 0.71898197242842
2024-10-19 16:55:04,154 - Validation score increased.  Saving model ...
2024-10-19 16:55:12,373 - Epoch: 59/64 Batch: 1/8 Time: 8.2s Loss: 1.07   Average_Loss: 1.07
2024-10-19 16:55:13,380 - 
Epoch 59/64,  Loss: 1.0862287431955338, Total time: 0h 0m 9s
2024-10-19 16:55:13,381 - -----------------validate-----------------
2024-10-19 16:55:42,744 - Epoch 59, total_user:943.0 nDCG@5: 0.1971205207883212, HR5: 0.3870625662778367, nDCG@10: 0.24567702567072378, HR10: 0.5482502651113468, nDCG@20: 0.2891310603945699, HR20: 0.7242841993637328
2024-10-19 16:55:42,745 - Validation score increased.  Saving model ...
2024-10-19 16:55:51,598 - Epoch: 60/64 Batch: 1/8 Time: 8.8s Loss: 1.09   Average_Loss: 1.09
2024-10-19 16:55:52,149 - 
Epoch 60/64,  Loss: 1.0883194208145142, Total time: 0h 0m 9s
2024-10-19 16:55:52,149 - -----------------validate-----------------
2024-10-19 16:56:21,399 - Epoch 60, total_user:943.0 nDCG@5: 0.19795324533587783, HR5: 0.38918345705196183, nDCG@10: 0.24814936350059189, HR10: 0.5524920466595971, nDCG@20: 0.28754553533683747, HR20: 0.711558854718982
2024-10-19 16:56:21,400 - Validation score increased.  Saving model ...
2024-10-19 16:56:28,314 - Epoch: 61/64 Batch: 1/8 Time: 6.9s Loss: 1.09   Average_Loss: 1.09
2024-10-19 16:56:31,053 - 
Epoch 61/64,  Loss: 1.0872097313404083, Total time: 0h 0m 9s
2024-10-19 16:56:31,054 - -----------------validate-----------------
2024-10-19 16:57:00,351 - Epoch 61, total_user:943.0 nDCG@5: 0.19915820698707917, HR5: 0.3944856839872747, nDCG@10: 0.2446185866429641, HR10: 0.5440084835630965, nDCG@20: 0.287867652696554, HR20: 0.7179215270413574
2024-10-19 16:57:00,351 - Validation score increased.  Saving model ...
2024-10-19 16:57:10,017 - Epoch: 62/64 Batch: 1/8 Time: 9.7s Loss: 1.10   Average_Loss: 1.10
2024-10-19 16:57:10,598 - 
Epoch 62/64,  Loss: 1.086197093129158, Total time: 0h 0m 10s
2024-10-19 16:57:10,599 - -----------------validate-----------------
2024-10-19 16:57:39,574 - Epoch 62, total_user:943.0 nDCG@5: 0.1983596526063495, HR5: 0.39236479321314954, nDCG@10: 0.2504616138265344, HR10: 0.5630965005302226, nDCG@20: 0.28785063713073583, HR20: 0.7147401908801697
2024-10-19 16:57:39,575 - Validation score increased.  Saving model ...
2024-10-19 16:57:47,901 - Epoch: 63/64 Batch: 1/8 Time: 8.3s Loss: 1.08   Average_Loss: 1.08
2024-10-19 16:57:49,153 - 
Epoch 63/64,  Loss: 1.0872605443000793, Total time: 0h 0m 9s
2024-10-19 16:57:49,153 - -----------------validate-----------------
2024-10-19 16:58:18,584 - Epoch 63, total_user:943.0 nDCG@5: 0.196879230130908, HR5: 0.3860021208907741, nDCG@10: 0.2452104666951326, HR10: 0.545068928950159, nDCG@20: 0.28596164941587005, HR20: 0.7094379639448568
2024-10-19 16:58:18,585 - EarlyStopping counter: 1 out of 10
2024-10-19 16:58:26,957 - Epoch: 64/64 Batch: 1/8 Time: 8.4s Loss: 1.06   Average_Loss: 1.06
2024-10-19 16:58:27,633 - 
Epoch 64/64,  Loss: 1.0841912031173706, Total time: 0h 0m 9s
2024-10-19 16:58:27,633 - -----------------validate-----------------
2024-10-19 16:58:56,527 - Epoch 64, total_user:943.0 nDCG@5: 0.2036230341403022, HR5: 0.40402969247083775, nDCG@10: 0.24493176513591786, HR10: 0.5408271474019088, nDCG@20: 0.2857649683766771, HR20: 0.704135737009544
2024-10-19 16:58:56,528 - Validation score increased.  Saving model ...
2024-10-19 16:58:56,536 - ---------------Test Score---------------
2024-10-19 16:58:56,545 - -----------------test-----------------
2024-10-19 16:59:25,589 - Epoch 1, total_user:943.0 nDCG@5: 0.18667066482007352, HR5: 0.37327677624602335, nDCG@10: 0.2369337818996106, HR10: 0.5387062566277837, nDCG@20: 0.27692051889709346, HR20: 0.6988335100742312
2024-10-19 16:59:25,591 - Oct-19-2024_16-17-34
2024-10-26 04:01:10,309 - read <class 'data_processing.ml_100k'>
2024-10-26 04:01:10,381 - Namespace(data_dir='./data/', output_dir='output/', data_name='ml-100k', llm_path='./bert-base-uncased', do_eval=True, load_model='BSARec', train_name='Oct-26-2024_04-01-10', num_items=1682, num_users=943, num_neg_sample=100, lr=0.003, weight_decay=0, batch_size=128, num_epochs=64, patience=5, num_workers=4, seed=42, model_type='BSARec', max_seq_length=50, dropout_rate=0.5, hidden_size=64, num_hidden_layers=2, attn_dropout_rate=0.5, n_heads=8, e_layers=4, alpha=0.8, device=device(type='cuda'), checkpoint_path='output/ml-100k/BSARec.pt', dim_user_discrete_data=[2, 61, 21, 795], dim_item_discrete_data=19)
2024-10-26 04:01:10,388 - BSARec(
  (item_emb): Embedding(1683, 64, padding_idx=0)
  (pos_emb): Embedding(50, 64)
  (dropout): Dropout(p=0.5, inplace=False)
  (attention_blocks): ModuleList(
    (0-3): 4 x TransformerBlock(
      (attention): MultiheadAttention(
        (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
      )
      (filter_layer): FrequencyLayer(
        (out_dropout): Dropout(p=0.5, inplace=False)
        (layer_norm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
      )
      (ffn): Sequential(
        (0): Linear(in_features=64, out_features=64, bias=True)
        (1): ReLU()
        (2): Dropout(p=0.5, inplace=False)
        (3): Linear(in_features=64, out_features=64, bias=True)
      )
      (norm1): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
      (norm2): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
      (dropout): Dropout(p=0.5, inplace=False)
    )
  )
)
2024-10-26 04:01:10,508 - Load model from output/ml-100k/BSARec.pt for test!
2024-10-26 04:01:10,508 - -----------------test-----------------
2024-10-26 04:01:41,569 - Epoch 2, total_user:943.0 nDCG@5: 0.18471782180901417, HR5: 0.3647932131495228, nDCG@10: 0.23932263215334262, HR10: 0.5440084835630965, nDCG@20: 0.27956503704984353, HR20: 0.7051961823966065
2024-10-26 04:01:41,569 - Oct-26-2024_04-01-10
